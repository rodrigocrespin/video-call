var Mt=Object.defineProperty,Nt=Object.defineProperties,Ft=Object.getOwnPropertyDescriptors,st=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable,ct=(C,w,a)=>w in C?Mt(C,w,{enumerable:!0,configurable:!0,writable:!0,value:a}):C[w]=a,$e=(C,w)=>{for(var a in w||(w={}))Bt.call(w,a)&&ct(C,a,w[a]);if(st)for(var a of st(w))Ut.call(w,a)&&ct(C,a,w[a]);return C},Ze=(C,w)=>Nt(C,Ft(w));(self.webpackChunkvideo_call_client=self.webpackChunkvideo_call_client||[]).push([[507],{4035:(C,w,a)=>{var p=a(3781),h=a(7732),o=a(4082),s=a(2040);C.exports.Backoff=p,C.exports.FunctionCall=s,C.exports.FibonacciStrategy=o,C.exports.ExponentialStrategy=h,C.exports.fibonacci=function(i){return new p(new o(i))},C.exports.exponential=function(i){return new p(new h(i))},C.exports.call=function(i,t,e){var r=Array.prototype.slice.call(arguments);return i=r[0],t=r.slice(1,r.length-1),new s(i,t,e=r[r.length-1])}},3781:(C,w,a)=>{var p=a(3105),h=a(3726);function s(i){p.EventEmitter.call(this),this.backoffStrategy_=i,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}a(1732).inherits(s,p.EventEmitter),s.prototype.failAfter=function(i){h.checkArgument(i>0,"Expected a maximum number of retry greater than 0 but got %s.",i),this.maxNumberOfRetry_=i},s.prototype.backoff=function(i){h.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",i),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,i))},s.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},s.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},C.exports=s},2040:(C,w,a)=>{var p=a(3105),h=a(3726),o=a(1732),s=a(3781),i=a(4082);function t(e,r,n){p.EventEmitter.call(this),h.checkIsFunction(e,"Expected fn to be a function."),h.checkIsArray(r,"Expected args to be an array."),h.checkIsFunction(n,"Expected callback to be a function."),this.function_=e,this.arguments_=r,this.callback_=n,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=t.DEFAULT_RETRY_PREDICATE_,this.state_=t.State_.PENDING}o.inherits(t,p.EventEmitter),t.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},t.DEFAULT_RETRY_PREDICATE_=function(e){return!0},t.prototype.isPending=function(){return this.state_==t.State_.PENDING},t.prototype.isRunning=function(){return this.state_==t.State_.RUNNING},t.prototype.isCompleted=function(){return this.state_==t.State_.COMPLETED},t.prototype.isAborted=function(){return this.state_==t.State_.ABORTED},t.prototype.setStrategy=function(e){return h.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},t.prototype.retryIf=function(e){return h.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},t.prototype.getLastResult=function(){return this.lastResult_.concat()},t.prototype.getNumRetries=function(){return this.numRetries_},t.prototype.failAfter=function(e){return h.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},t.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=t.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},t.prototype.start=function(e){h.checkState(!this.isAborted(),"FunctionCall is aborted."),h.checkState(this.isPending(),"FunctionCall already started.");var r=this.strategy_||new i;this.backoff_=e?e(r):new s(r),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=t.State_.RUNNING,this.doCall_(!1)},t.prototype.doCall_=function(e){e&&this.numRetries_++;var r=["call"].concat(this.arguments_);p.EventEmitter.prototype.emit.apply(this,r);var n=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(n))},t.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},t.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,p.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var r=e[0];r&&this.retryPredicate_(r)?this.backoff_.backoff(r):(this.state_=t.State_.COMPLETED,this.doCallback_())}},t.prototype.handleBackoff_=function(e,r,n){this.emit("backoff",e,r,n)},C.exports=t},7732:(C,w,a)=>{var p=a(1732),h=a(3726),o=a(1975);function s(i){o.call(this,i),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=s.DEFAULT_FACTOR,i&&void 0!==i.factor&&(h.checkArgument(i.factor>1,"Exponential factor should be greater than 1 but got %s.",i.factor),this.factor_=i.factor)}p.inherits(s,o),s.DEFAULT_FACTOR=2,s.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},s.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},C.exports=s},4082:(C,w,a)=>{var p=a(1732),h=a(1975);function o(s){h.call(this,s),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}p.inherits(o,h),o.prototype.next_=function(){var s=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=s,s},o.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},C.exports=o},1975:(C,w,a)=>{function o(i){return null!=i}function s(i){if(o((i=i||{}).initialDelay)&&i.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(o(i.maxDelay)&&i.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=i.initialDelay||100,this.maxDelay_=i.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(o(i.randomisationFactor)&&(i.randomisationFactor<0||i.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=i.randomisationFactor||0}a(3105),a(1732),s.prototype.getMaxDelay=function(){return this.maxDelay_},s.prototype.getInitialDelay=function(){return this.initialDelay_},s.prototype.next=function(){var i=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(i*t)},s.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},s.prototype.reset=function(){this.reset_()},s.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},C.exports=s},9568:(C,w,a)=>{"use strict";var p=a(8540),h=a(44),o=h(p("String.prototype.indexOf"));C.exports=function(i,t){var e=p(i,!!t);return"function"==typeof e&&o(i,".prototype.")>-1?h(e):e}},44:(C,w,a)=>{"use strict";var p=a(5396),h=a(8540),o=h("%Function.prototype.apply%"),s=h("%Function.prototype.call%"),i=h("%Reflect.apply%",!0)||p.call(s,o),t=h("%Object.getOwnPropertyDescriptor%",!0),e=h("%Object.defineProperty%",!0),r=h("%Math.max%");if(e)try{e({},"a",{value:1})}catch(l){e=null}C.exports=function(y){var _=i(p,s,arguments);if(t&&e){var b=t(_,"length");b.configurable&&e(_,"length",{value:1+r(0,y.length-(arguments.length-1))})}return _};var n=function(){return i(p,o,arguments)};e?e(C.exports,"apply",{value:n}):C.exports.apply=n},3105:C=>{"use strict";var p,w="object"==typeof Reflect?Reflect:null,a=w&&"function"==typeof w.apply?w.apply:function(P,L,R){return Function.prototype.apply.call(P,L,R)};p=w&&"function"==typeof w.ownKeys?w.ownKeys:Object.getOwnPropertySymbols?function(P){return Object.getOwnPropertyNames(P).concat(Object.getOwnPropertySymbols(P))}:function(P){return Object.getOwnPropertyNames(P)};var o=Number.isNaN||function(P){return P!=P};function s(){s.init.call(this)}C.exports=s,C.exports.once=function(A,P){return new Promise(function(L,R){function E(T){A.removeListener(P,S),R(T)}function S(){"function"==typeof A.removeListener&&A.removeListener("error",E),L([].slice.call(arguments))}g(A,P,S,{once:!0}),"error"!==P&&function(A,P,L){"function"==typeof A.on&&g(A,"error",P,{once:!0})}(A,E)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var i=10;function t(A){if("function"!=typeof A)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}function e(A){return void 0===A._maxListeners?s.defaultMaxListeners:A._maxListeners}function r(A,P,L,R){var E,S,T;if(t(L),void 0===(S=A._events)?(S=A._events=Object.create(null),A._eventsCount=0):(void 0!==S.newListener&&(A.emit("newListener",P,L.listener?L.listener:L),S=A._events),T=S[P]),void 0===T)T=S[P]=L,++A._eventsCount;else if("function"==typeof T?T=S[P]=R?[L,T]:[T,L]:R?T.unshift(L):T.push(L),(E=e(A))>0&&T.length>E&&!T.warned){T.warned=!0;var x=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(P)+" listeners added. Use emitter.setMaxListeners() to increase limit");x.name="MaxListenersExceededWarning",x.emitter=A,x.type=P,x.count=T.length,function(A){console&&console.warn&&console.warn(A)}(x)}return A}function n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(A,P,L){var R={fired:!1,wrapFn:void 0,target:A,type:P,listener:L},E=n.bind(R);return E.listener=L,R.wrapFn=E,E}function y(A,P,L){var R=A._events;if(void 0===R)return[];var E=R[P];return void 0===E?[]:"function"==typeof E?L?[E.listener||E]:[E]:L?function(A){for(var P=new Array(A.length),L=0;L<P.length;++L)P[L]=A[L].listener||A[L];return P}(E):b(E,E.length)}function _(A){var P=this._events;if(void 0!==P){var L=P[A];if("function"==typeof L)return 1;if(void 0!==L)return L.length}return 0}function b(A,P){for(var L=new Array(P),R=0;R<P;++R)L[R]=A[R];return L}function g(A,P,L,R){if("function"==typeof A.on)R.once?A.once(P,L):A.on(P,L);else{if("function"!=typeof A.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A);A.addEventListener(P,function E(S){R.once&&A.removeEventListener(P,E),L(S)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(A){if("number"!=typeof A||A<0||o(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");i=A}}),s.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(P){if("number"!=typeof P||P<0||o(P))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+P+".");return this._maxListeners=P,this},s.prototype.getMaxListeners=function(){return e(this)},s.prototype.emit=function(P){for(var L=[],R=1;R<arguments.length;R++)L.push(arguments[R]);var E="error"===P,S=this._events;if(void 0!==S)E=E&&void 0===S.error;else if(!E)return!1;if(E){var T;if(L.length>0&&(T=L[0]),T instanceof Error)throw T;var x=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw x.context=T,x}var M=S[P];if(void 0===M)return!1;if("function"==typeof M)a(M,this,L);else{var N=M.length,j=b(M,N);for(R=0;R<N;++R)a(j[R],this,L)}return!0},s.prototype.on=s.prototype.addListener=function(P,L){return r(this,P,L,!1)},s.prototype.prependListener=function(P,L){return r(this,P,L,!0)},s.prototype.once=function(P,L){return t(L),this.on(P,l(this,P,L)),this},s.prototype.prependOnceListener=function(P,L){return t(L),this.prependListener(P,l(this,P,L)),this},s.prototype.off=s.prototype.removeListener=function(P,L){var R,E,S,T,x;if(t(L),void 0===(E=this._events))return this;if(void 0===(R=E[P]))return this;if(R===L||R.listener===L)0==--this._eventsCount?this._events=Object.create(null):(delete E[P],E.removeListener&&this.emit("removeListener",P,R.listener||L));else if("function"!=typeof R){for(S=-1,T=R.length-1;T>=0;T--)if(R[T]===L||R[T].listener===L){x=R[T].listener,S=T;break}if(S<0)return this;0===S?R.shift():function(A,P){for(;P+1<A.length;P++)A[P]=A[P+1];A.pop()}(R,S),1===R.length&&(E[P]=R[0]),void 0!==E.removeListener&&this.emit("removeListener",P,x||L)}return this},s.prototype.removeAllListeners=function(P){var L,R,E;if(void 0===(R=this._events))return this;if(void 0===R.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==R[P]&&(0==--this._eventsCount?this._events=Object.create(null):delete R[P]),this;if(0===arguments.length){var T,S=Object.keys(R);for(E=0;E<S.length;++E)"removeListener"!==(T=S[E])&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(L=R[P]))this.removeListener(P,L);else if(void 0!==L)for(E=L.length-1;E>=0;E--)this.removeListener(P,L[E]);return this},s.prototype.listeners=function(P){return y(this,P,!0)},s.prototype.rawListeners=function(P){return y(this,P,!1)},s.listenerCount=function(A,P){return"function"==typeof A.listenerCount?A.listenerCount(P):_.call(A,P)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]}},708:C=>{var w=Object.prototype.hasOwnProperty,a=Object.prototype.toString;C.exports=function(h,o,s){if("[object Function]"!==a.call(o))throw new TypeError("iterator must be a function");var i=h.length;if(i===+i)for(var t=0;t<i;t++)o.call(s,h[t],t,h);else for(var e in h)w.call(h,e)&&o.call(s,h[e],e,h)}},1609:C=>{"use strict";var w="Function.prototype.bind called on incompatible ",a=Array.prototype.slice,p=Object.prototype.toString,h="[object Function]";C.exports=function(s){var i=this;if("function"!=typeof i||p.call(i)!==h)throw new TypeError(w+i);for(var e,t=a.call(arguments,1),r=function(){if(this instanceof e){var b=i.apply(this,t.concat(a.call(arguments)));return Object(b)===b?b:this}return i.apply(s,t.concat(a.call(arguments)))},n=Math.max(0,i.length-t.length),l=[],y=0;y<n;y++)l.push("$"+y);if(e=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(r),i.prototype){var _=function(){};_.prototype=i.prototype,e.prototype=new _,_.prototype=null}return e}},5396:(C,w,a)=>{"use strict";var p=a(1609);C.exports=Function.prototype.bind||p},8540:(C,w,a)=>{"use strict";var p,h=SyntaxError,o=Function,s=TypeError,i=function(x){try{return o('"use strict"; return ('+x+").constructor;")()}catch(M){}},t=Object.getOwnPropertyDescriptor;if(t)try{t({},"")}catch(x){t=null}var e=function(){throw new s},r=t?function(){try{return e}catch(x){try{return t(arguments,"callee").get}catch(M){return e}}}():e,n=a(9326)(),l=Object.getPrototypeOf||function(x){return x.__proto__},y={},_="undefined"==typeof Uint8Array?p:l(Uint8Array),b={"%AggregateError%":"undefined"==typeof AggregateError?p:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?p:ArrayBuffer,"%ArrayIteratorPrototype%":n?l([][Symbol.iterator]()):p,"%AsyncFromSyncIteratorPrototype%":p,"%AsyncFunction%":y,"%AsyncGenerator%":y,"%AsyncGeneratorFunction%":y,"%AsyncIteratorPrototype%":y,"%Atomics%":"undefined"==typeof Atomics?p:Atomics,"%BigInt%":"undefined"==typeof BigInt?p:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?p:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?p:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?p:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?p:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":y,"%Int8Array%":"undefined"==typeof Int8Array?p:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?p:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?p:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":n?l(l([][Symbol.iterator]())):p,"%JSON%":"object"==typeof JSON?JSON:p,"%Map%":"undefined"==typeof Map?p:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&n?l((new Map)[Symbol.iterator]()):p,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?p:Promise,"%Proxy%":"undefined"==typeof Proxy?p:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?p:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?p:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&n?l((new Set)[Symbol.iterator]()):p,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?p:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":n?l(""[Symbol.iterator]()):p,"%Symbol%":n?Symbol:p,"%SyntaxError%":h,"%ThrowTypeError%":r,"%TypedArray%":_,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?p:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?p:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?p:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?p:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?p:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?p:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?p:WeakSet},f=function x(M){var N;if("%AsyncFunction%"===M)N=i("async function () {}");else if("%GeneratorFunction%"===M)N=i("function* () {}");else if("%AsyncGeneratorFunction%"===M)N=i("async function* () {}");else if("%AsyncGenerator%"===M){var j=x("%AsyncGeneratorFunction%");j&&(N=j.prototype)}else if("%AsyncIteratorPrototype%"===M){var $=x("%AsyncGenerator%");$&&(N=l($.prototype))}return b[M]=N,N},u={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},c=a(5396),v=a(7709),g=c.call(Function.call,Array.prototype.concat),A=c.call(Function.apply,Array.prototype.splice),P=c.call(Function.call,String.prototype.replace),L=c.call(Function.call,String.prototype.slice),R=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,S=function(M){var N=L(M,0,1),j=L(M,-1);if("%"===N&&"%"!==j)throw new h("invalid intrinsic syntax, expected closing `%`");if("%"===j&&"%"!==N)throw new h("invalid intrinsic syntax, expected opening `%`");var $=[];return P(M,R,function(V,B,ee,ne){$[$.length]=ee?P(ne,E,"$1"):B||V}),$},T=function(M,N){var $,j=M;if(v(u,j)&&(j="%"+($=u[j])[0]+"%"),v(b,j)){var V=b[j];if(V===y&&(V=f(j)),void 0===V&&!N)throw new s("intrinsic "+M+" exists, but is not available. Please file an issue!");return{alias:$,name:j,value:V}}throw new h("intrinsic "+M+" does not exist!")};C.exports=function(M,N){if("string"!=typeof M||0===M.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof N)throw new s('"allowMissing" argument must be a boolean');var j=S(M),$=j.length>0?j[0]:"",V=T("%"+$+"%",N),B=V.name,ee=V.value,ne=!1,te=V.alias;te&&($=te[0],A(j,g([0,1],te)));for(var W=1,F=!0;W<j.length;W+=1){var O=j[W],k=L(O,0,1),U=L(O,-1);if(('"'===k||"'"===k||"`"===k||'"'===U||"'"===U||"`"===U)&&k!==U)throw new h("property names with quotes must have matching quotes");if(("constructor"===O||!F)&&(ne=!0),v(b,B="%"+($+="."+O)+"%"))ee=b[B];else if(null!=ee){if(!(O in ee)){if(!N)throw new s("base intrinsic for "+M+" exists, but the property is not available.");return}if(t&&W+1>=j.length){var K=t(ee,O);ee=(F=!!K)&&"get"in K&&!("originalValue"in K.get)?K.get:ee[O]}else F=v(ee,O),ee=ee[O];F&&!ne&&(b[B]=ee)}}return ee}},9326:(C,w,a)=>{"use strict";var p="undefined"!=typeof Symbol&&Symbol,h=a(9045);C.exports=function(){return"function"==typeof p&&"function"==typeof Symbol&&"symbol"==typeof p("foo")&&"symbol"==typeof Symbol("bar")&&h()}},9045:C=>{"use strict";C.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var a={},p=Symbol("test"),h=Object(p);if("string"==typeof p||"[object Symbol]"!==Object.prototype.toString.call(p)||"[object Symbol]"!==Object.prototype.toString.call(h))return!1;for(p in a[p]=42,a)return!1;if("function"==typeof Object.keys&&0!==Object.keys(a).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(a).length)return!1;var s=Object.getOwnPropertySymbols(a);if(1!==s.length||s[0]!==p||!Object.prototype.propertyIsEnumerable.call(a,p))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(a,p);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},1407:(C,w,a)=>{"use strict";var p=a(9045);C.exports=function(){return p()&&!!Symbol.toStringTag}},7709:(C,w,a)=>{"use strict";var p=a(5396);C.exports=p.call(Function.call,Object.prototype.hasOwnProperty)},9879:C=>{C.exports="function"==typeof Object.create?function(a,p){p&&(a.super_=p,a.prototype=Object.create(p.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,p){if(p){a.super_=p;var h=function(){};h.prototype=p.prototype,a.prototype=new h,a.prototype.constructor=a}}},7316:(C,w,a)=>{"use strict";var p=a(1407)(),o=a(9568)("Object.prototype.toString"),s=function(r){return!(p&&r&&"object"==typeof r&&Symbol.toStringTag in r)&&"[object Arguments]"===o(r)},i=function(r){return!!s(r)||null!==r&&"object"==typeof r&&"number"==typeof r.length&&r.length>=0&&"[object Array]"!==o(r)&&"[object Function]"===o(r.callee)},t=function(){return s(arguments)}();s.isLegacyArguments=i,C.exports=t?s:i},2197:(C,w,a)=>{"use strict";var e,p=Object.prototype.toString,h=Function.prototype.toString,o=/^\s*(?:function)?\*/,s=a(1407)(),i=Object.getPrototypeOf;C.exports=function(n){if("function"!=typeof n)return!1;if(o.test(h.call(n)))return!0;if(!s)return"[object GeneratorFunction]"===p.call(n);if(!i)return!1;if(void 0===e){var y=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(r){}}();e=!!y&&i(y)}return i(n)===e}},7579:(C,w,a)=>{"use strict";var p=a(708),h=a(5127),o=a(9568),s=o("Object.prototype.toString"),i=a(1407)(),t="undefined"==typeof globalThis?global:globalThis,e=h(),r=o("Array.prototype.indexOf",!0)||function(u,c){for(var v=0;v<u.length;v+=1)if(u[v]===c)return v;return-1},n=o("String.prototype.slice"),l={},y=a(7168),_=Object.getPrototypeOf;i&&y&&_&&p(e,function(f){var u=new t[f];if(Symbol.toStringTag in u){var c=_(u),v=y(c,Symbol.toStringTag);if(!v){var g=_(c);v=y(g,Symbol.toStringTag)}l[f]=v.get}}),C.exports=function(u){if(!u||"object"!=typeof u)return!1;if(!i||!(Symbol.toStringTag in u)){var c=n(s(u),8,-1);return r(e,c)>-1}return!!y&&function(u){var c=!1;return p(l,function(v,g){if(!c)try{c=v.call(u)===g}catch(A){}}),c}(u)}},3726:(C,w,a)=>{C.exports=a(1637)},1637:(C,w,a)=>{var p=a(1732),h=C.exports=a(2628);function o(r,n,l,y){var b=new r(p.format.apply(this,[l=l||""].concat(y)));throw Error.captureStackTrace(b,n),b}function s(r,n,l){o(h.IllegalArgumentError,r,n,l)}function i(r,n,l){o(h.IllegalStateError,r,n,l)}function t(r){var n=typeof r;if("object"==n){if(!r)return"null";if(r instanceof Array)return"array"}return n}function e(r){return function(n,l){var y=t(n);if(y==r)return n;s(arguments.callee,l||'Expected "'+r+'" but got "'+y+'".',Array.prototype.slice.call(arguments,2))}}C.exports.checkArgument=function(r,n){r||s(arguments.callee,n,Array.prototype.slice.call(arguments,2))},C.exports.checkState=function(r,n){r||i(arguments.callee,n,Array.prototype.slice.call(arguments,2))},C.exports.checkIsDef=function(r,n){if(void 0!==r)return r;s(arguments.callee,n||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},C.exports.checkIsDefAndNotNull=function(r,n){if(null!=r)return r;s(arguments.callee,n||'Expected value to be defined and not null but got "'+t(r)+'".',Array.prototype.slice.call(arguments,2))},C.exports.checkIsString=e("string"),C.exports.checkIsArray=e("array"),C.exports.checkIsNumber=e("number"),C.exports.checkIsBoolean=e("boolean"),C.exports.checkIsFunction=e("function"),C.exports.checkIsObject=e("object")},2628:(C,w,a)=>{var p=a(1732);function h(s){Error.call(this,s),this.message=s}function o(s){Error.call(this,s),this.message=s}p.inherits(h,Error),h.prototype.name="IllegalArgumentError",p.inherits(o,Error),o.prototype.name="IllegalStateError",C.exports.IllegalStateError=o,C.exports.IllegalArgumentError=h},4209:(C,w,a)=>{"use strict";var p=a(617);C.exports=function(o,s,i,t){var e,r=new Error("Canceled");return new p(function(l,y,_){var b;o(function(u){return _()?p.reject(r):(b=s(u),i(b).then(function(v){if(_())throw r;return e=v()}))}).then(function(u){if(_())throw u.disconnect(),r;l(t(b,u))}).catch(function(u){y(u)})},function(){e&&e.cancel()})}},3232:(C,w,a)=>{"use strict";var p=a(4135).MediaStreamTrack,h=a(4911),o=h.guessBrowser,s=h.guessBrowserVersion,i=a(4209),t=a(5085),e=a(3472),r=a(3066),n=a(7217),l=a(1865),y=l.LocalAudioTrack,_=l.LocalDataTrack,b=l.LocalVideoTrack,f=a(6062),u=a(7970),c=a(9003),v=a(3761),g=v.asLocalTrack,A=v.buildLogLevels,P=v.filterObject,L=v.isNonArrayObject,R=a(9917),E=R.DEFAULT_ENVIRONMENT,S=R.DEFAULT_LOG_LEVEL,T=R.DEFAULT_LOGGER_NAME,x=R.DEFAULT_REALM,M=R.DEFAULT_REGION,N=R.WS_SERVER,j=R.SDK_NAME,$=R.SDK_VERSION,V=R.typeErrors,B=a(617),ee=a(8326),ne=a(7394),te=a(6901).kG,W="safari"===o()&&s(),F=0,O=!1,k=!1;if(W){var U=W.major;k=U<12||12===U&&W.minor<1}var re=new Set([{didWarn:!1,shouldDelete:!0,name:"abortOnIceServersTimeout"},{didWarn:!1,shouldDelete:!0,name:"dscpTagging",newName:"enableDscp"},{didWarn:!1,shouldDelete:!0,name:"iceServersTimeout"},{didWarn:!1,shouldDelete:!1,name:"eventListener",newName:"Video.Logger"},{didWarn:!1,shouldDelete:!1,name:"logLevel",newName:"Video.Logger"}]),J=new Set([{didWarn:!1,shouldDelete:!1,name:"maxTracks",newName:"bandwidthProfile.video.clientTrackSwitchOffControl"},{didWarn:!1,shouldDelete:!1,name:"renderDimensions",newName:"bandwidthProfile.video.contentPreferencesMode"}]);function Z(me,fe,xe){xe.forEach(function(Ne){var Ue=Ne.didWarn,Fe=Ne.name,Ve=Ne.newName,je=Ne.shouldDelete;Fe in me&&void 0!==me[Fe]&&(Ve&&je&&(me[Ve]=me[Fe]),je&&delete me[Fe],!Ue&&!["error","off"].includes(fe.level)&&(fe.warn('The ConnectOptions "'+Fe+'" is '+(Ve?'deprecated and scheduled for removal. Please use "'+Ve+'" instead.':"no longer applicable and will be ignored.")),Ne.didWarn=!0))})}function ie(me,fe,xe,Ne,Ue,Fe){var Ve=me.createLocalParticipantSignaling(xe,Ne);return fe.debug("Creating a new LocalParticipant:",Ve),new Ue.LocalParticipant(Ve,Fe,Ue)}function ae(me,fe,xe){var Ne=new u(fe,xe,me),Ue=me.log;return Ue.debug("Creating a new Room:",Ne),xe.on("stateChanged",function Fe(Ve){"disconnected"===Ve&&(Ue.info("Disconnected from Room:",Ne.toString()),xe.removeListener("stateChanged",Fe))}),Ne}function H(me,fe,xe,Ne,Ue,Fe){return fe.log.debug("Creating a new RoomSignaling"),xe.connect(Fe._signaling,me,Ne,Ue,fe)}function D(me,fe){var xe=me.log;return me.shouldStopLocalTracks=!me.tracks,me.shouldStopLocalTracks?xe.info("LocalTracks were not provided, so they will be acquired automatically before connecting to the Room. LocalTracks will be released if connecting to the Room fails or if the Room is disconnected"):(xe.info("Getting LocalTracks"),xe.debug("Options:",me)),me.createLocalTracks(me).then(function(Ue){var Fe=fe(Ue);return Fe.catch(function(){me.shouldStopLocalTracks&&(xe.info("The automatically acquired LocalTracks will now be stopped"),Ue.forEach(function(je){je.stop()}))}),Fe})}function Q(me){var fe="string"==typeof me?{codec:me}:me;switch(fe.codec.toLowerCase()){case"opus":return Object.assign({dtx:!0},fe);case"vp8":return Object.assign({simulcast:!1},fe);default:return fe}}C.exports=function(me,fe){if(void 0===fe&&(fe={}),!L(fe))return B.reject(V.INVALID_TYPE("options","object"));var je,xe=fe.Log||ne,Ne=fe.loggerName||T,Ue=fe.logLevel||S,Fe=A(Ue),Ve="[connect #"+ ++F+"]";try{je=new xe("default",Ve,Fe,Ne)}catch(Ee){return B.reject(Ee)}Z(fe,je,re);var ze="auto"===fe.preferredVideoCodecs;if(ze&&(fe.preferredVideoCodecs=[{codec:"VP8",simulcast:!0,adaptiveSimulcast:!0}]),fe.maxVideoBitrate&&ze)return je.error('ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'),B.reject(V.ILLEGAL_INVOKE("connect",'ConnectOptions "maxVideoBitrate" is not compatible with "preferredVideoCodecs=auto"'));var ge={};"string"==typeof(fe=Object.assign({automaticSubscription:!0,dominantSpeaker:!1,enableDscp:!1,environment:E,eventListener:null,insights:!0,LocalAudioTrack:y,LocalDataTrack:_,LocalParticipant:e,LocalVideoTrack:b,Log:xe,MediaStreamTrack:p,loggerName:Ne,logLevel:Ue,maxAudioBitrate:null,maxVideoBitrate:null,name:null,networkMonitor:!0,networkQuality:!1,preferredAudioCodecs:[],preferredVideoCodecs:[],realm:x,region:M,signaling:c},P(fe))).wsServerInsights&&(ge.gateway=fe.wsServerInsights);var G=new(fe.insights?r:n)(me,j,$,fe.environment,fe.realm,ge),X=N(fe.environment,fe.region),se=new ee(G,Date.now(),je,fe.eventListener);if((fe=Object.assign({eventObserver:se,wsServer:X},fe)).log=je,k&&!O&&"error"!==je.logLevel&&"off"!==je.logLevel&&(O=!0,je.warn(["Support for Safari 12.0 and below is limited because it does not support VP8.","This means you may experience codec issues in Group Rooms. You may also","experience codec issues in Peer-to-Peer (P2P) Rooms containing Android- or","iOS-based Participants who do not support H.264. However, P2P Rooms","with browser-based Participants should work. For more information, please","refer to this guide: https://www.twilio.com/docs/video/javascript-v2-developing-safari-11"].join(" "))),"string"!=typeof me)return B.reject(V.INVALID_TYPE("token","string"));var ce=Object.assign({},fe);if(delete ce.name,"tracks"in fe){if(!Array.isArray(fe.tracks))return B.reject(V.INVALID_TYPE("options.tracks","Array of LocalAudioTrack, LocalVideoTrack or MediaStreamTrack"));try{fe.tracks=fe.tracks.map(function(Ee){return g(Ee,ce)})}catch(Ee){return B.reject(Ee)}}var he=te(fe.bandwidthProfile);if(he)return B.reject(he);fe.clientTrackSwitchOffControl="disabled",fe.contentPreferencesMode="disabled",fe.bandwidthProfile&&(fe.clientTrackSwitchOffControl="auto",fe.contentPreferencesMode="auto",fe.bandwidthProfile.video&&(Z(fe.bandwidthProfile.video,je,J),fe.clientTrackSwitchOffControl="maxTracks"in fe.bandwidthProfile.video?"disabled":"manual"===fe.bandwidthProfile.video.clientTrackSwitchOffControl?"manual":"auto",fe.contentPreferencesMode="renderDimensions"in fe.bandwidthProfile.video?"disabled":"manual"===fe.bandwidthProfile.video.contentPreferencesMode?"manual":"auto"));var De=new(0,fe.signaling)(fe.wsServer,fe);je.info("Connecting to a Room"),je.debug("Options:",fe);var We=new t({maxAudioBitrate:fe.maxAudioBitrate,maxVideoBitrate:fe.maxVideoBitrate},ze),He={audio:fe.preferredAudioCodecs.map(Q),video:fe.preferredVideoCodecs.map(Q)},Ie=new f(L(fe.networkQuality)?fe.networkQuality:{}),Me=i(D.bind(null,fe),ie.bind(null,De,je,We,Ie,fe),H.bind(null,me,fe,De,We,He),ae.bind(null,fe));return Me.then(function(Ee){return G.connect(Ee.sid,Ee.localParticipant.sid),je.info("Connected to Room:",Ee.toString()),je.info("Room name:",Ee.name),je.debug("Room:",Ee),Ee.once("disconnected",function(){return G.disconnect()}),Ee},function(Ee){G.disconnect(),Me._isCanceled?je.info("Attempt to connect to a Room was canceled"):je.info("Error while connecting to a Room:",Ee)}),Me}},9292:(C,w,a)=>{"use strict";var p=a(9917),h=p.DEFAULT_LOG_LEVEL,o=p.DEFAULT_LOGGER_NAME;function s(e,r){r=Object.assign({loggerName:o,logLevel:h},r);var n={};n.loggerName=r.loggerName,n.logLevel=r.logLevel,delete r.loggerName,delete r.logLevel;var l=r.createLocalTracks;return delete r.createLocalTracks,n[e]=!(Object.keys(r).length>0)||r,l(n).then(function(y){return y[0]})}C.exports={audio:function(e){return s("audio",e)},video:function(e){return s("video",e)}}},8953:function(C,w,a){"use strict";var p=this&&this.__assign||function(){return(p=Object.assign||function(E){for(var S,T=1,x=arguments.length;T<x;T++)for(var M in S=arguments[T])Object.prototype.hasOwnProperty.call(S,M)&&(E[M]=S[M]);return E}).apply(this,arguments)},h=this&&this.__awaiter||function(E,S,T,x){return new(T||(T=Promise))(function(N,j){function $(ee){try{B(x.next(ee))}catch(ne){j(ne)}}function V(ee){try{B(x.throw(ee))}catch(ne){j(ne)}}function B(ee){ee.done?N(ee.value):function(N){return N instanceof T?N:new T(function(j){j(N)})}(ee.value).then($,V)}B((x=x.apply(E,S||[])).next())})},o=this&&this.__generator||function(E,S){var x,M,N,j,T={label:0,sent:function(){if(1&N[0])throw N[1];return N[1]},trys:[],ops:[]};return j={next:$(0),throw:$(1),return:$(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function $(B){return function(ee){return function(B){if(x)throw new TypeError("Generator is already executing.");for(;T;)try{if(x=1,M&&(N=2&B[0]?M.return:B[0]?M.throw||((N=M.return)&&N.call(M),0):M.next)&&!(N=N.call(M,B[1])).done)return N;switch(M=0,N&&(B=[2&B[0],N.value]),B[0]){case 0:case 1:N=B;break;case 4:return T.label++,{value:B[1],done:!1};case 5:T.label++,M=B[1],B=[0];continue;case 7:B=T.ops.pop(),T.trys.pop();continue;default:if(!(N=(N=T.trys).length>0&&N[N.length-1])&&(6===B[0]||2===B[0])){T=0;continue}if(3===B[0]&&(!N||B[1]>N[0]&&B[1]<N[3])){T.label=B[1];break}if(6===B[0]&&T.label<N[1]){T.label=N[1],N=B;break}if(N&&T.label<N[2]){T.label=N[2],T.ops.push(B);break}N[2]&&T.ops.pop(),T.trys.pop();continue}B=S.call(E,T)}catch(ee){B=[6,ee],M=0}finally{x=N=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([B,ee])}}},s=this&&this.__read||function(E,S){var T="function"==typeof Symbol&&E[Symbol.iterator];if(!T)return E;var M,j,x=T.call(E),N=[];try{for(;(void 0===S||S-- >0)&&!(M=x.next()).done;)N.push(M.value)}catch($){j={error:$}}finally{try{M&&!M.done&&(T=x.return)&&T.call(x)}finally{if(j)throw j.error}}return N},i=this&&this.__spreadArray||function(E,S){for(var T=0,x=S.length,M=E.length;T<x;T++,M++)E[M]=S[T];return E};Object.defineProperty(w,"__esModule",{value:!0}),w.createLocalTracks=void 0;var t=a(3761),e=t.asLocalTrack,r=t.buildLogLevels,n=a(4135),l=n.getUserMedia,y=n.MediaStreamTrack,_=a(1865),b=_.LocalAudioTrack,f=_.LocalDataTrack,u=_.LocalVideoTrack,c=a(7394),v=a(9917),g=v.DEFAULT_LOG_LEVEL,A=v.DEFAULT_LOGGER_NAME,P=a(8201),L=0;w.createLocalTracks=function(E){return h(this,void 0,void 0,function(){var S,T,x,M,N,j,$,V,B,ee,ne,te;return o(this,function(W){switch(W.label){case 0:if(T=p({audio:S=!(E&&("audio"in E||"video"in E)),getUserMedia:l,loggerName:A,logLevel:g,LocalAudioTrack:b,LocalDataTrack:f,LocalVideoTrack:u,MediaStreamTrack:y,Log:c,video:S},E),x="[createLocalTracks #"+ ++L+"]",M=r(T.logLevel),N=new T.Log("default",x,M,T.loggerName),delete(j=Object.assign({log:N},T)).name,!1===T.audio&&!1===T.video)return N.info("Neither audio nor video requested, so returning empty LocalTracks"),[2,[]];if(T.tracks)return N.info("Adding user-provided LocalTracks"),N.debug("LocalTracks:",T.tracks),[2,T.tracks];($={audio:"object"==typeof T.audio&&T.audio.name?{name:T.audio.name}:{},video:"object"==typeof T.video&&T.video.name?{name:T.video.name}:{}}).audio.isCreatedByCreateLocalTracks=!0,$.video.isCreatedByCreateLocalTracks=!0,"object"==typeof T.audio&&"boolean"==typeof T.audio.workaroundWebKitBug1208516&&($.audio.workaroundWebKitBug1208516=T.audio.workaroundWebKitBug1208516),"object"==typeof T.video&&"boolean"==typeof T.video.workaroundWebKitBug1208516&&($.video.workaroundWebKitBug1208516=T.video.workaroundWebKitBug1208516),"object"==typeof T.audio&&delete T.audio.name,"object"==typeof T.video&&delete T.video.name,V={audio:T.audio,video:T.video},B="object"==typeof T.audio&&T.audio.workaroundWebKitBug180748,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,B?P(N,T.getUserMedia,V):T.getUserMedia(V)];case 2:return ee=W.sent(),ne=i(i([],s(ee.getAudioTracks())),s(ee.getVideoTracks())),N.info("Call to getUserMedia successful; got MediaStreamTracks:",ne),[2,ne.map(function(F){return e(F,p(p({},$[F.kind]),j))})];case 3:throw te=W.sent(),N.warn("Call to getUserMedia failed:",te),te;case 4:return[2]}})})}},1144:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(747),o=a(2630),s=function(i){function t(e){var r=i.call(this,e.label,e.maxPacketLifeTime,e.maxRetransmits,e.ordered)||this;return Object.defineProperties(r,{_dataChannel:{value:e}}),e.binaryType="arraybuffer",e.addEventListener("message",function(n){r.emit("message",n.data)}),e.addEventListener("close",function(){r.emit("close")}),r}return p(t,i),t.prototype.stop=function(){this._dataChannel.close(),i.prototype.stop.call(this)},t.prototype.toDataTransport=function(){return new o(this._dataChannel)},t}(h);C.exports=s},920:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(747),o=a(3761).makeUUID,s=function(i){function t(e,r,n){var l=i.call(this,o(),e,r,n)||this;return Object.defineProperties(l,{_clones:{value:new Set},_dataChannels:{value:new Set}}),l}return p(t,i),t.prototype._addClone=function(e){this._clones.add(e)},t.prototype.removeClone=function(e){this._clones.delete(e)},t.prototype.addDataChannel=function(e){return this._dataChannels.add(e),this},t.prototype.clone=function(){var e=this,r=new t(this.maxPacketLifeTime,this.maxRetransmits,this.ordered);return this._addClone(r),r.once("stopped",function(){return e.removeClone(r)}),r},t.prototype.removeDataChannel=function(e){return this._dataChannels.delete(e),this},t.prototype.send=function(e){return this._dataChannels.forEach(function(r){try{r.send(e)}catch(n){}}),this._clones.forEach(function(r){try{r.send(e)}catch(n){}}),this},t.prototype.stop=function(){this._dataChannels.forEach(function(e){return e.close()}),this._clones.forEach(function(e){return e.stop()}),i.prototype.stop.call(this)},t}(h);C.exports=s},747:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n){var l=s.call(this,t,"data")||this;return Object.defineProperties(l,{maxPacketLifeTime:{enumerable:!0,value:e},maxRetransmits:{enumerable:!0,value:r},ordered:{enumerable:!0,value:n}}),l}return p(i,s),i}(a(8699));C.exports=o},2630:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t){var e=s.call(this)||this;return Object.defineProperties(e,{_dataChannel:{value:t},_messageQueue:{value:[]}}),t.addEventListener("open",function(){e._messageQueue.splice(0).forEach(function(r){return e._publish(r)})}),t.addEventListener("message",function(r){var n=r.data;try{var l=JSON.parse(n);e.emit("message",l)}catch(y){}}),e.publish({type:"ready"}),e}return p(i,s),i.prototype._publish=function(t){var e=JSON.stringify(t);try{this._dataChannel.send(e)}catch(r){}},i.prototype.publish=function(t){var e=this._dataChannel;return"closing"!==e.readyState&&"closed"!==e.readyState&&("connecting"===e.readyState?(this._messageQueue.push(t),!0):(this._publish(t),!0))},i}(a(3105).EventEmitter);C.exports=o},5085:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this)||this;return t=Object.assign({maxAudioBitrate:null,maxVideoBitrate:null},t),Object.defineProperties(r,{maxAudioBitrate:{value:t.maxAudioBitrate,writable:!0},maxVideoBitrate:{value:t.maxVideoBitrate,writable:!0},adaptiveSimulcast:{value:e}}),r}return p(i,s),i.prototype.toJSON=function(){return{maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate}},i.prototype.update=function(t){var e=this;t=Object.assign({maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate},t),["maxAudioBitrate","maxVideoBitrate"].reduce(function(n,l){return e[l]!==t[l]&&(e[l]=t[l],n=!0),n},!1)&&this.emit("changed")},i}(a(3105).EventEmitter);C.exports=o},5737:(C,w,a)=>{"use strict";var p=a(3105).EventEmitter,h=a(3761).hidePrivateAndCertainPublicPropertiesInClass;C.exports=h(p,["domain"])},8987:function(C,w,a){"use strict";var p=this&&this.__assign||function(){return(p=Object.assign||function(f){for(var u,c=1,v=arguments.length;c<v;c++)for(var g in u=arguments[c])Object.prototype.hasOwnProperty.call(u,g)&&(f[g]=u[g]);return f}).apply(this,arguments)};Object.defineProperty(w,"__esModule",{value:!0});var h=a(8953),o=a(712),s={connect:a(3232),createLocalAudioTrack:a(9292).audio,createLocalVideoTrack:a(9292).video,isSupported:a(563)(),version:a(1730).version,Logger:a(6828),LocalAudioTrack:a(1865).LocalAudioTrack,LocalDataTrack:a(1865).LocalDataTrack,LocalVideoTrack:a(1865).LocalVideoTrack};C.exports={connect:function(f,u){var c=p({createLocalTracks:h.createLocalTracks},u);return s.connect(f,c)},createLocalAudioTrack:function(f){var u=p({createLocalTracks:h.createLocalTracks},f);return s.createLocalAudioTrack(u)},createLocalVideoTrack:function(f){var u=p({createLocalTracks:h.createLocalTracks},f);return s.createLocalVideoTrack(u)},createLocalTracks:h.createLocalTracks,runPreflight:o.runPreflight,isSupported:s.isSupported,version:s.version,Logger:s.Logger,LocalAudioTrack:s.LocalAudioTrack,LocalVideoTrack:s.LocalVideoTrack,LocalDataTrack:s.LocalDataTrack}},3472:function(C,w,a){"use strict";var L,p=this&&this.__extends||(L=function(R,E){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,T){S.__proto__=T}||function(S,T){for(var x in T)Object.prototype.hasOwnProperty.call(T,x)&&(S[x]=T[x])})(R,E)},function(R,E){if("function"!=typeof E&&null!==E)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function S(){this.constructor=R}L(R,E),R.prototype=null===E?Object.create(E):(S.prototype=E.prototype,new S)}),h=a(4135).MediaStreamTrack,o=a(3761),s=o.asLocalTrack,i=o.asLocalTrackPublication,t=o.trackClass,e=a(9917),r=e.typeErrors,n=e.trackPriority,l=a(6901).Wv,y=a(1865),_=y.LocalAudioTrack,b=y.LocalDataTrack,f=y.LocalVideoTrack,u=a(4167),c=a(7969),v=a(6156),A=function(L){function R(E,S,T){var x=this,M=(T=Object.assign({LocalAudioTrack:_,LocalVideoTrack:f,LocalDataTrack:b,MediaStreamTrack:h,LocalAudioTrackPublication:u,LocalVideoTrackPublication:v,LocalDataTrackPublication:c,shouldStopLocalTracks:!1,tracks:S},T)).shouldStopLocalTracks?new Set(S.filter(function(N){return"data"!==N.kind})):new Set;return x=L.call(this,E,T)||this,Object.defineProperties(x,{_eventObserver:{value:T.eventObserver},_LocalAudioTrack:{value:T.LocalAudioTrack},_LocalDataTrack:{value:T.LocalDataTrack},_LocalVideoTrack:{value:T.LocalVideoTrack},_MediaStreamTrack:{value:T.MediaStreamTrack},_LocalAudioTrackPublication:{value:T.LocalAudioTrackPublication},_LocalDataTrackPublication:{value:T.LocalDataTrackPublication},_LocalVideoTrackPublication:{value:T.LocalVideoTrackPublication},_tracksToStop:{value:M},signalingRegion:{enumerable:!0,get:function(){return E.signalingRegion}}}),x._handleTrackSignalingEvents(),x}return p(R,L),R.prototype._addTrack=function(E,S,T){var x=L.prototype._addTrack.call(this,E,S);return x&&"disconnected"!==this.state&&this._addLocalTrack(E,T),x},R.prototype._addLocalTrack=function(E,S){this._signaling.addTrack(E._trackSender,E.name,S),this._log.info("Added a new "+t(E,!0)+":",E.id),this._log.debug(t(E,!0)+":",E)},R.prototype._removeTrack=function(E,S){var T=L.prototype._removeTrack.call(this,E,S);return T&&"disconnected"!==this.state&&(this._signaling.removeTrack(E._trackSender),this._log.info("Removed a "+t(E,!0)+":",E.id),this._log.debug(t(E,!0)+":",E)),T},R.prototype._getTrackEvents=function(){return L.prototype._getTrackEvents.call(this).concat([["disabled","trackDisabled"],["enabled","trackEnabled"],["stopped","trackStopped"]])},R.prototype.toString=function(){return"[LocalParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},R.prototype._handleTrackSignalingEvents=function(){var E=this,S=this._log;if("disconnected"!==this.state){var T=this._signaling;this.on("trackDisabled",x),this.on("trackEnabled",M),this.on("trackStopped",N),this._tracks.forEach(function($){E._addLocalTrack($,n.PRIORITY_STANDARD),E._getOrCreateLocalTrackPublication($).catch(function(V){S.warn("Failed to get or create LocalTrackPublication for "+$+":",V)})});var j=this;T.on("stateChanged",function $(V){S.debug("Transitioned to state:",V),"disconnected"===V?(S.debug("Removing LocalTrack event listeners"),T.removeListener("stateChanged",$),j.removeListener("trackDisabled",x),j.removeListener("trackEnabled",M),j.removeListener("trackStopped",N),j._tracks.forEach(function(B){var ee=N(B);ee&&B._trackSender.removeClone(ee._trackTransceiver)}),S.info("LocalParticipant disconnected. Stopping "+j._tracksToStop.size+" automatically-acquired LocalTracks"),j._tracksToStop.forEach(function(B){B.stop()})):"connected"===V&&(S.info("reconnected"),setTimeout(function(){return j.emit("reconnected")},0))})}function x($){var V=T.getPublication($._trackSender);V&&(V.disable(),S.debug("Disabled the "+t($,!0)+":",$.id))}function M($){var V=T.getPublication($._trackSender);V&&(V.enable(),S.debug("Enabled the "+t($,!0)+":",$.id))}function N($){var V=T.getPublication($._trackSender);return V&&V.stop(),V}},R.prototype._getOrCreateLocalTrackPublication=function(E){var S=P(this.tracks,E);if(S)return Promise.resolve(S);var T=this._log,x=this,M=this._signaling.getPublication(E._trackSender);if(!M)return Promise.reject(new Error("Unexpected error: The "+E+" cannot be published"));function N(j){x.unpublishTrack(j.track)}return new Promise(function(j,$){M.on("updated",function V(){var B=M.error;if(B)return M.removeListener("updated",V),T.warn("Failed to publish the "+t(E,!0)+": "+B.message),x._removeTrack(E,E.id),setTimeout(function(){x.emit("trackPublicationFailed",B,E)}),void $(B);if(!x._tracks.has(E.id))return M.removeListener("updated",V),void $(new Error("The "+E+" was unpublished"));if(M.sid){M.removeListener("updated",V);var ne={log:T,LocalAudioTrackPublication:x._LocalAudioTrackPublication,LocalDataTrackPublication:x._LocalDataTrackPublication,LocalVideoTrackPublication:x._LocalVideoTrackPublication};(S=P(x.tracks,E))||(S=i(E,M,N,ne),x._addTrackPublication(S));var te=x._signaling.state;("connected"===te||"connecting"===te)&&(E._processorEventObserver&&E._processorEventObserver.on("event",function(W){x._eventObserver.emit("event",{name:W.name,payload:W.data,group:"video-processor",level:"info"})}),E.processedTrack&&(E._captureFrames(),E._setSenderMediaStreamTrack(!0))),"connected"===te&&setTimeout(function(){x.emit("trackPublished",S)}),j(S)}})})},R.prototype.publishTrack=function(E,S){var x,T=P(this.tracks,E);if(T)return Promise.resolve(T);S=Object.assign({log:this._log,priority:n.PRIORITY_STANDARD,LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack},S);try{x=s(E,S)}catch(j){return Promise.reject(j)}var M=Object.values(n);if(!M.includes(S.priority))return Promise.reject(r.INVALID_VALUE("LocalTrackPublishOptions.priority",M));var N=this._addTrack(x,x.id,S.priority)||this._tracks.get(x.id);return this._getOrCreateLocalTrackPublication(N)},R.prototype.publishTracks=function(E){if(!Array.isArray(E))throw r.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return Promise.all(E.map(this.publishTrack,this))},R.prototype.setBandwidthProfile=function(){this._log.warn("setBandwidthProfile is not implemented yet and may be available in future versions of twilio-video.js")},R.prototype.setNetworkQualityConfiguration=function(E){if("object"!=typeof E||null===E)throw r.INVALID_TYPE("networkQualityConfiguration","NetworkQualityConfiguration");return["local","remote"].forEach(function(S){if(S in E&&("number"!=typeof E[S]||isNaN(E[S])))throw r.INVALID_TYPE("networkQualityConfiguration."+S,"number")}),this._signaling.setNetworkQualityConfiguration(E),this},R.prototype.setParameters=function(E){if(void 0!==E&&"object"!=typeof E)throw r.INVALID_TYPE("encodingParameters","EncodingParameters, null or undefined");if(E){if(this._signaling.getParameters().adaptiveSimulcast&&E.maxVideoBitrate)throw r.INVALID_TYPE("encodingParameters",'encodingParameters.maxVideoBitrate is not compatible with "preferredVideoCodecs=auto"');["maxAudioBitrate","maxVideoBitrate"].forEach(function(S){if(void 0!==E[S]&&"number"!=typeof E[S]&&null!==E[S])throw r.INVALID_TYPE("encodingParameters."+S,"number, null or undefined")})}else null===E&&(E={maxAudioBitrate:null,maxVideoBitrate:null});return this._signaling.setParameters(E),this},R.prototype.unpublishTrack=function(E){l(E,{LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack});var S=this._tracks.get(E.id);if(!S)return null;if(this._signaling.getPublication(S._trackSender).publishFailed(new Error("The "+S+" was unpublished")),!(S=this._removeTrack(S,S.id)))return null;var x=P(this.tracks,S);return x&&this._removeTrackPublication(x),x},R.prototype.unpublishTracks=function(E){var S=this;if(!Array.isArray(E))throw r.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return E.reduce(function(T,x){var M=S.unpublishTrack(x);return M?T.concat(M):T},[])},R}(a(5513));function P(L,R){return Array.from(L.values()).find(function(E){return E.track===R||E.track.mediaStreamTrack===R})||null}C.exports=A},13:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t,e)||this}return p(i,s),i.prototype._start=function(){s.prototype._start.call(this),this._dummyEl&&(this._dummyEl.srcObject=null,this._dummyEl=null)},i.prototype.attach=function(){return s.prototype.attach.apply(this,arguments)},i.prototype.detach=function(){return s.prototype.detach.apply(this,arguments)},i}(a(3014));C.exports=o},1865:(C,w,a)=>{"use strict";C.exports={LocalAudioTrack:a(7121),LocalVideoTrack:a(9646),LocalDataTrack:a(7913)}},7121:(C,w,a)=>{"use strict";var p=a(1732).inherits,h=a(7292);function o(s,i){var t=new h(s,i);return Object.setPrototypeOf(t,o.prototype),t}p(o,h),C.exports=o},7913:(C,w,a)=>{"use strict";var p=a(1732).inherits,h=a(1317);function o(s){var i=new h(s);return Object.setPrototypeOf(i,o.prototype),i}p(o,h),C.exports=o},9646:(C,w,a)=>{"use strict";var p=a(1732).inherits,h=a(149);function o(s,i){var t=new h(s,i);return Object.setPrototypeOf(t,o.prototype),t}p(o,h),C.exports=o},5142:function(C,w,a){"use strict";var l,p=this&&this.__extends||(l=function(y,_){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,f){b.__proto__=f}||function(b,f){for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&(b[u]=f[u])})(y,_)},function(y,_){if("function"!=typeof _&&null!==_)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function b(){this.constructor=y}l(y,_),y.prototype=null===_?Object.create(_):(b.prototype=_.prototype,new b)}),h=a(5737),o=a(3761),s=o.buildLogLevels,i=o.valueToJSON,t=a(9917).DEFAULT_LOG_LEVEL,e=a(7394),r=0,n=function(l){function y(_,b,f){var u;f=Object.assign({name:_,log:null,logLevel:t},f),u=l.call(this)||this;var c=String(f.name),v=s(f.logLevel),g=f.log?f.log.createLog("media",u):new e("media",u,v,f.loggerName);return Object.defineProperties(u,{_instanceId:{value:++r},_log:{value:g},kind:{enumerable:!0,value:b},name:{enumerable:!0,value:c}}),u}return p(y,l),y.prototype.toJSON=function(){return i(this)},y}(h);C.exports=n},7292:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(13),i=function(t){function e(r,n){return t.call(this,r,n)||this}return p(e,t),e.prototype.toString=function(){return"[LocalAudioTrack #"+this._instanceId+": "+this.id+"]"},e.prototype.attach=function(r){return(r=t.prototype.attach.call(this,r)).muted=!0,r},e.prototype._end=function(){return t.prototype._end.apply(this,arguments)},e.prototype.disable=function(){return t.prototype.disable.apply(this,arguments)},e.prototype.enable=function(){return t.prototype.enable.apply(this,arguments)},e.prototype.restart=function(){return t.prototype.restart.apply(this,arguments)},e.prototype.stop=function(){return t.prototype.stop.apply(this,arguments)},e}(a(6217)(h));C.exports=i},4167:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n){return s.call(this,t,e,r,n)||this}return p(i,s),i.prototype.toString=function(){return"[LocalAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(5181));C.exports=o},1317:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(5142),o=a(920),s=function(i){function t(e){var r,l=new(0,(e=Object.assign({DataTrackSender:o,maxPacketLifeTime:null,maxRetransmits:null,ordered:!0},e)).DataTrackSender)(e.maxPacketLifeTime,e.maxRetransmits,e.ordered);return r=i.call(this,l.id,"data",e)||this,Object.defineProperties(r,{_trackSender:{value:l},id:{enumerable:!0,value:l.id},maxPacketLifeTime:{enumerable:!0,value:e.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:e.maxRetransmits},ordered:{enumerable:!0,value:e.ordered},reliable:{enumerable:!0,value:null===e.maxPacketLifeTime&&null===e.maxRetransmits}}),r}return p(t,i),t.prototype.send=function(e){this._trackSender.send(e)},t}(h);C.exports=s},7969:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n){return s.call(this,t,e,r,n)||this}return p(i,s),i.prototype.toString=function(){return"[LocalDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(5181));C.exports=o},6217:function(C,w,a){"use strict";var L,p=this&&this.__extends||(L=function(R,E){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,T){S.__proto__=T}||function(S,T){for(var x in T)Object.prototype.hasOwnProperty.call(T,x)&&(S[x]=T[x])})(R,E)},function(R,E){if("function"!=typeof E&&null!==E)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function S(){this.constructor=R}L(R,E),R.prototype=null===E?Object.create(E):(S.prototype=E.prototype,new S)}),h=a(4135).getUserMedia,o=a(4911),s=o.guessBrowser,i=o.isIOSChrome,t=a(3761),e=t.capitalize,r=t.defer,n=t.isUserMediaTrack,l=t.waitForSometime,y=t.waitForEvent,_=a(9917).typeErrors.ILLEGAL_INVOKE,b=a(3305),f=a(4139),u=a(296),c=a(9388),v=a(8201),g=a(5550);function P(L){var R=L._log,E=L.kind,S={audio:b,video:f}[E],T=L._dummyEl,x=L.mediaStreamTrack,M=null;function $(){return Promise.race([y(x,"unmute"),l(50)]).then(function(){return F=L.mediaStreamTrack.muted,O=L.isStopped&&!!L._workaroundWebKitBug1208516Cleanup,Promise.resolve().then(function(){return"visible"===document.visibilityState&&!M&&(F||O||T.play().then(function(){return S(T)}).then(function(te){return te?R.warn("Silence detected"):R.info("Non-silence detected"),te}).catch(function(te){R.warn("Failed to detect silence:",te)}).finally(function(){T.pause()}))});var F,O}).then(function(te){return te&&!M&&(M=r(),L._restart().finally(function(){T=L._dummyEl,ee(),x=L.mediaStreamTrack,B(),M.resolve(),M=null}).catch(function(F){R.error("failed to restart track: ",F)})),(M&&M.promise||Promise.resolve()).finally(function(){return c.resolveDeferred(E)})}).catch(function(te){R.error("error in maybeRestart: "+te.message)})}function V(){var te=L._log,W=L.kind;te.info("Muted"),te.debug("LocalMediaTrack:",L),c.startDeferred(W)}function B(){x.addEventListener("ended",$),x.addEventListener("mute",V),x.addEventListener("unmute",$)}function ee(){x.removeEventListener("ended",$),x.removeEventListener("mute",V),x.removeEventListener("unmute",$)}var ne=function(te){return!!te&&$()};return u.onVisibilityChange(1,ne),B(),function(){u.offVisibilityChange(1,ne),ee()}}C.exports=function(L){return function(R){function E(S,T){var x=this,M=("safari"===s()||i())&&n(S)&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState;T=Object.assign({getUserMedia:h,isCreatedByCreateLocalTracks:!1,workaroundWebKitBug1208516:M,gUMSilentTrackWorkaround:v},T);var N=new g(S),j=N.kind;return x=R.call(this,N,T)||this,Object.defineProperties(x,{_constraints:{value:"object"==typeof T[j]?T[j]:{},writable:!0},_getUserMedia:{value:T.getUserMedia},_gUMSilentTrackWorkaround:{value:T.gUMSilentTrackWorkaround},_workaroundWebKitBug1208516:{value:T.workaroundWebKitBug1208516},_workaroundWebKitBug1208516Cleanup:{value:null,writable:!0},_didCallEnd:{value:!1,writable:!0},_isCreatedByCreateLocalTracks:{value:T.isCreatedByCreateLocalTracks},_trackSender:{value:N},id:{enumerable:!0,value:N.id},isEnabled:{enumerable:!0,get:function(){return N.enabled}},isStopped:{enumerable:!0,get:function(){return"ended"===N.readyState}}}),x._workaroundWebKitBug1208516&&(x._workaroundWebKitBug1208516Cleanup=P(x)),x}return p(E,R),E.prototype._end=function(){this._didCallEnd||(R.prototype._end.call(this),this._didCallEnd=!0,this.emit("stopped",this))},E.prototype._initialize=function(){this._didCallEnd&&(this._didCallEnd=!1),R.prototype._initialize.call(this)},E.prototype._reacquireTrack=function(S){var T,x=this,M=x._getUserMedia,N=x._gUMSilentTrackWorkaround,j=x._log,$=x.mediaStreamTrack.kind;j.info("Re-acquiring the MediaStreamTrack"),j.debug("Constraints:",S);var V=Object.assign({audio:!1,video:!1},((T={})[$]=S,T));return(this._workaroundWebKitBug1208516Cleanup?N(j,M,V):M(V)).then(function(ee){return ee.getTracks()[0]})},E.prototype._restart=function(S){var T=this,x=this._log;return S=S||this._constraints,this._stop(),this._reacquireTrack(S).catch(function(M){throw x.error("Failed to re-acquire the MediaStreamTrack:",{error:M,constraints:S}),M}).then(function(M){return x.info("Re-acquired the MediaStreamTrack"),x.debug("MediaStreamTrack:",M),T._constraints=Object.assign({},S),T._setMediaStreamTrack(M)})},E.prototype._setMediaStreamTrack=function(S){var T=this;return S.enabled=this.mediaStreamTrack.enabled,this._stop(),(this._unprocessedTrack?Promise.resolve().then(function(){T._unprocessedTrack=S}):this._trackSender.setMediaStreamTrack(S).catch(function(x){T._log.warn("setMediaStreamTrack failed:",{error:x,mediaStreamTrack:S})})).then(function(){T._initialize(),T._getAllAttachedElements().forEach(function(x){return T._attach(x)})})},E.prototype._stop=function(){return this.mediaStreamTrack.stop(),this._end(),this},E.prototype.enable=function(S){return(S="boolean"!=typeof S||S)!==this.mediaStreamTrack.enabled&&(this._log.info((S?"En":"Dis")+"abling"),this.mediaStreamTrack.enabled=S,this.emit(S?"enabled":"disabled",this)),this},E.prototype.disable=function(){return this.enable(!1)},E.prototype.restart=function(S){var T=this,x=this.kind;if(!this._isCreatedByCreateLocalTracks)return Promise.reject(_("restart","can only be called on a Local"+e(x)+"Track that is created using createLocalTracks or createLocal"+e(x)+"Track."));this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null);var M=this._restart(S);return this._workaroundWebKitBug1208516&&(M=M.finally(function(){T._workaroundWebKitBug1208516Cleanup=P(T)})),M},E.prototype.stop=function(){return this._log.info("Stopping"),this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null),this._stop()},E}(L)}},5181:function(C,w,a){"use strict";var e,p=this&&this.__extends||(e=function(r,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(l[_]=y[_])})(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function l(){this.constructor=r}e(r,n),r.prototype=null===n?Object.create(n):(l.prototype=n.prototype,new l)}),h=a(1102),o=a(9917),s=o.typeErrors,i=o.trackPriority,t=function(e){function r(n,l,y,_){var b=e.call(this,l.name,n.sid,_)||this;return Object.defineProperties(b,{_reemitTrackEvent:{value:function(){return b.emit(b.isTrackEnabled?"trackEnabled":"trackDisabled")}},_signaling:{value:n},_unpublish:{value:y},isTrackEnabled:{enumerable:!0,get:function(){return"data"===this.track.kind||this.track.isEnabled}},kind:{enumerable:!0,value:l.kind},priority:{enumerable:!0,get:function(){return n.updatedPriority}},track:{enumerable:!0,value:l}}),l.on("disabled",b._reemitTrackEvent),l.on("enabled",b._reemitTrackEvent),b}return p(r,e),r.prototype.toString=function(){return"[LocalTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},r.prototype.setPriority=function(n){var l=Object.values(i);if(!l.includes(n))throw s.INVALID_VALUE("priority",l);return this._signaling.setPriority(n),this},r.prototype.unpublish=function(){return this.track.removeListener("disabled",this._reemitTrackEvent),this.track.removeListener("enabled",this._reemitTrackEvent),this._unpublish(this),this},r}(h);C.exports=t},149:function(C,w,a){"use strict";var _,p=this&&this.__extends||(_=function(b,f){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var v in c)Object.prototype.hasOwnProperty.call(c,v)&&(u[v]=c[v])})(b,f)},function(b,f){if("function"!=typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function u(){this.constructor=b}_(b,f),b.prototype=null===f?Object.create(f):(u.prototype=f.prototype,new u)}),h=a(4911),o=h.guessBrowser,s=h.isIOSChrome,i=a(4139),t=a(6217),e=a(1676),r=a(3761).isUserMediaTrack,l=function(_){function b(f,u){var c=this;return u=Object.assign({workaroundSilentLocalVideo:("safari"===o()||s())&&r(f)&&"undefined"!=typeof document&&"function"==typeof document.createElement},u),c=_.call(this,f,u)||this,Object.defineProperties(c,{_workaroundSilentLocalVideo:{value:u.workaroundSilentLocalVideo?y:null},_workaroundSilentLocalVideoCleanup:{value:null,writable:!0}}),c._workaroundSilentLocalVideo&&(c._workaroundSilentLocalVideoCleanup=c._workaroundSilentLocalVideo(c,document)),c}return p(b,_),b.prototype.toString=function(){return"[LocalVideoTrack #"+this._instanceId+": "+this.id+"]"},b.prototype._checkIfCanCaptureFrames=function(){return _.prototype._checkIfCanCaptureFrames.call(this,this._trackSender.isPublishing)},b.prototype._end=function(){return _.prototype._end.apply(this,arguments)},b.prototype._setSenderMediaStreamTrack=function(f){var u=this,c=this.mediaStreamTrack,v=f?this.processedTrack:c;return this._trackSender.setMediaStreamTrack(v).catch(function(g){return u._log.warn("setMediaStreamTrack failed on LocalVideoTrack RTCRtpSender",{error:g,mediaStreamTrack:v})}).then(function(){u._unprocessedTrack=f?c:null})},b.prototype.addProcessor=function(){this._log.debug("Adding VideoProcessor to the LocalVideoTrack");var f=_.prototype.addProcessor.apply(this,arguments);return this.processedTrack?(this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0),f):this._log.warn("Unable to add a VideoProcessor to the LocalVideoTrack")},b.prototype.removeProcessor=function(){var f=this;this._log.debug("Removing VideoProcessor from the LocalVideoTrack");var u=_.prototype.removeProcessor.apply(this,arguments);return this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the original MediaStreamTrack"),this._setSenderMediaStreamTrack().then(function(){return f._updateElementsMediaStreamTrack()}),u},b.prototype.disable=function(){var f=_.prototype.disable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=!1),f},b.prototype.enable=function(f){void 0===f&&(f=!0);var u=_.prototype.enable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=f,f&&(this._captureFrames(),this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0))),u},b.prototype.restart=function(){var f=this;this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null);var u=_.prototype.restart.apply(this,arguments);return this.processor&&u.then(function(){f._restartProcessor()}),this._workaroundSilentLocalVideo&&u.finally(function(){f._workaroundSilentLocalVideoCleanup=f._workaroundSilentLocalVideo(f,document)}),u},b.prototype.stop=function(){return this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null),_.prototype.stop.apply(this,arguments)},b}(t(e));function y(_,b){var f=_._log,u=_._dummyEl,c=_.mediaStreamTrack;function v(){!_.isEnabled||(f.info("Unmuted, checking silence"),u.play().then(function(){return i(u,b)}).then(function(g){if(g)return f.warn("Silence detected, restarting"),_._stop(),_._restart();f.info("Non-silent frames detected, so no need to restart")}).catch(function(g){f.warn("Failed to detect silence and restart:",g)}).finally(function(){(u=_._dummyEl).paused||u.pause(),c.removeEventListener("unmute",v),(c=_.mediaStreamTrack).addEventListener("unmute",v)}))}return c.addEventListener("unmute",v),function(){c.removeEventListener("unmute",v)}}C.exports=l},6156:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n){return s.call(this,t,e,r,n)||this}return p(i,s),i.prototype.toString=function(){return"[LocalVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(5181));C.exports=o},3014:function(C,w,a){"use strict";var f,p=this&&this.__extends||(f=function(u,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(v[A]=g[A])})(u,c)},function(u,c){if("function"!=typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function v(){this.constructor=u}f(u,c),u.prototype=null===c?Object.create(c):(v.prototype=c.prototype,new v)}),h=a(4911),o=h.guessBrowser,s=h.isIOSChrome,i=a(4135).MediaStream,t=a(3761),e=t.waitForEvent,r=t.waitForSometime,n=a(9388),y=function(f){function u(c,v){var g=this;v=Object.assign({playPausedElementsIfNotBackgrounded:("safari"===o()||s())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},v),g=f.call(this,c.id,c.kind,v)||this;var A=!1;return v=Object.assign({MediaStream:i},v),Object.defineProperties(g,{_attachments:{value:new Set},_dummyEl:{value:null,writable:!0},_elShims:{value:new WeakMap},_isStarted:{get:function(){return A},set:function(P){A=P}},_playPausedElementsIfNotBackgrounded:{value:v.playPausedElementsIfNotBackgrounded},_shouldShimAttachedElements:{value:v.workaroundWebKitBug212780||v.playPausedElementsIfNotBackgrounded},_unprocessedTrack:{value:null,writable:!0},_MediaStream:{value:v.MediaStream},isStarted:{enumerable:!0,get:function(){return A}},mediaStreamTrack:{enumerable:!0,get:function(){return this._unprocessedTrack||c.track}},processedTrack:{enumerable:!0,value:null,writable:!0}}),g._initialize(),g}return p(u,f),u.prototype._start=function(){this._log.debug("Started"),this._isStarted=!0,this._dummyEl&&(this._dummyEl.oncanplay=null),this.emit("started",this)},u.prototype._initialize=function(){var c=this;this._log.debug("Initializing"),this._dummyEl=this._createElement(),this.mediaStreamTrack.addEventListener("ended",function v(){c._end(),c.mediaStreamTrack.removeEventListener("ended",v)}),this._dummyEl&&(this._dummyEl.muted=!0,this._dummyEl.oncanplay=this._start.bind(this,this._dummyEl),this._attach(this._dummyEl,this.mediaStreamTrack),this._attachments.delete(this._dummyEl))},u.prototype._end=function(){this._log.debug("Ended"),this._dummyEl&&(this._dummyEl.remove(),this._dummyEl.srcObject=null,this._dummyEl.oncanplay=null,this._dummyEl=null)},u.prototype.attach=function(c){var v=this;return"string"==typeof c?c=this._selectElement(c):c||(c=this._createElement()),this._log.debug("Attempting to attach to element:",c),c=this._attach(c),this._shouldShimAttachedElements&&!this._elShims.has(c)&&this._elShims.set(c,function(f,u){void 0===u&&(u=null);var c=f.pause,v=f.play,g=!1;f.pause=function(){return g=!0,c.call(f)},f.play=function(){return g=!1,v.call(f)};var A=u?function(){g||u()}:null;return A&&f.addEventListener("pause",A),{pausedIntentionally:function(){return g},unShim:function(){f.pause=c,f.play=v,A&&f.removeEventListener("pause",A)}}}(c,this._playPausedElementsIfNotBackgrounded?function(){return function(f,u){var c=f.tagName.toLowerCase();u.warn("Unintentionally paused:",f),Promise.race([e(document,"visibilitychange"),r(1e3)]).then(function(){"visible"===document.visibilityState&&n.whenResolved("audio").then(function(){return u.info("Playing unintentionally paused <"+c+"> element"),u.debug("Element:",f),f.play()}).then(function(){u.info("Successfully played unintentionally paused <"+c+"> element"),u.debug("Element:",f)}).catch(function(v){u.warn("Error while playing unintentionally paused <"+c+"> element:",{error:v,el:f})})})}(c,v._log)}:null)),c},u.prototype._attach=function(c,v){void 0===v&&(v=this.processedTrack||this.mediaStreamTrack);var g=c.srcObject;return g instanceof this._MediaStream||(g=new this._MediaStream),g["audio"===v.kind?"getAudioTracks":"getVideoTracks"]().forEach(function(P){g.removeTrack(P)}),g.addTrack(v),c.srcObject=g,c.autoplay=!0,c.playsInline=!0,this._attachments.has(c)||this._attachments.add(c),c},u.prototype._selectElement=function(c){var v=document.querySelector(c);if(!v)throw new Error("Selector matched no element: "+c);return v},u.prototype._updateElementsMediaStreamTrack=function(){var c=this;this._log.debug("Reattaching all elements to update mediaStreamTrack"),this._getAllAttachedElements().forEach(function(v){return c._attach(v)})},u.prototype._createElement=function(){return"undefined"!=typeof document?document.createElement(this.kind):null},u.prototype.detach=function(c){var v;return v="string"==typeof c?[this._selectElement(c)]:c?[c]:this._getAllAttachedElements(),this._log.debug("Attempting to detach from elements:",v),this._detachElements(v),c?v[0]:v},u.prototype._detachElements=function(c){return c.map(this._detachElement.bind(this))},u.prototype._detachElement=function(c){if(!this._attachments.has(c))return c;var v=c.srcObject;return v instanceof this._MediaStream&&v.removeTrack(this.processedTrack||this.mediaStreamTrack),this._attachments.delete(c),this._shouldShimAttachedElements&&this._elShims.has(c)&&(this._elShims.get(c).unShim(),this._elShims.delete(c)),c},u.prototype._getAllAttachedElements=function(){var c=[];return this._attachments.forEach(function(v){c.push(v)}),c},u}(a(5142));C.exports=y},6804:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t,e)||this}return p(i,s),i}(a(6583));C.exports=o},698:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(13),i=function(t){function e(r,n,l,y,_,b,f){return t.call(this,r,n,l,y,_,b,f)||this}return p(e,t),e.prototype.toString=function(){return"[RemoteAudioTrack #"+this._instanceId+": "+this.sid+"]"},e.prototype.setPriority=function(r){return t.prototype.setPriority.call(this,r)},e}(a(1204)(h));C.exports=i},6292:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t,e)||this}return p(i,s),i.prototype.toString=function(){return"[RemoteAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(4610));C.exports=o},2096:function(C,w,a){"use strict";var n,p=this&&this.__extends||(n=function(l,y){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,b){_.__proto__=b}||function(_,b){for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&(_[f]=b[f])})(l,y)},function(l,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function _(){this.constructor=l}n(l,y),l.prototype=null===y?Object.create(y):(_.prototype=y.prototype,new _)}),h=this&&this.__read||function(n,l){var y="function"==typeof Symbol&&n[Symbol.iterator];if(!y)return n;var b,u,_=y.call(n),f=[];try{for(;(void 0===l||l-- >0)&&!(b=_.next()).done;)f.push(b.value)}catch(c){u={error:c}}finally{try{b&&!b.done&&(y=_.return)&&y.call(_)}finally{if(u)throw u.error}}return f},o=this&&this.__spreadArray||function(n,l){for(var y=0,_=l.length,b=n.length;y<_;y++,b++)n[b]=l[y];return n},s=a(5142),i=a(9917),t=i.typeErrors,e=i.trackPriority,r=function(n){function l(y,_,b){var f=n.call(this,_.id,"data",b)||this;return Object.defineProperties(f,{_isSwitchedOff:{value:!1,writable:!0},_priority:{value:null,writable:!0},isEnabled:{enumerable:!0,value:!0},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},maxPacketLifeTime:{enumerable:!0,value:_.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:_.maxRetransmits},ordered:{enumerable:!0,value:_.ordered},priority:{enumerable:!0,get:function(){return this._priority}},reliable:{enumerable:!0,value:null===_.maxPacketLifeTime&&null===_.maxRetransmits},sid:{enumerable:!0,value:y}}),_.on("message",function(u){f.emit("message",u,f)}),f}return p(l,n),l.prototype.setPriority=function(y){var _=o([null],h(Object.values(e)));if(!_.includes(y))throw t.INVALID_VALUE("priority",_);return this._priority=y,this},l.prototype._setEnabled=function(){},l.prototype._setSwitchedOff=function(y){this._isSwitchedOff!==y&&(this._isSwitchedOff=y,this.emit(y?"switchedOff":"switchedOn",this))},l}(s);C.exports=r},2046:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t,e)||this}return p(i,s),i.prototype.toString=function(){return"[RemoteDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(4610));C.exports=o},1204:function(C,w,a){"use strict";var b,p=this&&this.__extends||(b=function(f,u){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,v){c.__proto__=v}||function(c,v){for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&(c[g]=v[g])})(f,u)},function(f,u){if("function"!=typeof u&&null!==u)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function c(){this.constructor=f}b(f,u),f.prototype=null===u?Object.create(u):(c.prototype=u.prototype,new c)}),h=this&&this.__read||function(b,f){var u="function"==typeof Symbol&&b[Symbol.iterator];if(!u)return b;var v,A,c=u.call(b),g=[];try{for(;(void 0===f||f-- >0)&&!(v=c.next()).done;)g.push(v.value)}catch(P){A={error:P}}finally{try{v&&!v.done&&(u=c.return)&&u.call(c)}finally{if(A)throw A.error}}return g},o=this&&this.__spreadArray||function(b,f){for(var u=0,c=f.length,v=b.length;u<c;u++,v++)b[v]=f[u];return b},s=a(9917),i=s.typeErrors,t=s.trackPriority,e=a(4911),r=e.guessBrowser,n=e.isIOSChrome,l=a(296);C.exports=function(b){return function(f){function u(c,v,g,A,P,L,R){var E=this;return R=Object.assign({workaroundWebKitBug212780:("safari"===r()||n())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},R),E=f.call(this,v,R)||this,Object.defineProperties(E,{_isEnabled:{value:g,writable:!0},_isSwitchedOff:{value:A,writable:!0},_priority:{value:null,writable:!0},_setPriority:{value:P},_setRenderHint:{value:function(S){E._log.debug("updating render hint:",S),L(S)}},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},priority:{enumerable:!0,get:function(){return this._priority}},sid:{enumerable:!0,value:c},_workaroundWebKitBug212780:{value:R.workaroundWebKitBug212780},_workaroundWebKitBug212780Cleanup:{value:null,writable:!0}}),E}return p(u,f),u.prototype.setPriority=function(c){var v=o([null],h(Object.values(t)));if(!v.includes(c))throw i.INVALID_VALUE("priority",v);return this._priority!==c&&(this._priority=c,this._setPriority(c)),this},u.prototype._setEnabled=function(c){this._isEnabled!==c&&(this._isEnabled=c,this.emit(this._isEnabled?"enabled":"disabled",this))},u.prototype._setSwitchedOff=function(c){this._isSwitchedOff!==c&&(this._isSwitchedOff=c,this.emit(c?"switchedOff":"switchedOn",this))},u.prototype.attach=function(c){var v=f.prototype.attach.call(this,c);return!0!==this.mediaStreamTrack.enabled&&(this.mediaStreamTrack.enabled=!0,this.processedTrack&&(this.processedTrack.enabled=!0),this.processor&&this._captureFrames()),this._workaroundWebKitBug212780&&(this._workaroundWebKitBug212780Cleanup=this._workaroundWebKitBug212780Cleanup||function(b){var f=b._log,u=b.kind;function c(v){!v||b._attachments.forEach(function(g){var A=b._elShims.get(g);g.paused&&A&&!A.pausedIntentionally()&&(f.info("Playing inadvertently paused <"+u+"> element"),f.debug("Element:",g),f.debug("RemoteMediaTrack:",b),g.play().then(function(){f.info("Successfully played inadvertently paused <"+u+"> element"),f.debug("Element:",g),f.debug("RemoteMediaTrack:",b)}).catch(function(L){f.warn("Error while playing inadvertently paused <"+u+"> element:",{err:L,el:g,remoteMediaTrack:b})}))})}return l.onVisibilityChange(2,c),function(){l.offVisibilityChange(2,c)}}(this)),v},u.prototype.detach=function(c){var v=f.prototype.detach.call(this,c);return 0===this._attachments.size&&(this.mediaStreamTrack.enabled=!1,this.processedTrack&&(this.processedTrack.enabled=!1),this._workaroundWebKitBug212780Cleanup&&(this._workaroundWebKitBug212780Cleanup(),this._workaroundWebKitBug212780Cleanup=null)),v},u}(b)}},4610:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t.name,t.sid,e)||this;Object.defineProperties(r,{_signaling:{value:t},_track:{value:null,writable:!0},isSubscribed:{enumerable:!0,get:function(){return!!this._track}},isTrackEnabled:{enumerable:!0,get:function(){return t.isEnabled}},kind:{enumerable:!0,value:t.kind},publishPriority:{enumerable:!0,get:function(){return t.priority}},track:{enumerable:!0,get:function(){return this._track}}});var n=t.error,l=t.isEnabled,y=t.isSwitchedOff,_=t.priority;return t.on("updated",function(){if(n!==t.error)return n=t.error,void r.emit("subscriptionFailed",t.error);l!==t.isEnabled&&(l=t.isEnabled,r.track&&r.track._setEnabled(t.isEnabled),r.emit(t.isEnabled?"trackEnabled":"trackDisabled")),y!==t.isSwitchedOff&&(r._log.debug(r.trackSid+": "+(y?"OFF":"ON")+" => "+(t.isSwitchedOff?"OFF":"ON")),y=t.isSwitchedOff,r.track?(r.track._setSwitchedOff(t.isSwitchedOff),r.emit(y?"trackSwitchedOff":"trackSwitchedOn",r.track)):y&&r._log.warn("Track was not subscribed when switched Off.")),_!==t.priority&&r.emit("publishPriorityChanged",_=t.priority)}),r}return p(i,s),i.prototype.toString=function(){return"[RemoteTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i.prototype._subscribed=function(t){!this._track&&t&&(this._track=t,this.emit("subscribed",t))},i.prototype._unsubscribe=function(){if(this._track){var t=this._track;this._track=null,this.emit("unsubscribed",t)}},i}(a(1102));C.exports=o},9984:function(C,w,a){"use strict";var f,p=this&&this.__extends||(f=function(u,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(v[A]=g[A])})(u,c)},function(u,c){if("function"!=typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function v(){this.constructor=u}f(u,c),u.prototype=null===c?Object.create(c):(v.prototype=c.prototype,new v)}),h=this&&this.__read||function(f,u){var c="function"==typeof Symbol&&f[Symbol.iterator];if(!c)return f;var g,P,v=c.call(f),A=[];try{for(;(void 0===u||u-- >0)&&!(g=v.next()).done;)A.push(g.value)}catch(L){P={error:L}}finally{try{g&&!g.done&&(c=v.return)&&c.call(v)}finally{if(P)throw P.error}}return A},o=a(1204),s=a(1676),i=a(296),t=a(5092).NullObserver,e=a(1190),l=function(f){function u(c,v,g,A,P,L,R){var E=this;return R=Object.assign({clientTrackSwitchOffControl:"auto",contentPreferencesMode:"auto",enableDocumentVisibilityTurnOff:!0},R),R=Object.assign({IntersectionObserver:"undefined"==typeof IntersectionObserver||"auto"!==R.clientTrackSwitchOffControl?t:IntersectionObserver,ResizeObserver:"undefined"==typeof ResizeObserver||"auto"!==R.contentPreferencesMode?t:ResizeObserver},R),E=f.call(this,c,v,g,A,P,L,R)||this,Object.defineProperties(E,{_enableDocumentVisibilityTurnOff:{value:!0===R.enableDocumentVisibilityTurnOff&&"auto"===R.clientTrackSwitchOffControl},_documentVisibilityTurnOffCleanup:{value:null,writable:!0},_clientTrackSwitchOffControl:{value:R.clientTrackSwitchOffControl},_contentPreferencesMode:{value:R.contentPreferencesMode},_invisibleElements:{value:new WeakSet},_elToPipCallbacks:{value:new WeakMap},_elToPipWindows:{value:new WeakMap},_turnOffTimer:{value:new e(function(){E._setRenderHint({enabled:!1})},50,!1)},_resizeObserver:{value:new R.ResizeObserver(function(S){S.find(function(x){return!E._invisibleElements.has(x.target)})&&b(E)})},_intersectionObserver:{value:new R.IntersectionObserver(function(S){var T=!1;S.forEach(function(x){!E._invisibleElements.has(x.target)!==x.isIntersecting&&(x.isIntersecting?(E._log.debug("intersectionObserver detected: Off => On"),E._invisibleElements.delete(x.target)):(E._log.debug("intersectionObserver detected: On => Off"),E._invisibleElements.add(x.target)),T=!0)}),T&&(_(E),b(E))},{threshold:.25})}}),E}return p(u,f),u.prototype._start=function(c){var v=f.prototype._start.call(this,c);return _(this),v},u.prototype.switchOn=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!0}),this},u.prototype.switchOff=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOff only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!1}),this},u.prototype.setContentPreferences=function(c){if("manual"!==this._contentPreferencesMode)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.contentPreferencesMode is set to "manual"');return c.renderDimensions&&this._setRenderHint({renderDimensions:c.renderDimensions}),this},u.prototype._unObservePip=function(c){var v=this._elToPipCallbacks.get(c);v&&(c.removeEventListener("enterpictureinpicture",v.onEnterPip),c.removeEventListener("leavepictureinpicture",v.onLeavePip),this._elToPipCallbacks.delete(c))},u.prototype._observePip=function(c){var v=this;if(!this._elToPipCallbacks.get(c)){var A=function(R){return v._onEnterPip(R,c)},P=function(R){return v._onLeavePip(R,c)};c.addEventListener("enterpictureinpicture",A),c.addEventListener("leavepictureinpicture",P),this._elToPipCallbacks.set(c,{onEnterPip:A,onLeavePip:P,onResizePip:function(R){return v._onResizePip(R,c)}})}},u.prototype._onEnterPip=function(c,v){this._log.debug("onEnterPip");var g=c.pictureInPictureWindow;this._elToPipWindows.set(v,g);var A=this._elToPipCallbacks.get(v).onResizePip;g.addEventListener("resize",A),_(this)},u.prototype._onLeavePip=function(c,v){this._log.debug("onLeavePip"),this._elToPipWindows.delete(v);var g=this._elToPipCallbacks.get(v).onResizePip;c.pictureInPictureWindow.removeEventListener("resize",g),_(this)},u.prototype._onResizePip=function(){b(this)},u.prototype.attach=function(c){var v=f.prototype.attach.call(this,c);return"auto"===this._clientTrackSwitchOffControl&&this._invisibleElements.add(v),this._intersectionObserver.observe(v),this._resizeObserver.observe(v),this._enableDocumentVisibilityTurnOff&&(this._documentVisibilityTurnOffCleanup=this._documentVisibilityTurnOffCleanup||function(f){function u(){_(f)}return i.onVisibilityChange(1,u),function(){i.offVisibilityChange(1,u)}}(this)),this._observePip(v),v},u.prototype.detach=function(c){var v=this,g=f.prototype.detach.call(this,c);return(Array.isArray(g)?g:[g]).forEach(function(P){v._intersectionObserver.unobserve(P),v._resizeObserver.unobserve(P),v._invisibleElements.delete(P),v._unObservePip(P)}),0===this._attachments.size&&this._documentVisibilityTurnOffCleanup&&(this._documentVisibilityTurnOffCleanup(),this._documentVisibilityTurnOffCleanup=null),_(this),b(this),g},u.prototype.addProcessor=function(){return f.prototype.addProcessor.apply(this,arguments)},u.prototype.removeProcessor=function(){return f.prototype.removeProcessor.apply(this,arguments)},u.prototype.toString=function(){return"[RemoteVideoTrack #"+this._instanceId+": "+this.sid+"]"},u.prototype.setPriority=function(c){return f.prototype.setPriority.call(this,c)},u}(o(s));function _(f){if("auto"===f._clientTrackSwitchOffControl){var u=f._getAllAttachedElements().filter(function(g){return!f._invisibleElements.has(g)});!0==(f._getAllAttachedElements().filter(function(g){return f._elToPipWindows.has(g)}).length>0||"visible"===document.visibilityState&&u.length>0)?(f._turnOffTimer.clear(),f._setRenderHint({enabled:!0})):f._turnOffTimer.isSet||f._turnOffTimer.start()}}function b(f){if("auto"===f._contentPreferencesMode){var u=f._getAllAttachedElements().filter(function(E){return!f._invisibleElements.has(E)}),c=f._getAllAttachedElements().map(function(E){var S=f._elToPipWindows.get(E);return S?{clientHeight:S.height,clientWidth:S.width}:{clientHeight:0,clientWidth:0}}),v=u.concat(c);if(v.length>0){var A=h(v.sort(function(E,S){return S.clientHeight+S.clientWidth-E.clientHeight-E.clientWidth-1}),1)[0];f._setRenderHint({renderDimensions:{height:A.clientHeight,width:A.clientWidth}})}}}C.exports=l},9780:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t,e)||this}return p(i,s),i.prototype.toString=function(){return"[RemoteVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},i}(a(4610));C.exports=o},5550:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=this&&this.__read||function(i,t){var e="function"==typeof Symbol&&i[Symbol.iterator];if(!e)return i;var n,y,r=e.call(i),l=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)l.push(n.value)}catch(_){y={error:_}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(y)throw y.error}}return l},s=function(i){function t(e){var r=i.call(this,e.id,e)||this;return Object.defineProperties(r,{_clones:{value:new Set},_senders:{value:new Set},_senderToPublisherHintCallbacks:{value:new Map},isPublishing:{get:function(){return!!this._clones.size}}}),r}return p(t,i),t.prototype.clone=function(){var e=new t(this.track.clone());return this._clones.add(e),e},t.prototype.removeClone=function(e){this._clones.delete(e)},t.prototype.setMediaStreamTrack=function(e){var r=this,n=Array.from(this._clones),l=Array.from(this._senders);return Promise.all(n.map(function(y){return y.setMediaStreamTrack(e.clone())}).concat(l.map(function(y){return r._replaceTrack(y,e)}))).finally(function(){r._track=e})},t.prototype.addSender=function(e,r){return this._senders.add(e),r&&this._senderToPublisherHintCallbacks.set(e,r),this},t.prototype.removeSender=function(e){return this._senders.delete(e),this._senderToPublisherHintCallbacks.delete(e),this},t.prototype.setPublisherHint=function(e){var n=h(Array.from(this._senderToPublisherHintCallbacks.values()),1)[0];return n?n(e):Promise.resolve("COULD_NOT_APPLY_HINT")},t.prototype._replaceTrack=function(e,r){var n=this;return e.replaceTrack(r).then(function(l){return n.setPublisherHint(null).catch(function(){}),n.emit("replaced"),l})},t}(a(6583));C.exports=s},1102:function(C,w,a){"use strict";var l,p=this&&this.__extends||(l=function(y,_){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,f){b.__proto__=f}||function(b,f){for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&(b[u]=f[u])})(y,_)},function(y,_){if("function"!=typeof _&&null!==_)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function b(){this.constructor=y}l(y,_),y.prototype=null===_?Object.create(_):(b.prototype=_.prototype,new b)}),h=a(5737),o=a(3761),s=o.buildLogLevels,i=o.valueToJSON,t=a(9917).DEFAULT_LOG_LEVEL,e=a(7394),r=0,n=function(l){function y(_,b,f){var u=l.call(this)||this;f=Object.assign({logLevel:t},f);var c=s(f.logLevel);return Object.defineProperties(u,{_instanceId:{value:r++},_log:{value:f.log?f.log.createLog("default",u):new e("default",u,c,f.loggerName)},trackName:{enumerable:!0,value:_},trackSid:{enumerable:!0,value:b}}),u}return p(y,l),y.prototype.toJSON=function(){return i(this)},y.prototype.toString=function(){return"[TrackPublication #"+this._instanceId+": "+this.trackSid+"]"},y}(h);C.exports=n},6583:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,e.kind)||this;return Object.defineProperties(r,{_track:{value:e,writable:!0},enabled:{enumerable:!0,get:function(){return this._track.enabled}},readyState:{enumerable:!0,get:function(){return this._track.readyState}},track:{enumerable:!0,get:function(){return this._track}}}),r}return p(i,s),i.prototype.stop=function(){this.track.stop(),s.prototype.stop.call(this)},i}(a(8699));C.exports=o},6679:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(3105).EventEmitter,o=a(9917).DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS,s=function(i){function t(e){var r=i.call(this)||this;return Object.defineProperties(r,{_lastStatsSaveTime:{value:null,writable:!0},_lastStatsPublishTime:{value:null,writable:!0},_log:{value:e},_processorInfo:{value:null,writable:!0},_stats:{value:null,writable:!0}}),r.on("add",function(n){r._lastStatsSaveTime=Date.now(),r._lastStatsPublishTime=Date.now(),r._processorInfo=n,r._stats=[],r._reemitEvent("add",r._getEventData())}),r.on("remove",function(){var n=r._getEventData();r._lastStatsSaveTime=null,r._lastStatsPublishTime=null,r._processorInfo=null,r._stats=null,r._reemitEvent("remove",n)}),r.on("start",function(){r._reemitEvent("start",r._getEventData())}),r.on("stop",function(n){r._reemitEvent("stop",Object.assign({message:n},r._getEventData()))}),r.on("stats",function(){return r._maybeEmitStats()}),r}return p(t,i),t.prototype._getEventData=function(){if(!this._processorInfo)return{};var e=this._processorInfo,r=e.processor,b={captureHeight:e.captureHeight,captureWidth:e.captureWidth,inputFrameRate:e.inputFrameRate,isRemoteVideoTrack:e.isRemoteVideoTrack};return b.name=r._name||"VideoProcessor",["assetsPath","blurFilterRadius","fitType","isSimdEnabled","maskBlurRadius","version"].forEach(function(f){var u=r["_"+f];void 0!==u&&(b[f]=u)}),Object.keys(b).forEach(function(f){var u=b[f];"boolean"==typeof u&&(b[f]=u?"true":"false")}),b},t.prototype._maybeEmitStats=function(){if(this._stats&&this._processorInfo){var e=this._processorInfo.processor._benchmark;if(e){var r=Date.now();if(!(r-this._lastStatsSaveTime<1e3)){var n={outputFrameRate:e.getRate("totalProcessingDelay")};if(["captureFrameDelay","imageCompositionDelay","inputImageResizeDelay","processFrameDelay","segmentationDelay"].forEach(function(_){n[_]=e.getAverageDelay(_)}),this._lastStatsSaveTime=r,this._stats.push(n),!(r-this._lastStatsPublishTime<o)){this._lastStatsPublishTime=r;var y=this._stats.splice(0).reduce(function(_,b,f){return Object.keys(n).forEach(function(u){_[u]||(_[u]=0),_[u]=(_[u]*f+b[u])/(f+1)}),_},{});Object.keys(y).forEach(function(_){y[_]=parseFloat(y[_].toFixed(2))}),this._reemitEvent("stats",Object.assign({},y,this._getEventData()))}}}}},t.prototype._reemitEvent=function(e,r){this._log.debug("VideoProcessor:"+e,r),this.emit("event",{name:e,data:r})},t}(h);C.exports=s},1676:function(C,w,a){"use strict";var e,p=this&&this.__extends||(e=function(r,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(l[_]=y[_])})(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function l(){this.constructor=r}e(r,n),r.prototype=null===n?Object.create(n):(l.prototype=n.prototype,new l)}),h=a(3014),o=a(6679),s=a(9917).DEFAULT_FRAME_RATE,i=function(e){function r(n,l){var y=e.call(this,n,l)||this;return Object.defineProperties(y,{_captureTimeoutId:{value:null,writable:!0},_isCapturing:{value:!1,writable:!0},_inputFrame:{value:null,writable:!0},_outputFrame:{value:null,writable:!0},_processorEventObserver:{value:null,writable:!0},_unmuteHandler:{value:null,writable:!0},dimensions:{enumerable:!0,value:{width:null,height:null}},processor:{enumerable:!0,value:null,writable:!0}}),y._processorEventObserver=new(l.VideoProcessorEventObserver||o)(y._log),y}return p(r,e),r.prototype._checkIfCanCaptureFrames=function(n){void 0===n&&(n=!1);var l=!0,y="",_=this.mediaStreamTrack;return _.enabled||(l=!1,y="MediaStreamTrack is disabled"),"ended"===_.readyState&&(l=!1,y="MediaStreamTrack is ended"),this.processor||(l=!1,y="VideoProcessor not detected."),!this._attachments.size&&!n&&(l=!1,y="VideoTrack is not publishing and there is no attached element."),y&&this._log.debug(y),{canCaptureFrames:l,message:y}},r.prototype._captureFrames=function(){var n=this;if(this._isCapturing)this._log.debug("Ignoring captureFrames call. Capture is already in progress");else{if(!this._checkIfCanCaptureFrames().canCaptureFrames)return this._isCapturing=!1,void this._log.debug("Cannot capture frames. Ignoring captureFrames call.");this._isCapturing=!0,this._processorEventObserver.emit("start"),this._log.debug("Start capturing frames");var y,l=Date.now();this._dummyEl.play().then(function(){var _=function(f){clearTimeout(n._captureTimeoutId);var u=n.mediaStreamTrack.getSettings().frameRate,g=Math.floor(1e3/(void 0===u?s:u))-y;(g<0||"number"!=typeof y)&&(g=0),n._captureTimeoutId=setTimeout(f,g)},b=function(){var f=n._checkIfCanCaptureFrames();if(!f.canCaptureFrames)return n._isCapturing=!1,n._processorEventObserver.emit("stop",f.message),void n._log.debug("Cannot capture frames. Stopping capturing frames.");l=Date.now();var u=n.mediaStreamTrack.getSettings(),c=u.width,v=void 0===c?0:c,g=u.height,A=void 0===g?0:g;n._inputFrame.width!==v&&(n._inputFrame.width=v,n._inputFrame.height=A,n._outputFrame&&(n._outputFrame.width=v,n._outputFrame.height=A)),n._inputFrame.getContext("2d").drawImage(n._dummyEl,0,0,v,A);var P=null;try{P=n.processor.processFrame(n._inputFrame,n._outputFrame)}catch(L){n._log.debug("Exception detected after calling processFrame.",L)}(P instanceof Promise?P:Promise.resolve(P)).then(function(){n._outputFrame&&(n.processedTrack.requestFrame(),n._processorEventObserver.emit("stats"))}).finally(function(){y=Date.now()-l,_(b)})};_(b)}).catch(function(_){return n._log.error("Video element cannot be played",{error:_,track:n})})}},r.prototype._initialize=function(){var n=this;e.prototype._initialize.call(this),this._dummyEl&&(this._dummyEl.onloadedmetadata=function(){t(n,n._dummyEl)&&(n.dimensions.width=n._dummyEl.videoWidth,n.dimensions.height=n._dummyEl.videoHeight)},this._dummyEl.onresize=function(){t(n,n._dummyEl)&&(n.dimensions.width=n._dummyEl.videoWidth,n.dimensions.height=n._dummyEl.videoHeight,n.isStarted&&(n._log.debug("Dimensions changed:",n.dimensions),n.emit(r.DIMENSIONS_CHANGED,n)))})},r.prototype._restartProcessor=function(){var n=this.processor;n&&(this.removeProcessor(n),this.addProcessor(n))},r.prototype._start=function(n){return this.dimensions.width=n.videoWidth,this.dimensions.height=n.videoHeight,this._log.debug("Dimensions:",this.dimensions),e.prototype._start.call(this,n)},r.prototype.addProcessor=function(n){var l=this;if("function"!=typeof OffscreenCanvas)return this._log.warn("Adding a VideoProcessor is not supported in this browser.");if(!n||"function"!=typeof n.processFrame)throw new Error("Received an invalid VideoProcessor from addProcessor.");if(this.processor)throw new Error("A VideoProcessor has already been added.");if(!this._dummyEl)throw new Error("VideoTrack has not been initialized.");this._log.debug("Adding VideoProcessor to the VideoTrack",n),this._unmuteHandler||(this._unmuteHandler=function(){l._log.debug("mediaStreamTrack unmuted"),l.processedTrack.muted&&(l._log.debug("mediaStreamTrack is unmuted but processedTrack is muted. Restarting processor."),l._restartProcessor())},this.mediaStreamTrack.addEventListener("unmute",this._unmuteHandler));var y=this.mediaStreamTrack.getSettings(),_=y.width,b=void 0===_?0:_,f=y.height,u=void 0===f?0:f,c=y.frameRate,v=void 0===c?s:c;return this._inputFrame=new OffscreenCanvas(b,u),this._outputFrame=document.createElement("canvas"),this._outputFrame.width=b,this._outputFrame.height=u,this.processedTrack=this._outputFrame.captureStream(0).getTracks()[0],this.processedTrack.enabled=this.mediaStreamTrack.enabled,this.processor=n,this._processorEventObserver.emit("add",{processor:n,captureHeight:u,captureWidth:b,inputFrameRate:v,isRemoteVideoTrack:this.toString().includes("RemoteVideoTrack")}),this._updateElementsMediaStreamTrack(),this._captureFrames(),this},r.prototype.attach=function(){var n=e.prototype.attach.apply(this,arguments);return this.processor&&this._captureFrames(),n},r.prototype.detach=function(){return e.prototype.detach.apply(this,arguments)},r.prototype.removeProcessor=function(n){if(!n)throw new Error("Received an invalid VideoProcessor from removeProcessor.");if(!this.processor)throw new Error("No existing VideoProcessor detected.");if(n!==this.processor)throw new Error("The provided VideoProcessor is different than the existing one.");return this._processorEventObserver.emit("remove"),this._log.debug("Removing VideoProcessor from the VideoTrack",n),clearTimeout(this._captureTimeoutId),this.mediaStreamTrack.removeEventListener("unmute",this._unmuteHandler),this._unmuteHandler=null,this._isCapturing=!1,this.processor=null,this.processedTrack=null,this._inputFrame.getContext("2d").clearRect(0,0,this._inputFrame.width,this._inputFrame.height),this._outputFrame.getContext("2d").clearRect(0,0,this._outputFrame.width,this._outputFrame.height),this._inputFrame=null,this._outputFrame=null,this._updateElementsMediaStreamTrack(),this},r}(h);function t(e,r){return e.dimensions.width!==r.videoWidth||e.dimensions.height!==r.videoHeight}i.DIMENSIONS_CHANGED="dimensionsChanged",C.exports=i},6062:function(C,w,a){"use strict";var l,p=this&&this.__extends||(l=function(y,_){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,f){b.__proto__=f}||function(b,f){for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&(b[u]=f[u])})(y,_)},function(y,_){if("function"!=typeof _&&null!==_)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function b(){this.constructor=y}l(y,_),y.prototype=null===_?Object.create(_):(b.prototype=_.prototype,new b)}),h=this&&this.__read||function(l,y){var _="function"==typeof Symbol&&l[Symbol.iterator];if(!_)return l;var f,c,b=_.call(l),u=[];try{for(;(void 0===y||y-- >0)&&!(f=b.next()).done;)u.push(f.value)}catch(v){c={error:v}}finally{try{f&&!f.done&&(_=b.return)&&_.call(b)}finally{if(c)throw c.error}}return u},o=a(3105).EventEmitter,s=a(9917),i=s.DEFAULT_NQ_LEVEL_LOCAL,t=s.DEFAULT_NQ_LEVEL_REMOTE,e=s.MAX_NQ_LEVEL,r=a(3761).inRange,n=function(l){function y(_){var b=l.call(this)||this;return _=Object.assign({local:i,remote:t},_),Object.defineProperties(b,{local:{value:r(_.local,i,e)?_.local:i,writable:!0},remote:{value:r(_.remote,t,e)?_.remote:t,writable:!0}}),b}return p(y,l),y.prototype.update=function(_){var b=this;_=Object.assign({local:this.local,remote:this.remote},_),[["local",i,3],["remote",t,3]].forEach(function(f){var u=h(f,3),c=u[0],v=u[1];b[c]="number"==typeof _[c]&&r(_[c],v,u[2])?_[c]:v})},y}(o);C.exports=n},5513:function(C,w,a){"use strict";var g,p=this&&this.__extends||(g=function(A,P){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,R){L.__proto__=R}||function(L,R){for(var E in R)Object.prototype.hasOwnProperty.call(R,E)&&(L[E]=R[E])})(A,P)},function(A,P){if("function"!=typeof P&&null!==P)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");function L(){this.constructor=A}g(A,P),A.prototype=null===P?Object.create(P):(L.prototype=P.prototype,new L)}),h=this&&this.__read||function(g,A){var P="function"==typeof Symbol&&g[Symbol.iterator];if(!P)return g;var R,S,L=P.call(g),E=[];try{for(;(void 0===A||A-- >0)&&!(R=L.next()).done;)E.push(R.value)}catch(T){S={error:T}}finally{try{R&&!R.done&&(P=L.return)&&P.call(L)}finally{if(S)throw S.error}}return E},o=this&&this.__spreadArray||function(g,A){for(var P=0,L=A.length,R=g.length;P<L;P++,R++)g[R]=A[P];return g},s=a(5737),i=a(698),t=a(6292),e=a(2096),r=a(2046),n=a(9984),l=a(9780),y=a(3761),_=0,b=function(g){function A(P,L){var R=g.call(this)||this,E=function(g){var A=g.map(function(E){return[E.id,E]}),P=A.filter(function(E){return"audio"===E[1].kind}),L=A.filter(function(E){return"video"===E[1].kind});return{audioTracks:P,dataTracks:A.filter(function(E){return"data"===E[1].kind}),tracks:A,videoTracks:L}}((L=Object.assign({RemoteAudioTrack:i,RemoteAudioTrackPublication:t,RemoteDataTrack:e,RemoteDataTrackPublication:r,RemoteVideoTrack:n,RemoteVideoTrackPublication:l,tracks:[]},L)).tracks),S=L.log.createLog("default",R),T=new Map(E.audioTracks),x=new Map(E.dataTracks),M=new Map(E.tracks),N=new Map(E.videoTracks);return Object.defineProperties(R,{_RemoteAudioTrack:{value:L.RemoteAudioTrack},_RemoteAudioTrackPublication:{value:L.RemoteAudioTrackPublication},_RemoteDataTrack:{value:L.RemoteDataTrack},_RemoteDataTrackPublication:{value:L.RemoteDataTrackPublication},_RemoteVideoTrack:{value:L.RemoteVideoTrack},_RemoteVideoTrackPublication:{value:L.RemoteVideoTrackPublication},_audioTracks:{value:T},_dataTracks:{value:x},_instanceId:{value:++_},_clientTrackSwitchOffControl:{value:L.clientTrackSwitchOffControl},_contentPreferencesMode:{value:L.contentPreferencesMode},_log:{value:S},_signaling:{value:P},_tracks:{value:M},_trackEventReemitters:{value:new Map},_trackPublicationEventReemitters:{value:new Map},_trackSignalingUpdatedEventCallbacks:{value:new Map},_videoTracks:{value:N},audioTracks:{enumerable:!0,value:new Map},dataTracks:{enumerable:!0,value:new Map},identity:{enumerable:!0,get:function(){return P.identity}},networkQualityLevel:{enumerable:!0,get:function(){return P.networkQualityLevel}},networkQualityStats:{enumerable:!0,get:function(){return P.networkQualityStats}},sid:{enumerable:!0,get:function(){return P.sid}},state:{enumerable:!0,get:function(){return P.state}},tracks:{enumerable:!0,value:new Map},videoTracks:{enumerable:!0,value:new Map}}),R._tracks.forEach(c.bind(null,R)),P.on("networkQualityLevelChanged",function(){return R.emit("networkQualityLevelChanged",R.networkQualityLevel,R.networkQualityStats&&(R.networkQualityStats.audio||R.networkQualityStats.video)?R.networkQualityStats:null)}),function(g,A){var P=g._log;"disconnected"!==g.state&&A.on("stateChanged",function L(R){P.debug("Transitioned to state:",R),g.emit(R,g),"disconnected"===R&&(P.debug("Removing Track event reemitters"),A.removeListener("stateChanged",L),g._tracks.forEach(function(E){var S=g._trackEventReemitters.get(E.id);E&&S&&S.forEach(function(T,x){E.removeListener(x,T)})}),A.tracks.forEach(function(E){var S=g._tracks.get(E.id),T=g._trackEventReemitters.get(E.id);S&&T&&T.forEach(function(x,M){S.removeListener(M,x)})}),g._trackEventReemitters.clear(),g.tracks.forEach(function(E){g._trackPublicationEventReemitters.get(E.trackSid).forEach(function(S,T){E.removeListener(T,S)})}),g._trackPublicationEventReemitters.clear())})}(R,P),S.info("Created a new Participant"+(R.identity?": "+R.identity:"")),R}return p(A,g),A.prototype._getTrackEvents=function(){return[["dimensionsChanged","trackDimensionsChanged"],["message","trackMessage"],["started","trackStarted"]]},A.prototype._getTrackPublicationEvents=function(){return[]},A.prototype.toString=function(){return"[Participant #"+this._instanceId+": "+this.sid+"]"},A.prototype._addTrack=function(P,L){var R=this._log;return this._tracks.has(L)?null:(this._tracks.set(L,P),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[P.kind].set(L,P),c(this,P,L),R.info("Added a new "+y.trackClass(P)+":",L),R.debug(y.trackClass(P)+":",P),P)},A.prototype._addTrackPublication=function(P){var L=this._log;return this.tracks.has(P.trackSid)?null:(this.tracks.set(P.trackSid,P),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[P.kind].set(P.trackSid,P),function(g,A){var P=new Map;"disconnected"!==g.state&&(g._getTrackPublicationEvents().forEach(function(L){var R=h(L,2),E=R[0],S=R[1];P.set(E,function(){for(var T=[],x=0;x<arguments.length;x++)T[x]=arguments[x];g.emit.apply(g,o(o([S],h(T)),[A]))}),A.on(E,P.get(E))}),g._trackPublicationEventReemitters.set(A.trackSid,P))}(this,P),L.info("Added a new "+y.trackPublicationClass(P)+":",P.trackSid),L.debug(y.trackPublicationClass(P)+":",P),P)},A.prototype._handleTrackSignalingEvents=function(){var P=this,L=P._log,R=P._clientTrackSwitchOffControl,E=P._contentPreferencesMode,S=this;if("disconnected"!==this.state){var T=this._RemoteAudioTrack,x=this._RemoteAudioTrackPublication,M=this._RemoteVideoTrack,N=this._RemoteVideoTrackPublication,j=this._RemoteDataTrack,$=this._RemoteDataTrackPublication,V=this._signaling;V.on("trackAdded",B),V.on("trackRemoved",ee),V.tracks.forEach(B),V.on("stateChanged",function W(F){"disconnected"===F?(L.debug("Removing event listeners"),V.removeListener("stateChanged",W),V.removeListener("trackAdded",B),V.removeListener("trackRemoved",ee)):"connected"===F&&(L.info("reconnected"),setTimeout(function(){return S.emit("reconnected")},0))})}function B(W){var O=new(0,{audio:x,data:$,video:N}[W.kind])(W,{log:L});S._addTrackPublication(O);var k=W.isSubscribed;k&&ne(W),S._trackSignalingUpdatedEventCallbacks.set(W.sid,function(){if(k!==W.isSubscribed){if(k=W.isSubscribed)return void ne(W);!function(W){var F=h(Array.from(S._tracks.entries()).find(function(K){return h(K,2)[1].sid===W.sid}),2),O=F[0],k=F[1],U=S.tracks.get(W.sid);k&&S._removeTrack(k,U,O)}(W)}}),W.on("updated",S._trackSignalingUpdatedEventCallbacks.get(W.sid))}function ee(W){W.isSubscribed&&W.setTrackTransceiver(null);var F=S._trackSignalingUpdatedEventCallbacks.get(W.sid);F&&(W.removeListener("updated",F),S._trackSignalingUpdatedEventCallbacks.delete(W.sid));var O=S.tracks.get(W.sid);O&&S._removeTrackPublication(O)}function ne(W){var F=W.isEnabled,O=W.name,k=W.kind,U=W.sid,K=W.trackTransceiver,re=W.isSwitchedOff,J={audio:T,video:M,data:j}[k],q=S.tracks.get(U);if(J&&k===K.kind){var le={log:L,name:O,clientTrackSwitchOffControl:R,contentPreferencesMode:E},Pe="data"===k?new J(U,K,le):new J(U,K,F,re,function(be){return V.updateSubscriberTrackPriority(U,be)},function(be){W.isSubscribed&&V.updateTrackRenderHint(U,be)},le);S._addTrack(Pe,q,K.id)}}},A.prototype._removeTrack=function(P,L){if(!this._tracks.has(L))return null;this._tracks.delete(L),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[P.kind].delete(L),(this._trackEventReemitters.get(L)||new Map).forEach(function(T,x){P.removeListener(x,T)});var S=this._log;return S.info("Removed a "+y.trackClass(P)+":",L),S.debug(y.trackClass(P)+":",P),P},A.prototype._removeTrackPublication=function(P){if(!(P=this.tracks.get(P.trackSid)))return null;this.tracks.delete(P.trackSid),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[P.kind].delete(P.trackSid),(this._trackPublicationEventReemitters.get(P.trackSid)||new Map).forEach(function(S,T){P.removeListener(T,S)});var E=this._log;return E.info("Removed a "+y.trackPublicationClass(P)+":",P.trackSid),E.debug(y.trackPublicationClass(P)+":",P),P},A.prototype.toJSON=function(){return y.valueToJSON(this)},A}(s);function c(g,A,P){var L=new Map;"disconnected"!==g.state&&(g._getTrackEvents().forEach(function(R){var E=R[0],S=R[1];L.set(E,function(){var T=[S].concat([].slice.call(arguments));return g.emit.apply(g,o([],h(T)))}),A.on(E,L.get(E))}),g._trackEventReemitters.set(P,L))}C.exports=b},8267:function(C,w){"use strict";var a=this&&this.__awaiter||function(e,r,n,l){return new(n||(n=Promise))(function(_,b){function f(v){try{c(l.next(v))}catch(g){b(g)}}function u(v){try{c(l.throw(v))}catch(g){b(g)}}function c(v){v.done?_(v.value):function(_){return _ instanceof n?_:new n(function(b){b(_)})}(v.value).then(f,u)}c((l=l.apply(e,r||[])).next())})},p=this&&this.__generator||function(e,r){var l,y,_,b,n={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return b={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function f(c){return function(v){return function(c){if(l)throw new TypeError("Generator is already executing.");for(;n;)try{if(l=1,y&&(_=2&c[0]?y.return:c[0]?y.throw||((_=y.return)&&_.call(y),0):y.next)&&!(_=_.call(y,c[1])).done)return _;switch(y=0,_&&(c=[2&c[0],_.value]),c[0]){case 0:case 1:_=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,y=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(!(_=(_=n.trys).length>0&&_[_.length-1])&&(6===c[0]||2===c[0])){n=0;continue}if(3===c[0]&&(!_||c[1]>_[0]&&c[1]<_[3])){n.label=c[1];break}if(6===c[0]&&n.label<_[1]){n.label=_[1],_=c;break}if(_&&n.label<_[2]){n.label=_[2],n.ops.push(c);break}_[2]&&n.ops.pop(),n.trys.pop();continue}c=r.call(e,n)}catch(v){c=[6,v],y=0}finally{l=_=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,v])}}},h=this&&this.__read||function(e,r){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var y,b,l=n.call(e),_=[];try{for(;(void 0===r||r-- >0)&&!(y=l.next()).done;)_.push(y.value)}catch(f){b={error:f}}finally{try{y&&!y.done&&(n=l.return)&&n.call(l)}finally{if(b)throw b.error}}return _};function o(e,r,n,l){var y=[];return e.forEach(function(_){(0===l.length||l.includes(_.type))&&(0===n.length||n.includes(_.kind))&&"number"==typeof _[r]&&y.push(_[r])}),y}function i(e){return[{key:"transportId",type:"string"},{key:"candidateType",type:"string"},{key:"port",altKeys:["portNumber"],type:"number"},{key:"address",altKeys:["ip","ipAddress"],type:"string"},{key:"priority",type:"number"},{key:"protocol",altKeys:["transport"],type:"string"},{key:"url",type:"string"},{key:"relayProtocol",type:"string"}].reduce(function(n,l){var y=[l.key];l.altKeys&&(y=y.concat(l.altKeys));var _=y.find(function(b){return b in e});return _&&typeof e[_]===l.type&&(n[l.key]=e[_]),n},{})}Object.defineProperty(w,"__esModule",{value:!0}),w.getCombinedConnectionStats=void 0,w.getCombinedConnectionStats=function(e){var r=e.publisher,n=e.subscriber;return a(this,void 0,void 0,function(){var l,y,_,b,f,u,c,v,g,A,P,L,R,E,S;return p(this,function(T){switch(T.label){case 0:return[4,Promise.all([r,n].map(function(x){return x.getStats()}))];case 1:return l=h.apply(void 0,[T.sent(),2]),y=l[0],b=o(_=l[1],"timestamp",["audio"],["inbound-rtp"]),f=b.length>0?b[0]:0,u=o(_,"jitter",["audio"],["inbound-rtp"]).reduce(function(x,M){return Math.max(x,M)},0),c=o(_,"packetsReceived",["audio","video"],["inbound-rtp"]).reduce(function(x,M){return x+M},0),v=o(_,"packetsLost",["audio","video"],["inbound-rtp"]).reduce(function(x,M){return x+M},0),g=o(y,"roundTripTime",["audio","video"],["remote-inbound-rtp"]).reduce(function(x,M){return Math.max(x,M)},0),A=o(_,"currentRoundTripTime",[],["candidate-pair"]).reduce(function(x,M){return Math.max(x,M)},0),P=1e3*(A||g),L=o(y,"bytesSent",[],["candidate-pair"]).reduce(function(x,M){return x+M},0),R=o(_,"bytesReceived",[],["candidate-pair"]).reduce(function(x,M){return x+M},0),E=function(e){var r=null,n=[];e.forEach(function(f){"transport"===f.type&&f.selectedCandidatePairId?r=f.selectedCandidatePairId:"candidate-pair"===f.type&&n.push(f)});var l=n.find(function(f){return f.selected||r&&f.id===r});if(!l)return null;var y=l,_=e.get(y.localCandidateId),b=e.get(y.remoteCandidateId);return _&&b?{localCandidate:i(_),remoteCandidate:i(b)}:null}(_),S=[],_.forEach(function(x){("local-candidate"===x.type||"remote-candidate"===x.type)&&S.push(i(x))}),[2,{timestamp:f,jitter:u,packets:c,packetsLost:v,roundTripTime:P,bytesSent:L,bytesReceived:R,selectedIceCandidatePairStats:E,iceCandidateStats:S}]}})})}},8259:(C,w,a)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.getTurnCredentials=void 0;var p=a(9616),h=a(9917).ICE_VERSION,o=a(7061),s=o.createTwilioError,i=o.SignalingConnectionError,t=a(3105);w.getTurnCredentials=function(r,n){return new Promise(function(l,y){var _=new t.EventEmitter,f=new p(n,{networkMonitor:null,eventObserver:_,helloBody:{edge:"roaming",preflight:!0,token:r,type:"ice",version:h}}),u=!1;f.once("close",function(){u||(u=!0,y(new i))}),f.on("message",function(c){var v=c.code,g=c.message,P=c.type;("iced"===P||"error"===P)&&!u&&(u=!0,"iced"===P?l(c.ice_servers):y(s(v,g)),f.close())})})}},2316:function(C,w){"use strict";var a=this&&this.__read||function(o,s){var i="function"==typeof Symbol&&o[Symbol.iterator];if(!i)return o;var e,n,t=i.call(o),r=[];try{for(;(void 0===s||s-- >0)&&!(e=t.next()).done;)r.push(e.value)}catch(l){n={error:l}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}return r},p=this&&this.__spreadArray||function(o,s){for(var i=0,t=s.length,e=o.length;i<t;i++,e++)o[e]=s[i];return o};Object.defineProperty(w,"__esModule",{value:!0}),w.makeStat=void 0,w.makeStat=function(o){return o&&o.length?{min:Math.min.apply(Math,p([],a(o))),max:Math.max.apply(Math,p([],a(o))),average:o.reduce(function(e,r){return e+r},0)/o.length}:null}},608:(C,w)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.mosToScore=w.calculateMOS=void 0;var a=94.768;w.calculateMOS=function(o,s,i){var t=o+2*s+10,e=0;switch(!0){case t<160:e=a-t/40;break;case t<1e3:e=a-(t-120)/10}switch(!0){case i<=e/2.5:e=Math.max(e-2.5*i,6.52);break;default:e=0}return 1+.035*e+7e-6*e*(e-60)*(100-e)},w.mosToScore=function(o){return o?o>4.2?5:o>4?4:o>3.6?3:o>3?2:1:0}},712:function(C,w,a){"use strict";var ne,p=this&&this.__extends||(ne=function(te,W){return(ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,O){F.__proto__=O}||function(F,O){for(var k in O)Object.prototype.hasOwnProperty.call(O,k)&&(F[k]=O[k])})(te,W)},function(te,W){if("function"!=typeof W&&null!==W)throw new TypeError("Class extends value "+String(W)+" is not a constructor or null");function F(){this.constructor=te}ne(te,W),te.prototype=null===W?Object.create(W):(F.prototype=W.prototype,new F)}),h=this&&this.__assign||function(){return(h=Object.assign||function(ne){for(var te,W=1,F=arguments.length;W<F;W++)for(var O in te=arguments[W])Object.prototype.hasOwnProperty.call(te,O)&&(ne[O]=te[O]);return ne}).apply(this,arguments)},o=this&&this.__awaiter||function(ne,te,W,F){return new(W||(W=Promise))(function(k,U){function K(q){try{J(F.next(q))}catch(le){U(le)}}function re(q){try{J(F.throw(q))}catch(le){U(le)}}function J(q){q.done?k(q.value):function(k){return k instanceof W?k:new W(function(U){U(k)})}(q.value).then(K,re)}J((F=F.apply(ne,te||[])).next())})},s=this&&this.__generator||function(ne,te){var F,O,k,U,W={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return U={next:K(0),throw:K(1),return:K(2)},"function"==typeof Symbol&&(U[Symbol.iterator]=function(){return this}),U;function K(J){return function(q){return function(J){if(F)throw new TypeError("Generator is already executing.");for(;W;)try{if(F=1,O&&(k=2&J[0]?O.return:J[0]?O.throw||((k=O.return)&&k.call(O),0):O.next)&&!(k=k.call(O,J[1])).done)return k;switch(O=0,k&&(J=[2&J[0],k.value]),J[0]){case 0:case 1:k=J;break;case 4:return W.label++,{value:J[1],done:!1};case 5:W.label++,O=J[1],J=[0];continue;case 7:J=W.ops.pop(),W.trys.pop();continue;default:if(!(k=(k=W.trys).length>0&&k[k.length-1])&&(6===J[0]||2===J[0])){W=0;continue}if(3===J[0]&&(!k||J[1]>k[0]&&J[1]<k[3])){W.label=J[1];break}if(6===J[0]&&W.label<k[1]){W.label=k[1],k=J;break}if(k&&W.label<k[2]){W.label=k[2],W.ops.push(J);break}k[2]&&W.ops.pop(),W.trys.pop();continue}J=te.call(ne,W)}catch(q){J=[6,q],O=0}finally{F=k=0}if(5&J[0])throw J[1];return{value:J[0]?J[1]:void 0,done:!0}}([J,q])}}};Object.defineProperty(w,"__esModule",{value:!0}),w.runPreflight=w.PreflightTest=void 0;var i=a(9917),t=a(1960),e=a(608),r=a(8267),n=a(8259),l=a(2316),y=a(9860),_=a(9806),b=a(3761),f=a(9917).WS_SERVER,u=a(7394),c=a(5737),v=a(2100),g=a(8326),A=a(3066),P=a(3187),L=P.createSID,R=P.sessionSID,E=a(7061),S=E.SignalingConnectionTimeoutError,T=E.MediaConnectionError;function j(ne){return null!=ne}var $=0,V=function(ne){function te(W,F){var O=ne.call(this)||this;O._testTiming=new t.Timer,O._dtlsTiming=new t.Timer,O._iceTiming=new t.Timer,O._peerConnectionTiming=new t.Timer,O._mediaTiming=new t.Timer,O._connectTiming=new t.Timer,O._sentBytesMovingAverage=new v,O._packetLossMovingAverage=new v,O._progressEvents=[],O._receivedBytesMovingAverage=new v;var U=F.environment,K=void 0===U?"prod":U,re=F.region,q=F.duration,le=void 0===q?1e4:q,ve=F.wsServer||f(K,void 0===re?"gll":re);return O._log=new u("default",O,i.DEFAULT_LOG_LEVEL,i.DEFAULT_LOGGER_NAME),O._testDuration=le,O._instanceId=$++,O._testTiming.start(),O._runPreflightTest(W,K,ve),O}return p(te,ne),te.prototype.toString=function(){return"[Preflight #"+this._instanceId+"]"},te.prototype.stop=function(){this._stopped=!0},te.prototype._generatePreflightReport=function(W){return this._testTiming.stop(),{testTiming:this._testTiming.getTimeMeasurement(),networkTiming:{dtls:this._dtlsTiming.getTimeMeasurement(),ice:this._iceTiming.getTimeMeasurement(),peerConnection:this._peerConnectionTiming.getTimeMeasurement(),connect:this._connectTiming.getTimeMeasurement(),media:this._mediaTiming.getTimeMeasurement()},stats:{jitter:l.makeStat(null==W?void 0:W.jitter),rtt:l.makeStat(null==W?void 0:W.rtt),packetLoss:l.makeStat(null==W?void 0:W.packetLoss)},selectedIceCandidatePairStats:W?W.selectedIceCandidatePairStats:null,iceCandidateStats:W?W.iceCandidateStats:[],progressEvents:this._progressEvents,mos:l.makeStat(null==W?void 0:W.mos)}},te.prototype._executePreflightStep=function(W,F,O){return o(this,void 0,void 0,function(){var k,U,K,re;return s(this,function(q){switch(q.label){case 0:if(this._log.debug("Executing step: ",W),k=this._testDuration+1e4,this._stopped)throw new Error("stopped");U=Promise.resolve().then(F),K=null,re=new Promise(function(le,ve){K=setTimeout(function(){ve(O||new Error(W+" timeout."))},k)}),q.label=1;case 1:return q.trys.push([1,,3,4]),[4,Promise.race([re,U])];case 2:return[2,q.sent()];case 3:return null!==K&&clearTimeout(K),[7];case 4:return[2]}})})},te.prototype._collectNetworkTimings=function(W){var F=this;return new Promise(function(O){var k;W.addEventListener("iceconnectionstatechange",function(){"checking"===W.iceConnectionState&&F._iceTiming.start(),"connected"===W.iceConnectionState&&(F._iceTiming.stop(),F._updateProgress("iceConnected"),(!k||k&&"connected"===k.state)&&O())}),W.addEventListener("connectionstatechange",function(){"connecting"===W.connectionState&&F._peerConnectionTiming.start(),"connected"===W.connectionState&&(F._peerConnectionTiming.stop(),F._updateProgress("peerConnectionConnected"))});var K=W.getSenders().map(function(re){return re.transport}).find(j);void 0!==K&&(k=K).addEventListener("statechange",function(){"connecting"===k.state&&F._dtlsTiming.start(),"connected"===k.state&&(F._dtlsTiming.stop(),F._updateProgress("dtlsConnected"),"connected"===W.iceConnectionState&&O())})})},te.prototype._setupInsights=function(W){var O=W.environment,U=W.realm,J=new A(W.token,i.SDK_NAME,i.SDK_VERSION,void 0===O?i.DEFAULT_ENVIRONMENT:O,void 0===U?i.DEFAULT_REALM:U,{});J.connect("PREFLIGHT_ROOM_SID","PREFLIGHT_PARTICIPANT");var q=new g(J,Date.now(),this._log),le=void 0;return{reportToInsights:function(ve){var _e,Pe,be=ve.report,we=be.stats.jitter||le,Se=be.stats.rtt||le,Le=be.stats.packetLoss||le,Ce=be.mos||le,Oe=new Map;be.iceCandidateStats.forEach(function(ie){if(ie.candidateType&&ie.protocol){var ae=Oe.get(ie.candidateType)||[];ae.indexOf(ie.protocol)<0&&ae.push(ie.protocol),Oe.set(ie.candidateType,ae)}});var ue=JSON.stringify(Object.fromEntries(Oe)),Z={name:"report",group:"preflight",level:be.error?"error":"info",payload:{sessionSID:R,preflightSID:L("PF"),progressEvents:JSON.stringify(be.progressEvents),testTiming:be.testTiming,dtlsTiming:be.networkTiming.dtls,iceTiming:be.networkTiming.ice,peerConnectionTiming:be.networkTiming.peerConnection,connectTiming:be.networkTiming.connect,mediaTiming:be.networkTiming.media,selectedLocalCandidate:null===(_e=be.selectedIceCandidatePairStats)||void 0===_e?void 0:_e.localCandidate,selectedRemoteCandidate:null===(Pe=be.selectedIceCandidatePairStats)||void 0===Pe?void 0:Pe.remoteCandidate,iceCandidateStats:ue,jitterStats:we,rttStats:Se,packetLossStats:Le,mosStats:Ce,error:be.error}};q.emit("event",Z),setTimeout(function(){return J.disconnect()},2e3)}}},te.prototype._runPreflightTest=function(W,F,O){return o(this,void 0,void 0,function(){var k,U,K,re,J,q,le,ve,_e,Pe,be,we,Se=this;return s(this,function(Le){switch(Le.label){case 0:k=[],U=[],K=this._setupInsights({token:W,environment:F}).reportToInsights,Le.label=1;case 1:return Le.trys.push([1,8,9,10]),re=[],[4,this._executePreflightStep("Acquire media",function(){return[y.syntheticAudio(),_.syntheticVideo({width:640,height:480})]})];case 2:return k=Le.sent(),this._updateProgress("mediaAcquired"),this.emit("debug",{localTracks:k}),this._connectTiming.start(),[4,this._executePreflightStep("Get turn credentials",function(){return n.getTurnCredentials(W,O)},new S)];case 3:return J=Le.sent(),this._connectTiming.stop(),this._updateProgress("connected"),q=new RTCPeerConnection({iceServers:J,iceTransportPolicy:"relay",bundlePolicy:"max-bundle"}),le=new RTCPeerConnection({iceServers:J,bundlePolicy:"max-bundle"}),U.push(q),U.push(le),this._mediaTiming.start(),[4,this._executePreflightStep("Setup Peer Connections",function(){return o(Se,void 0,void 0,function(){var Ce,Oe,ue,Z;return s(this,function(ie){switch(ie.label){case 0:return q.addEventListener("icecandidate",function(ae){return ae.candidate&&le.addIceCandidate(ae.candidate)}),le.addEventListener("icecandidate",function(ae){return ae.candidate&&q.addIceCandidate(ae.candidate)}),k.forEach(function(ae){return q.addTrack(ae)}),Ce=new Promise(function(ae){var H=[];le.addEventListener("track",function(D){H.push(D.track),H.length===k.length&&ae(H)})}),[4,q.createOffer()];case 1:return Oe=ie.sent(),[4,q.setLocalDescription(ue=Oe)];case 2:return ie.sent(),[4,le.setRemoteDescription(ue)];case 3:return ie.sent(),[4,le.createAnswer()];case 4:return Z=ie.sent(),[4,le.setLocalDescription(Z)];case 5:return ie.sent(),[4,q.setRemoteDescription(Z)];case 6:return ie.sent(),[4,this._collectNetworkTimings(q)];case 7:return ie.sent(),[2,Ce]}})})},new T)];case 4:return ve=Le.sent(),this.emit("debug",{remoteTracks:ve}),ve.forEach(function(Ce){Ce.addEventListener("ended",function(){return Se._log.warn(Ce.kind+":ended")}),Ce.addEventListener("mute",function(){return Se._log.warn(Ce.kind+":muted")}),Ce.addEventListener("unmute",function(){return Se._log.warn(Ce.kind+":unmuted")})}),this._updateProgress("mediaSubscribed"),[4,this._executePreflightStep("Wait for tracks to start",function(){return new Promise(function(Ce){var Oe=document.createElement("video");Oe.autoplay=!0,Oe.playsInline=!0,Oe.muted=!0,Oe.srcObject=new MediaStream(ve),re.push(Oe),Se.emit("debugElement",Oe),Oe.oncanplay=Ce})},new T)];case 5:return Le.sent(),this._mediaTiming.stop(),this._updateProgress("mediaStarted"),[4,this._executePreflightStep("Collect stats for duration",function(){return Se._collectRTCStatsForDuration(Se._testDuration,{mos:[],jitter:[],rtt:[],outgoingBitrate:[],incomingBitrate:[],packetLoss:[],selectedIceCandidatePairStats:null,iceCandidateStats:[]},q,le)})];case 6:return _e=Le.sent(),[4,this._executePreflightStep("Generate report",function(){return Se._generatePreflightReport(_e)})];case 7:return Pe=Le.sent(),K({report:Pe}),this.emit("completed",Pe),[3,10];case 8:return be=Le.sent(),we=this._generatePreflightReport(),K({report:h(h({},we),{error:null==be?void 0:be.toString()})}),this.emit("failed",be,we),[3,10];case 9:return U.forEach(function(Ce){return Ce.close()}),k.forEach(function(Ce){return Ce.stop()}),[7];case 10:return[2]}})})},te.prototype._collectRTCStats=function(W,F,O){return o(this,void 0,void 0,function(){var k,U,K,re,J,q,le,ve,_e,Pe,be,we,Se,Le;return s(this,function(Ce){switch(Ce.label){case 0:return[4,r.getCombinedConnectionStats({publisher:F,subscriber:O})];case 1:return k=Ce.sent(),U=k.timestamp,K=k.bytesSent,re=k.bytesReceived,J=k.packets,q=k.packetsLost,le=k.roundTripTime,_e=k.selectedIceCandidatePairStats,Pe=k.iceCandidateStats,be=W.jitter.length>0,W.jitter.push(ve=k.jitter),W.rtt.push(le),this._sentBytesMovingAverage.putSample(K,U),this._receivedBytesMovingAverage.putSample(re,U),this._packetLossMovingAverage.putSample(q,J),be&&(W.outgoingBitrate.push(1e3*this._sentBytesMovingAverage.get()*8),W.incomingBitrate.push(1e3*this._receivedBytesMovingAverage.get()*8),we=this._packetLossMovingAverage.get(),Se=Math.min(100,100*we),W.packetLoss.push(Se),Le=e.calculateMOS(le,ve,we),W.mos.push(Le)),W.selectedIceCandidatePairStats||(W.selectedIceCandidatePairStats=_e),0===W.iceCandidateStats.length&&(W.iceCandidateStats=Pe),[2]}})})},te.prototype._collectRTCStatsForDuration=function(W,F,O,k){return o(this,void 0,void 0,function(){var U,K,re;return s(this,function(J){switch(J.label){case 0:return U=Date.now(),K=Math.min(1e3,W),[4,b.waitForSometime(K)];case 1:return J.sent(),[4,this._collectRTCStats(F,O,k)];case 2:return J.sent(),(re=W-(Date.now()-U))>0?[4,this._collectRTCStatsForDuration(re,F,O,k)]:[3,4];case 3:F=J.sent(),J.label=4;case 4:return[2,F]}})})},te.prototype._updateProgress=function(W){var F=Date.now()-this._testTiming.getTimeMeasurement().start;this._progressEvents.push({duration:F,name:W}),this.emit("progress",W)},te}(c);w.PreflightTest=V,w.runPreflight=function(ne,te){return void 0===te&&(te={}),new V(ne,te)}},9860:(C,w,a)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.syntheticAudio=void 0,w.syntheticAudio=function(){var h=a(9057),o={},s=h.getOrCreate(o),i=s.createOscillator(),t=i.connect(s.createMediaStreamDestination());i.start();var e=t.stream.getAudioTracks()[0],r=e.stop;return e.stop=function(){r.call(e),h.release(o)},e}},9806:(C,w)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.syntheticVideo=void 0,w.syntheticVideo=function(p){var h=void 0===p?{}:p,o=h.width,s=void 0===o?640:o,i=h.height,t=void 0===i?480:i,e=Object.assign(document.createElement("canvas"),{width:s,height:t}),r=e.getContext("2d");r.fillStyle="green",r.fillRect(0,0,e.width,e.height);var n=!1;requestAnimationFrame(function b(){if(!n){var f=Math.round(255*Math.random()),u=Math.round(255*Math.random()),c=Math.round(255*Math.random()),v=Math.round(255*Math.random());r.fillStyle="rgba("+f+", "+u+", "+c+", "+v+")",r.fillRect(Math.random()*s,Math.random()*t,50,50),requestAnimationFrame(b)}});var y=e.captureStream(30).getTracks()[0],_=y.stop;return y.stop=function(){n=!0,_.call(y)},y}},1960:(C,w)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.Timer=void 0;var a=function(){function p(){this._end=void 0,this.start()}return p.prototype.start=function(){return this._start=Date.now(),this},p.prototype.stop=function(){return this._end=Date.now(),this},p.prototype.getTimeMeasurement=function(){return{start:this._start,end:this._end,duration:void 0===this._end?void 0:this._end-this._start}},p}();w.Timer=a},5468:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var l,_,n=r.call(t),y=[];try{for(;(void 0===e||e-- >0)&&!(l=n.next()).done;)y.push(l.value)}catch(b){_={error:b}}finally{try{l&&!l.done&&(r=n.return)&&r.call(n)}finally{if(_)throw _.error}}return y},o=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,l=t.length;r<n;r++,l++)t[l]=e[r];return t},i=function(t){function e(){var r=t.call(this)||this;return Object.defineProperties(r,{_queuedEvents:{value:new Map}}),r}return p(e,t),e.prototype.dequeue=function(r){var n=this,l=!0;if(!r)return this._queuedEvents.forEach(function(_,b){l=this.dequeue(b)&&l},this),l;var y=this._queuedEvents.get(r)||[];return this._queuedEvents.delete(r),y.reduce(function(_,b){return n.emit.apply(n,o([],h([r].concat(b))))&&_},l)},e.prototype.queue=function(){var r=[].slice.call(arguments);if(this.emit.apply(this,o([],h(r))))return!0;var n=r[0];return this._queuedEvents.has(n)||this._queuedEvents.set(n,[]),this._queuedEvents.get(n).push(r.slice(1)),!1},e}(a(3105).EventEmitter);C.exports=i},1792:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var l,_,n=r.call(t),y=[];try{for(;(void 0===e||e-- >0)&&!(l=n.next()).done;)y.push(l.value)}catch(b){_={error:b}}finally{try{l&&!l.done&&(r=n.return)&&r.call(n)}finally{if(_)throw _.error}}return y},o=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,l=t.length;r<n;r++,l++)t[l]=e[r];return t},i=function(t){function e(r,n){var l=t.call(this,r,n)||this;return l._handleTrackSignalingEvents(),l.once("disconnected",l._unsubscribeTracks.bind(l)),l}return p(e,t),e.prototype.toString=function(){return"[RemoteParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},e.prototype._addTrack=function(r,n,l){return t.prototype._addTrack.call(this,r,l)?(n._subscribed(r),this.emit("trackSubscribed",r,n),r):null},e.prototype._addTrackPublication=function(r){var n=t.prototype._addTrackPublication.call(this,r);return n?(this.emit("trackPublished",n),n):null},e.prototype._getTrackPublicationEvents=function(){return o(o([],h(t.prototype._getTrackPublicationEvents.call(this))),[["subscriptionFailed","trackSubscriptionFailed"],["trackDisabled","trackDisabled"],["trackEnabled","trackEnabled"],["publishPriorityChanged","trackPublishPriorityChanged"],["trackSwitchedOff","trackSwitchedOff"],["trackSwitchedOn","trackSwitchedOn"]])},e.prototype._unsubscribeTracks=function(){var r=this;this.tracks.forEach(function(n){if(n.isSubscribed){var l=n.track;n._unsubscribe(),r.emit("trackUnsubscribed",l,n)}})},e.prototype._removeTrack=function(r,n,l){var y=this._tracks.get(l);return y?(t.prototype._removeTrack.call(this,y,l),n._unsubscribe(),this.emit("trackUnsubscribed",y,n),y):null},e.prototype._removeTrackPublication=function(r){this._signaling.clearTrackHint(r.trackSid);var n=t.prototype._removeTrackPublication.call(this,r);return n?(this.emit("trackUnpublished",n),n):null},e}(a(5513));C.exports=i},7970:function(C,w,a){"use strict";var f,p=this&&this.__extends||(f=function(u,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(v[A]=g[A])})(u,c)},function(u,c){if("function"!=typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function v(){this.constructor=u}f(u,c),u.prototype=null===c?Object.create(c):(v.prototype=c.prototype,new v)}),h=this&&this.__read||function(f,u){var c="function"==typeof Symbol&&f[Symbol.iterator];if(!c)return f;var g,P,v=c.call(f),A=[];try{for(;(void 0===u||u-- >0)&&!(g=v.next()).done;)A.push(g.value)}catch(L){P={error:L}}finally{try{g&&!g.done&&(c=v.return)&&c.call(v)}finally{if(P)throw P.error}}return A},o=this&&this.__spreadArray||function(f,u){for(var c=0,v=u.length,g=f.length;c<v;c++,g++)f[g]=u[c];return f},s=a(5737),i=a(1792),t=a(6614),e=a(3761).valueToJSON,r=0,n=function(f){function u(c,v,g){var A=f.call(this)||this,P=g.log.createLog("default",A),L=new Map;return Object.defineProperties(A,{_log:{value:P},_clientTrackSwitchOffControl:{value:g.clientTrackSwitchOffControl||"disabled"},_contentPreferencesMode:{value:g.contentPreferencesMode||"disabled"},_instanceId:{value:++r},_options:{value:g},_participants:{value:L},_signaling:{value:v},dominantSpeaker:{enumerable:!0,get:function(){return this.participants.get(v.dominantSpeakerSid)||null}},isRecording:{enumerable:!0,get:function(){return v.recording.isEnabled||!1}},localParticipant:{enumerable:!0,value:c},name:{enumerable:!0,value:v.name},participants:{enumerable:!0,value:L},sid:{enumerable:!0,value:v.sid},state:{enumerable:!0,get:function(){return v.state}},mediaRegion:{enumerable:!0,value:v.mediaRegion}}),function(f,u){u.on("updated",function(){var v=u.isEnabled;f._log.info("Recording "+(v?"started":"stopped")),f.emit("recording"+(v?"Started":"Stopped"))})}(A,v.recording),function(f,u){var c=f._log;c.debug("Creating a new RemoteParticipant for each ParticipantSignaling in the RoomSignaling"),u.participants.forEach(y.bind(null,f)),c.debug("Setting up RemoteParticipant creation for all subsequent ParticipantSignalings that connect to the RoomSignaling"),u.on("participantConnected",y.bind(null,f)),u.on("dominantSpeakerChanged",function(){return f.emit("dominantSpeakerChanged",f.dominantSpeaker)}),u.on("stateChanged",function v(g,A){switch(c.info("Transitioned to state:",g),g){case"disconnected":f.participants.forEach(function(P){P._unsubscribeTracks()}),f.emit(g,f,A),f.localParticipant.tracks.forEach(function(P){P.unpublish()}),u.removeListener("stateChanged",v);break;case"reconnecting":setTimeout(function(){return f.emit("reconnecting",A)},0);break;default:setTimeout(function(){return f.emit("reconnected")},0)}})}(A,v),P.info("Created a new Room:",A.name),P.debug("Initial RemoteParticipants:",Array.from(A._participants.values())),A}return p(u,f),u.prototype.toString=function(){return"[Room #"+this._instanceId+": "+this.sid+"]"},u.prototype.disconnect=function(){return this._log.info("Disconnecting"),this._signaling.disconnect(),this},u.prototype.getStats=function(){var c=this;return this._signaling.getStats().then(function(v){return Array.from(v).map(function(g){var A=h(g,2),L=A[1];return new t(A[0],Object.assign({},L,{localAudioTrackStats:l(c,L.localAudioTrackStats),localVideoTrackStats:l(c,L.localVideoTrackStats)}))})})},u.prototype.toJSON=function(){return e(this)},u}(s);function l(f,u){var c=f.localParticipant._signaling;return u.reduce(function(v,g){var A=c.tracks.get(g.trackId),P=c.getSender(A);return P?[Object.assign({},g,{trackId:P.id})].concat(v):v},[])}function y(f,u){var c=f._log,A=new i(u,{log:c,clientTrackSwitchOffControl:f._clientTrackSwitchOffControl,contentPreferencesMode:f._contentPreferencesMode});c.info("A new RemoteParticipant connected:",A),f._participants.set(A.sid,A),f.emit("participantConnected",A);var P=[["reconnected","participantReconnected"],["reconnecting","participantReconnecting"],"trackDimensionsChanged","trackDisabled","trackEnabled","trackMessage","trackPublished","trackPublishPriorityChanged","trackStarted","trackSubscribed","trackSubscriptionFailed","trackSwitchedOff","trackSwitchedOn","trackUnpublished","trackUnsubscribed"].map(function(L){var R=h(Array.isArray(L)?L:[L,L],2),E=R[0],S=R[1];function T(){var x=[].slice.call(arguments);x.unshift(S),x.push(A),f.emit.apply(f,o([],h(x)))}return A.on(E,T),[E,T]});A.once("disconnected",function(){var R=f.dominantSpeaker;c.info("RemoteParticipant disconnected:",A),f._participants.delete(A.sid),P.forEach(function(E){A.removeListener(E[0],E[1])}),f.emit("participantDisconnected",A),A===R&&f.emit("dominantSpeakerChanged",f.dominantSpeaker)})}C.exports=n},3185:function(C,w,a){"use strict";var e,p=this&&this.__extends||(e=function(r,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(l[_]=y[_])})(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function l(){this.constructor=r}e(r,n),r.prototype=null===n?Object.create(n):(l.prototype=n.prototype,new l)}),h=a(8553),o=a(6996),s=a(1856),i={closed:["opening"],opening:["closed","open"],open:["closed","closing"],closing:["closed","open"]},t=function(e){function r(){return e.call(this,"closed",i)||this}return p(r,e),r.prototype._close=function(n){return this.transition("closing",n),this.transition("closed",n),Promise.resolve(this)},r.prototype._connect=function(n,l,y,_,b){n.connect("PA00000000000000000000000000000000","test");var u=Promise.resolve(new o(n,"RM00000000000000000000000000000000",b));return u.cancel=function(){},u},r.prototype._open=function(n){return this.transition("opening",n),this.transition("open",n),Promise.resolve(this)},r.prototype.close=function(){var n=this;return this.bracket("close",function(l){switch(n.state){case"closed":return n;case"open":return n._close(l);default:throw new Error('Unexpected Signaling state "'+n.state+'"')}})},r.prototype.connect=function(n,l,y,_,b){var f=this;return this.bracket("connect",function u(c){switch(f.state){case"closed":return f._open(c).then(u.bind(null,c));case"open":return f.releaseLockCompletely(c),f._connect(n,l,y,_,b);default:throw new Error('Unexpected Signaling state "'+f.state+'"')}})},r.prototype.createLocalParticipantSignaling=function(){return new h},r.prototype.open=function(){var n=this;return this.bracket("open",function(l){switch(n.state){case"closed":return n._open(l);case"open":return n;default:throw new Error('Unexpected Signaling state "'+n.state+'"')}})},r}(s);C.exports=t},518:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(){var t=s.call(this)||this;return Object.defineProperties(t,{_publicationsToTrackSenders:{value:new Map},_trackSendersToPublications:{value:new Map}}),t}return p(i,s),i.prototype.addTrack=function(t,e,r){var n=this._createLocalTrackPublicationSignaling(t,e,r);return this._trackSendersToPublications.set(t,n),this._publicationsToTrackSenders.set(n,t),s.prototype.addTrack.call(this,n),this},i.prototype.getPublication=function(t){return this._trackSendersToPublications.get(t)||null},i.prototype.getSender=function(t){return this._publicationsToTrackSenders.get(t)||null},i.prototype.removeTrack=function(t){var e=this._trackSendersToPublications.get(t);return e?(this._trackSendersToPublications.delete(t),this._publicationsToTrackSenders.delete(e),s.prototype.removeTrack.call(this,e)&&e.stop(),e):null},i}(a(8553));C.exports=o},7667:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=function(i){function t(e,r,n){var l=this;return e=e.clone(),(l=i.call(this,r,e.kind,"data"===e.kind||e.track.enabled,n)||this).setTrackTransceiver(e),Object.defineProperties(l,{_updatedPriority:{value:n,writable:!0},id:{enumerable:!0,value:e.id}}),l}return p(t,i),Object.defineProperty(t.prototype,"updatedPriority",{get:function(){return this._updatedPriority},enumerable:!1,configurable:!0}),t.prototype.enable=function(e){return this.trackTransceiver.track.enabled=e="boolean"!=typeof e||e,i.prototype.enable.call(this,e)},t.prototype.publishFailed=function(e){return function(i,t){return null===i._sid&&!i._error&&(i._error=t,!0)}(this,e)&&this.emit("updated"),this},t.prototype.setPriority=function(e){return this._updatedPriority!==e&&(this._updatedPriority=e,this.emit("updated")),this},t.prototype.setSid=function(e){return this._error?this:i.prototype.setSid.call(this,e)},t.prototype.stop=function(){this.trackTransceiver.stop()},t}(a(1109));C.exports=o},8553:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(1856),o=a(5674),s={connecting:["connected"],connected:["disconnected","reconnecting"],reconnecting:["connected","disconnected"],disconnected:[]},i=function(t){function e(){var r=t.call(this,"connecting",s)||this;return Object.defineProperties(r,{_identity:{writable:!0,value:null},_networkQualityLevel:{value:null,writable:!0},_networkQualityStats:{value:null,writable:!0},_sid:{writable:!0,value:null},identity:{enumerable:!0,get:function(){return this._identity}},sid:{enumerable:!0,get:function(){return this._sid}},tracks:{enumerable:!0,value:new Map}}),r}return p(e,t),Object.defineProperty(e.prototype,"networkQualityLevel",{get:function(){return this._networkQualityLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"networkQualityStats",{get:function(){return this._networkQualityStats},enumerable:!1,configurable:!0}),e.prototype.addTrack=function(r){return this.tracks.set(r.id||r.sid,r),this.emit("trackAdded",r),this},e.prototype.disconnect=function(){return"disconnected"!==this.state&&(this.preempt("disconnected"),!0)},e.prototype.removeTrack=function(r){var n=this.tracks.get(r.id||r.sid);return this.tracks.delete(r.id||r.sid),n&&this.emit("trackRemoved",r),n||null},e.prototype.setNetworkQualityLevel=function(r,n){this._networkQualityLevel!==r&&(this._networkQualityLevel=r,this._networkQualityStats=n&&(n.audio||n.video)?new o(n):null,this.emit("networkQualityLevelChanged"))},e.prototype.connect=function(r,n){return("connecting"===this.state||"reconnecting"===this.state)&&(this._sid||(this._sid=r),this._identity||(this._identity=n),this.preempt("connected"),!0)},e.prototype.reconnecting=function(){return("connecting"===this.state||"connected"===this.state)&&(this.preempt("reconnecting"),!0)},e}(h);C.exports=i},8659:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(){var t=s.call(this)||this;return Object.defineProperties(t,{_isEnabled:{value:null,writable:!0},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}}}),t}return p(i,s),i.prototype.disable=function(){return this.enable(!1)},i.prototype.enable=function(t){return this.isEnabled!==(t="boolean"!=typeof t||t)&&(this._isEnabled=t,this.emit("updated")),this},i}(a(3105).EventEmitter);C.exports=o},8760:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this)||this;return r.connect(t,e),r}return p(i,s),i}(a(8553));C.exports=o},2261:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n,l,y){var _=s.call(this,e,r,n,l)||this;return Object.defineProperties(_,{_isSwitchedOff:{value:y,writable:!0}}),_.setSid(t),_}return p(i,s),Object.defineProperty(i.prototype,"isSubscribed",{get:function(){return!!this.trackTransceiver},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isSwitchedOff",{get:function(){return this._isSwitchedOff},enumerable:!1,configurable:!0}),i.prototype.subscribeFailed=function(t){return this.error||(this._error=t,this.emit("updated")),this},i.prototype.setPriority=function(t){return this._priority!==t&&(this._priority=t,this.emit("updated")),this},i.prototype.setSwitchedOff=function(t){return this._isSwitchedOff!==t&&(this._isSwitchedOff=t,this.emit("updated")),this},i}(a(1109));C.exports=o},6996:function(C,w,a){"use strict";var c,p=this&&this.__extends||(c=function(v,g){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,P){A.__proto__=P}||function(A,P){for(var L in P)Object.prototype.hasOwnProperty.call(P,L)&&(A[L]=P[L])})(v,g)},function(v,g){if("function"!=typeof g&&null!==g)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function A(){this.constructor=v}c(v,g),v.prototype=null===g?Object.create(g):(A.prototype=g.prototype,new A)}),h=a(8659),o=a(1856),s=a(1190),i=a(3761).buildLogLevels,t=a(9917).DEFAULT_LOG_LEVEL,e=a(7394),r=a(7061),n=r.MediaConnectionError,l=r.MediaDTLSTransportFailedError,y=r.SignalingConnectionDisconnectedError,_=0,b={connected:["reconnecting","disconnected"],reconnecting:["connected","disconnected"],disconnected:[]},f=function(c){function v(g,A,P,L){var R=this;L=Object.assign({logLevel:t,RecordingSignaling:h,Timeout:s},L);var E=i(L.logLevel);R=c.call(this,"connected",b)||this;var S=L.RecordingSignaling,T=new L.Timeout(function(){R._disconnect(R._reconnectingError)},L.sessionTimeout,!1);return Object.defineProperties(R,{_instanceId:{value:_++},_log:{value:L.log?L.log.createLog("default",R):new e("default",R,E,L.loggerName)},_mediaConnectionIsReconnecting:{writable:!0,value:!1},_options:{value:L},_reconnectingError:{value:null,writable:!0},_sessionTimeout:{value:T},dominantSpeakerSid:{enumerable:!0,value:null,writable:!0},localParticipant:{enumerable:!0,value:g},name:{enumerable:!0,value:P},participants:{enumerable:!0,value:new Map},recording:{enumerable:!0,value:new S},sid:{enumerable:!0,value:A}}),R.on("connectionStateChanged",function(){"failed"===R.connectionState&&!["disconnected","failed"].includes(R.iceConnectionState)&&R._disconnect(new l)}),R.on("iceConnectionStateChanged",function(){return u(R)}),R.on("signalingConnectionStateChanged",function(){return u(R)}),setTimeout(function(){return u(R)}),R}return p(v,c),v.prototype._disconnect=function(g){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[g]),!0)},v.prototype.toString=function(){return"[RoomSignaling #"+this._instanceId+": "+(this.localParticipant?this.localParticipant.sid:"null")+"]"},v.prototype.connectParticipant=function(g){var A=this;return"disconnected"!==g.state&&!this.participants.has(g.sid)&&(this.participants.set(g.sid,g),g.on("stateChanged",function P(L){"disconnected"===L&&(g.removeListener("stateChanged",P),A.participants.delete(g.sid),A.emit("participantDisconnected",g))}),this.emit("participantConnected",g),!0)},v.prototype.disconnect=function(){return this._disconnect()},v.prototype.setDominantSpeaker=function(g){this.dominantSpeakerSid=g,this.emit("dominantSpeakerChanged")},v}(o);function u(c){var v;"disconnected"!==c.state&&"disconnected"!==c.signalingConnectionState?("reconnecting"===c.signalingConnectionState?v=c.signalingConnectionState:"failed"===c.iceConnectionState?(c._mediaConnectionIsReconnecting=!0,v="reconnecting"):"new"===c.iceConnectionState||"checking"===c.iceConnectionState?v=c._mediaConnectionIsReconnecting?"reconnecting":"connected":(c._mediaConnectionIsReconnecting=!1,c._reconnectingError=null,c._sessionTimeout.clear(),v="connected"),v!==c.state&&("reconnecting"===v?(c._reconnectingError="reconnecting"===c.signalingConnectionState?new y:new n,c._sessionTimeout.start(),c.preempt(v,null,[c._reconnectingError])):c.preempt(v))):c._sessionTimeout.clear()}C.exports=f},1109:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r,n){var l=s.call(this)||this,y=null;return Object.defineProperties(l,{_error:{value:null,writable:!0},_isEnabled:{value:r,writable:!0},_priority:{value:n,writable:!0},_trackTransceiver:{value:null,writable:!0},_sid:{get:function(){return y},set:function(_){null===y&&(y=_)}},kind:{enumerable:!0,value:e},name:{enumerable:!0,value:t}}),l}return p(i,s),Object.defineProperty(i.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sid",{get:function(){return this._sid},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"trackTransceiver",{get:function(){return this._trackTransceiver},enumerable:!1,configurable:!0}),i.prototype.disable=function(){return this.enable(!1)},i.prototype.enable=function(t){return this.isEnabled!==(t="boolean"!=typeof t||t)&&(this._isEnabled=t,this.emit("updated")),this},i.prototype.setTrackTransceiver=function(t){return this.trackTransceiver!==(t=t||null)&&(this._trackTransceiver=t,this.emit("updated")),this},i.prototype.setSid=function(t){return null===this.sid&&(this._sid=t,this.emit("updated")),this},i}(a(3105).EventEmitter);C.exports=o},4384:(C,w,a)=>{"use strict";var p=a(617),h=a(5971),o=a(3899),s=a(1328),i=a(7061),t=i.SignalingConnectionDisconnectedError,e=i.SignalingIncomingMessageInvalidError,r=a(3761),n=r.flatMap,l=r.createRoomConnectEventPayload;C.exports=function(_,b,f,u,c,v){v=Object.assign({PeerConnectionManager:h,RoomV2:o,Transport:s},v);var g=c.video[0]&&!0===c.video[0].adaptiveSimulcast,P=v.RoomV2,L=v.Transport,R=v.iceServers,E=v.log,S=new(0,v.PeerConnectionManager)(u,c,v),T=n(f.tracks,function(j){return[j.trackTransceiver]});S.setTrackSenders(T);var M,x=new Error("Canceled"),N=new p(function(j,$,V){var ne=v.bandwidthProfile,F=v.eventObserver,U=v.name,Pe=Object.assign({adaptiveSimulcast:g,automaticSubscription:v.automaticSubscription,dominantSpeaker:v.dominantSpeaker,environment:v.environment,eventObserver:F,loggerName:v.loggerName,logLevel:v.logLevel,networkMonitor:v.networkMonitor,networkQuality:v.networkQuality,iceServers:R,onIced:function(we){return V()?($(x),Promise.reject(x)):(E.debug("Got ICE servers:",we),v.iceServers=we,S.setConfiguration(v),S.createAndOffer().then(function(){if(V())throw $(x),x;E.debug("createAndOffer() succeeded."),S.dequeue("description")}).catch(function(Se){throw E.error("createAndOffer() failed:",Se),$(Se),Se}))},realm:v.realm,renderHints:!!ne&&("disabled"!==v.clientTrackSwitchOffControl||"disabled"!==v.contentPreferencesMode),sdpSemantics:v.sdpSemantics,trackPriority:!!ne,trackSwitchOff:!!ne},ne?{bandwidthProfile:ne}:{});M=new L(U,_,f,S,b,Pe);var be=l(v);F.emit("event",be),M.once("connected",function(we){E.debug("Transport connected:",we),V()?$(x):we.participant?(f.setSignalingRegion(we.options.signaling_region),j(new P(f,we,M,S,v))):$(new e)}),M.once("stateChanged",function(we,Se){"disconnected"===we?(M=null,$(Se||new t)):E.debug("Transport state changed:",we)})},function(){M&&(M.disconnect(),M=null)});return N.catch(function(){M&&(M.disconnect(),M=null),S.close()}),N}},2222:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,"active_speaker",e)||this;return Object.defineProperties(r,{_loudestParticipantSid:{value:null,writable:!0}}),r.on("ready",function(n){n.on("message",function(l){switch(l.type){case"active_speaker":r._setLoudestParticipantSid(l.participant)}})}),r}return p(i,s),Object.defineProperty(i.prototype,"loudestParticipantSid",{get:function(){return this._loudestParticipantSid},enumerable:!1,configurable:!0}),i.prototype._setLoudestParticipantSid=function(t){this.loudestParticipantSid!==t&&(this._loudestParticipantSid=t,this.emit("updated"))},i}(a(762));C.exports=o},5175:(C,w,a)=>{"use strict";var p=a(7060),h=function(){function o(){Object.defineProperties(this,{_filter:{value:new p({getKey:function(i){return i.ufrag},isLessThanOrEqualTo:function(i,t){return i.revision<=t.revision}})},_ufrag:{writable:!0,value:null},ufrag:{enumerable:!0,get:function(){return this._ufrag}}})}return o.prototype.setUfrag=function(s){this._ufrag=s;var i=this._filter.toMap().get(s);return i?i.candidates:[]},o.prototype.update=function(s){s.candidates=s.candidates||[];var i=this._filter.toMap().get(s.ufrag),t=i?i.candidates:[];return this._filter.update(s)&&this._ufrag===s.ufrag?s.candidates.slice(t.length):[]},o}();C.exports=h},6802:(C,w,a)=>{"use strict";var p=a(9917),h=p.ICE_ACTIVITY_CHECK_PERIOD_MS,o=p.ICE_INACTIVITY_THRESHOLD_MS,s=function(){function i(t,e){e=Object.assign({activityCheckPeriodMs:h,inactivityThresholdMs:o},e),Object.defineProperties(this,{_activityCheckPeriodMs:{value:e.activityCheckPeriodMs},_inactivityThresholdMs:{value:e.inactivityThresholdMs},_lastActivity:{value:null,writable:!0},_peerConnection:{value:t},_timer:{value:null,writable:!0},_onIceConnectionStateChanged:{value:null,writable:!0}})}return i.prototype._getActivePairStat=function(t){return Array.from(t.values()).find(function(n){return"candidate-pair"===n.type&&n.nominated})||{bytesReceived:0,timestamp:Math.round((new Date).getTime())}},i.prototype._getIceConnectionStats=function(){var t=this;return this._peerConnection.getStats().then(function(e){return t._getActivePairStat(e)}).catch(function(){return null})},i.prototype._scheduleInactivityCallback=function(t){var e=this;t&&null===this._onIceConnectionStateChanged?(this._onIceConnectionStateChanged=function(){"disconnected"===e._peerConnection.iceConnectionState&&t()},this._peerConnection.addEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged)):!t&&this._onIceConnectionStateChanged&&(this._peerConnection.removeEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._onIceConnectionStateChanged=null)},i.prototype.start=function(t){var e=this;this.stop(),this._timer=setInterval(function(){e._getIceConnectionStats().then(function(r){!r||((!e._lastActivity||e._lastActivity.bytesReceived!==r.bytesReceived)&&(e._lastActivity=r,e._scheduleInactivityCallback(null)),r.timestamp-e._lastActivity.timestamp>=e._inactivityThresholdMs&&("disconnected"===e._peerConnection.iceConnectionState?t():null===e._onIceConnectionStateChanged&&e._scheduleInactivityCallback(t)))})},this._activityCheckPeriodMs)},i.prototype.stop=function(){this._scheduleInactivityCallback(null),null!==this._timer&&(clearInterval(this._timer),this._timer=null,this._lastActivity=null)},i}();C.exports=s},9003:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(4384),o=a(7701),i=function(t){function e(r,n){var l;return n=Object.assign({createCancelableRoomSignalingPromise:h},n),l=t.call(this)||this,Object.defineProperties(l,{_createCancelableRoomSignalingPromise:{value:n.createCancelableRoomSignalingPromise},_options:{value:n},_wsServer:{value:r}}),l}return p(e,t),e.prototype._connect=function(r,n,l,y,_){return _=Object.assign({},this._options,_),this._createCancelableRoomSignalingPromise.bind(null,n,this._wsServer,r,l,y,_)},e.prototype.createLocalParticipantSignaling=function(r,n){return new o(r,n)},e}(a(3185));C.exports=i},7701:function(C,w,a){"use strict";var l,p=this&&this.__extends||(l=function(y,_){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,f){b.__proto__=f}||function(b,f){for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&(b[u]=f[u])})(y,_)},function(y,_){if("function"!=typeof _&&null!==_)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function b(){this.constructor=y}l(y,_),y.prototype=null===_?Object.create(_):(b.prototype=_.prototype,new b)}),h=a(518),o=a(3679),s=a(9917).DEFAULT_LOG_LEVEL,i=a(7394),t=a(3761),e=t.buildLogLevels,r=t.isDeepEqual,n=function(l){function y(_,b,f){var u;f=Object.assign({logLevel:s,LocalTrackPublicationV2:o},f),u=l.call(this)||this;var c=e(f.logLevel);return Object.defineProperties(u,{_bandwidthProfile:{value:null,writable:!0},_bandwidthProfileRevision:{value:0,writable:!0},_encodingParameters:{value:_},_removeListeners:{value:new Map},_LocalTrackPublicationV2:{value:f.LocalTrackPublicationV2},_log:{value:f.log?f.log.createLog("default",u):new i("default",u,c,f.loggerName)},_publishedRevision:{writable:!0,value:0},_revision:{writable:!0,value:1},_signalingRegion:{value:null,writable:!0},bandwidthProfile:{enumerable:!0,get:function(){return this._bandwidthProfile}},bandwidthProfileRevision:{enumerable:!0,get:function(){return this._bandwidthProfileRevision}},networkQualityConfiguration:{enumerable:!0,value:b},revision:{enumerable:!0,get:function(){return this._revision}},signalingRegion:{enumerable:!0,get:function(){return this._signalingRegion}}}),u}return p(y,l),y.prototype.toString=function(){return"[LocalParticipantSignaling: "+this.sid+"]"},y.prototype.setSignalingRegion=function(_){this._signalingRegion||(this._signalingRegion=_)},y.prototype.setBandwidthProfile=function(_){r(this._bandwidthProfile,_)||(this._bandwidthProfile=JSON.parse(JSON.stringify(_)),this._bandwidthProfileRevision++,this.didUpdate())},y.prototype.getParameters=function(){return this._encodingParameters},y.prototype.setParameters=function(_){return this._encodingParameters.update(_),this},y.prototype.update=function(_){return this._publishedRevision>=_.revision||(this._publishedRevision=_.revision,_.tracks.forEach(function(b){var f=this.tracks.get(b.id);f&&f.update(b)},this)),this},y.prototype._createLocalTrackPublicationSignaling=function(_,b,f){return new this._LocalTrackPublicationV2(_,b,f)},y.prototype.addTrack=function(_,b,f){var u=this;l.prototype.addTrack.call(this,_,b,f);var c=this.getPublication(_),v=c.isEnabled,g=c.updatedPriority,A=function(){(v!==c.isEnabled||g!==c.updatedPriority)&&(u.didUpdate(),v=c.isEnabled,g=c.updatedPriority)};return c.on("updated",A),this._removeListener(c),this._removeListeners.set(c,function(){return c.removeListener("updated",A)}),this.didUpdate(),this},y.prototype._removeListener=function(_){var b=this._removeListeners.get(_);b&&b()},y.prototype.getState=function(){return{revision:this.revision,tracks:Array.from(this.tracks.values()).map(function(_){return _.getState()})}},y.prototype.didUpdate=function(){this._revision++,this.emit("updated")},y.prototype.removeTrack=function(_){var b=l.prototype.removeTrack.call(this,_);return b&&(_.removeClone(b.trackTransceiver),this._removeListener(b),this.didUpdate()),b},y.prototype.setNetworkQualityConfiguration=function(_){this.networkQualityConfiguration.update(_)},y.prototype.setPublisherHint=function(_,b){var f=Array.from(this.tracks.values()).find(function(u){return u.sid===_});return f?f.trackTransceiver.setPublisherHint(b):(this._log.warn("track:"+_+" not found"),Promise.resolve("UNKNOWN_TRACK"))},y}(h);C.exports=n},3679:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(7667),o=a(7061).createTwilioError,s=function(i){function t(e,r,n){return i.call(this,e,r,n)||this}return p(t,i),t.prototype.getState=function(){return{enabled:this.isEnabled,id:this.id,kind:this.kind,name:this.name,priority:this.updatedPriority}},t.prototype.update=function(e){switch(e.state){case"ready":this.setSid(e.sid);break;case"failed":var r=e.error;this.publishFailed(o(r.code,r.message))}return this},t}(h);C.exports=s},762:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(3105),o=0,s=function(i){function t(e,r,n){var l=i.call(this)||this;return Object.defineProperties(l,{_instanceId:{value:o++},channel:{value:r},_log:{value:n.log.createLog("default",l)},_getReceiver:{value:e},_receiverPromise:{value:null,writable:!0},_transport:{value:null,writable:!0}}),l}return p(t,i),Object.defineProperty(t.prototype,"isSetup",{get:function(){return!!this._receiverPromise},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[MediaSignaling #"+this._instanceId+":"+this.channel+"]"},t.prototype.setup=function(e){var r=this;this._teardown(),this._log.info("setting up msp transport for id:",e);var n=this._getReceiver(e).then(function(l){if("data"!==l.kind&&r._log.error("Expected a DataTrackReceiver"),r._receiverPromise===n){try{r._transport=l.toDataTransport(),r.emit("ready",r._transport)}catch(y){r._log.error("Failed to toDataTransport: "+y.message)}l.once("close",function(){return r._teardown()})}});this._receiverPromise=n},t.prototype._teardown=function(){this._transport&&(this._log.info("Tearing down"),this._transport=null,this._receiverPromise=null,this.emit("teardown"))},t}(h);C.exports=s},8804:function(C,w,a){"use strict";var e,p=this&&this.__extends||(e=function(r,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(l[_]=y[_])})(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function l(){this.constructor=r}e(r,n),r.prototype=null===n?Object.create(n):(l.prototype=n.prototype,new l)}),h=this&&this.__read||function(e,r){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var y,b,l=n.call(e),_=[];try{for(;(void 0===r||r-- >0)&&!(y=l.next()).done;)_.push(y.value)}catch(f){b={error:f}}finally{try{y&&!y.done&&(n=l.return)&&n.call(l)}finally{if(b)throw b.error}}return _},o=a(3105),s=a(127),i=function(e){function r(n,l){var y=e.call(this)||this;return Object.defineProperties(y,{_factories:{value:new WeakMap},_manager:{value:n},_signaling:{value:l}}),l.on("updated",function(){return y.emit("updated")}),y}return p(r,e),Object.defineProperty(r.prototype,"level",{get:function(){return this._signaling.level},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"levels",{get:function(){return this._signaling.levels},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"remoteLevels",{get:function(){return this._signaling.remoteLevels},enumerable:!1,configurable:!0}),r.prototype.start=function(){var n=this;this.stop();var l=setTimeout(function(){n._timeout===l&&function(e){var y=(e._manager._peerConnections?Array.from(e._manager._peerConnections.values()):[]).map(function(_){return _._peerConnection}).filter(function(_){return"closed"!==_.signalingState}).map(function(_){if(e._factories.has(_))return e._factories.get(_);var b=new s(_);return e._factories.set(_,b),b}).map(function(_){return _.next().catch(function(){return null})});return Promise.all(y).then(function(_){return _.filter(function(b){return b}).map(function(b){return b.summarize()})})}(n).then(function(y){if(n._timeout===l){if(y.length){var _=h(y,1);n._signaling.put(_[0])}n.start()}})},200);this._timeout=l},r.prototype.stop=function(){clearTimeout(this._timeout),this._timeout=null},r}(o);C.exports=i},1159:function(C,w,a){"use strict";var r,p=this&&this.__extends||(r=function(n,l){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,_){y.__proto__=_}||function(y,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(y[b]=_[b])})(n,l)},function(n,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function y(){this.constructor=n}r(n,l),n.prototype=null===l?Object.create(l):(y.prototype=l.prototype,new y)}),h=a(762),o=a(8264),s=a(1190),t=function(r){function n(l,y,_){var b=r.call(this,l,"network_quality",_)||this;return Object.defineProperties(b,{_level:{value:null,writable:!0},_levels:{value:null,writable:!0},_remoteLevels:{value:new Map,writable:!0},_networkQualityInputs:{value:new o},_resendTimer:{value:new s(function(){b._resendTimer.setDelay(1.5*b._resendTimer.delay),b._sendNetworkQualityInputs()},5e3,!1)},_networkQualityReportLevels:{get:function(){return{reportLevel:y.local,remoteReportLevel:y.remote}}}}),b.on("ready",function(f){f.on("message",function(u){switch(b._log.debug("Incoming: ",u),u.type){case"network_quality":b._handleNetworkQualityMessage(u)}})}),b._sendNetworkQualityInputs(),b}return p(n,r),Object.defineProperty(n.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"levels",{get:function(){return this._levels},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"remoteLevels",{get:function(){return this._remoteLevels},enumerable:!1,configurable:!0}),n.prototype._handleNetworkQualityMessage=function(l){var y=this,_=!1,b=null,f=l?l.local:null;"number"==typeof f?(b=f,this._levels=null):"object"==typeof f&&f&&(this._levels=f,b="number"==typeof f.level?f.level:Math.min(f.audio.send,f.audio.recv,f.video.send,f.video.recv)),null!==b&&this.level!==b&&(this._level=b,_=!0),this._remoteLevels=l&&l.remotes?l.remotes.reduce(function(u,c){return(y._remoteLevels.get(c.sid)||{}).level!==c.level&&(_=!0),u.set(c.sid,c)},new Map):this._remoteLevels,_&&this.emit("updated"),this._resendTimer.setDelay(5e3),this._resendTimer.isSet&&setTimeout(function(){return y._sendNetworkQualityInputs()},1e3)},n.prototype._sendNetworkQualityInputs=function(){var l=this;return this._resendTimer.clear(),this._networkQualityInputs.take().then(function(y){l._transport&&l._transport.publish(function(r,n){return Object.assign({type:"network_quality"},r,n)}(y,l._networkQualityReportLevels))}).finally(function(){l._resendTimer.start()})},n.prototype.put=function(l){this._networkQualityInputs.put(l)},n}(h);C.exports=t},4556:function(C,w,a){"use strict";var ge,p=this&&this.__extends||(ge=function(pe,G){return(ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,se){X.__proto__=se}||function(X,se){for(var ce in se)Object.prototype.hasOwnProperty.call(se,ce)&&(X[ce]=se[ce])})(pe,G)},function(pe,G){if("function"!=typeof G&&null!==G)throw new TypeError("Class extends value "+String(G)+" is not a constructor or null");function X(){this.constructor=pe}ge(pe,G),pe.prototype=null===G?Object.create(G):(X.prototype=G.prototype,new X)}),h=this&&this.__read||function(ge,pe){var G="function"==typeof Symbol&&ge[Symbol.iterator];if(!G)return ge;var se,he,X=G.call(ge),ce=[];try{for(;(void 0===pe||pe-- >0)&&!(se=X.next()).done;)ce.push(se.value)}catch(Re){he={error:Re}}finally{try{se&&!se.done&&(G=X.return)&&G.call(X)}finally{if(he)throw he.error}}return ce},o=this&&this.__spreadArray||function(ge,pe){for(var G=0,X=pe.length,se=ge.length;G<X;G++,se++)ge[se]=pe[G];return ge},s=a(4035),i=a(4135),t=i.RTCIceCandidate,e=i.RTCPeerConnection,r=i.RTCSessionDescription,n=i.getStats,l=a(4911),y=a(9917),_=y.DEFAULT_ICE_GATHERING_TIMEOUT_MS,b=y.DEFAULT_LOG_LEVEL,f=y.DEFAULT_SESSION_TIMEOUT_SEC,u=y.iceRestartBackoffConfig,c=a(3028),v=c.addOrRewriteNewTrackIds,g=c.addOrRewriteTrackIds,A=c.createCodecMapForMediaSection,P=c.disableRtx,L=c.enableDtxForOpus,R=c.filterLocalCodecs,E=c.getMediaSections,S=c.removeSSRCAttributes,T=c.revertSimulcast,x=c.setCodecPreferences,M=c.setSimulcast,N=a(1190),j=a(7061),$=j.MediaClientLocalDescFailedError,V=j.MediaClientRemoteDescFailedError,B=a(3761),ee=B.buildLogLevels,ne=B.getPlatform,te=B.isChromeScreenShareTrack,W=B.oncePerTick,F=B.defer,O=a(5175),k=a(6802),U=a(1144),K=a(6804),re=a(1856),J=a(7394),q=a(5612),le=a(556),ve=l.guessBrowser(),_e=ne(),Pe=/android/.test(_e),be="chrome"===ve,we="firefox"===ve,Se="safari"===ve,Le=0,Ce={open:["closed","updating"],updating:["closed","open"],closed:[]},Oe=function(ge){function pe(G,X,se,ce){var he=ge.call(this,"open",Ce)||this,Re=H(ce=Object.assign({enableDscp:!1,dummyAudioMediaStreamTrack:null,isChromeScreenShareTrack:te,iceServers:[],logLevel:b,offerOptions:{},revertSimulcast:T,sessionTimeout:1e3*f,setCodecPreferences:x,setSimulcast:M,Backoff:s,IceConnectionMonitor:k,RTCIceCandidate:t,RTCPeerConnection:e,RTCSessionDescription:r,Timeout:N},ce)),De=ee(ce.logLevel),We=ce.RTCPeerConnection;!0===ce.enableDscp&&(ce.chromeSpecificConstraints=ce.chromeSpecificConstraints||{},ce.chromeSpecificConstraints.optional=ce.chromeSpecificConstraints.optional||[],ce.chromeSpecificConstraints.optional.push({googDscp:!0}));var He=ce.log?ce.log.createLog("webrtc",he):new J("webrtc",he,De,ce.loggerName),Ie=new We(Re,ce.chromeSpecificConstraints);ce.dummyAudioMediaStreamTrack&&Ie.addTrack(ce.dummyAudioMediaStreamTrack),Object.defineProperties(he,{_appliedTrackIdsToAttributes:{value:new Map,writable:!0},_dataChannels:{value:new Map},_dataTrackReceivers:{value:new Set},_descriptionRevision:{writable:!0,value:0},_didGenerateLocalCandidates:{writable:!0,value:!1},_enableDscp:{value:ce.enableDscp},_encodingParameters:{value:X},_isChromeScreenShareTrack:{value:ce.isChromeScreenShareTrack},_iceGatheringFailed:{value:!1,writable:!0},_iceGatheringTimeout:{value:new ce.Timeout(function(){return he._handleIceGatheringTimeout()},_,!1)},_iceRestartBackoff:{value:ce.Backoff.exponential(u)},_instanceId:{value:++Le},_isIceConnectionInactive:{writable:!0,value:!1},_isIceLite:{writable:!0,value:!1},_isIceRestartBackoffInProgress:{writable:!0,value:!1},_isRestartingIce:{writable:!0,value:!1},_lastIceConnectionState:{writable:!0,value:null},_lastStableDescriptionRevision:{writable:!0,value:0},_localCandidates:{writable:!0,value:[]},_localCodecs:{value:new Set},_localCandidatesRevision:{writable:!0,value:1},_localDescriptionWithoutSimulcast:{writable:!0,value:null},_localDescription:{writable:!0,value:null},_localUfrag:{writable:!0,value:null},_log:{value:He},_eventObserver:{value:ce.eventObserver},_remoteCodecMaps:{value:new Map},_rtpSenders:{value:new Map},_rtpNewSenders:{value:new Set},_iceConnectionMonitor:{value:new ce.IceConnectionMonitor(Ie)},_mediaTrackReceivers:{value:new Set},_needsAnswer:{writable:!0,value:!1},_negotiationRole:{writable:!0,value:null},_offerOptions:{writable:!0,value:ce.offerOptions},_onEncodingParametersChanged:{value:W(function(){he._needsAnswer||Ve(he)})},_peerConnection:{value:Ie},_preferredAudioCodecs:{value:se.audio},_preferredVideoCodecs:{value:se.video},_shouldApplyDtx:{value:se.audio.every(function(Ee){return"opus"!==Ee.codec})||se.audio.some(function(Ee){return"opus"===Ee.codec&&Ee.dtx})},_queuedDescription:{writable:!0,value:null},_iceReconnectTimeout:{value:new ce.Timeout(function(){He.debug("ICE reconnect timed out"),he.close()},ce.sessionTimeout,!1)},_recycledTransceivers:{value:{audio:[],video:[]}},_replaceTrackPromises:{value:new Map},_remoteCandidates:{writable:!0,value:new O},_setCodecPreferences:{value:we&&Pe&&se.video[0]&&"h264"!==se.video[0].codec.toLowerCase()?function(Ee){return Ee}:ce.setCodecPreferences},_setSimulcast:{value:ce.setSimulcast},_revertSimulcast:{value:ce.revertSimulcast},_RTCIceCandidate:{value:ce.RTCIceCandidate},_RTCPeerConnection:{value:ce.RTCPeerConnection},_RTCSessionDescription:{value:ce.RTCSessionDescription},_shouldOffer:{writable:!0,value:!1},_shouldRestartIce:{writable:!0,value:!1},_trackIdsToAttributes:{value:new Map,writable:!0},_trackMatcher:{writable:!0,value:null},_mediaTrackSenderToPublisherHints:{value:new Map},id:{enumerable:!0,value:G}}),X.on("changed",he._onEncodingParametersChanged),Ie.addEventListener("connectionstatechange",he._handleConnectionStateChange.bind(he)),Ie.addEventListener("datachannel",he._handleDataChannelEvent.bind(he)),Ie.addEventListener("icecandidate",he._handleIceCandidateEvent.bind(he)),Ie.addEventListener("iceconnectionstatechange",he._handleIceConnectionStateChange.bind(he)),Ie.addEventListener("icegatheringstatechange",he._handleIceGatheringStateChange.bind(he)),Ie.addEventListener("signalingstatechange",he._handleSignalingStateChange.bind(he)),Ie.addEventListener("track",he._handleTrackEvent.bind(he)),he._iceRestartBackoff.on("ready",function(){return he._initiateIceRestart()});var Me=he;return he.on("stateChanged",function Ee(Be){"closed"===Be&&(Me.removeListener("stateChanged",Ee),Me._dataChannels.forEach(function(Qe,Je){Me.removeDataTrackSender(Je)}))}),he}return p(pe,ge),pe.prototype.toString=function(){return"[PeerConnectionV2 #"+this._instanceId+": "+this.id+"]"},pe.prototype.setEffectiveAdaptiveSimulcast=function(G){this._log.debug("Setting setEffectiveAdaptiveSimulcast: ",G),this._preferredVideoCodecs.forEach(function(X){"adaptiveSimulcast"in X&&(X.adaptiveSimulcast=G)})},Object.defineProperty(pe.prototype,"_shouldApplySimulcast",{get:function(){return!(!be&&!Se)&&this._preferredVideoCodecs.some(function(X){return"vp8"===X.codec.toLowerCase()&&X.simulcast&&!1!==X.adaptiveSimulcast})},enumerable:!1,configurable:!0}),Object.defineProperty(pe.prototype,"connectionState",{get:function(){return"failed"===this.iceConnectionState?"failed":this._peerConnection.connectionState||this.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(pe.prototype,"iceConnectionState",{get:function(){return this._isIceConnectionInactive&&"disconnected"===this._peerConnection.iceConnectionState||this._iceGatheringFailed?"failed":this._peerConnection.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(pe.prototype,"isApplicationSectionNegotiated",{get:function(){return"closed"===this._peerConnection.signalingState||!!this._peerConnection.localDescription&&E(this._peerConnection.localDescription.sdp,"application").length>0},enumerable:!1,configurable:!0}),Object.defineProperty(pe.prototype,"_isAdaptiveSimulcastEnabled",{get:function(){var G=this._preferredVideoCodecs.find(function(X){return"adaptiveSimulcast"in X});return G&&!0===G.adaptiveSimulcast},enumerable:!1,configurable:!0}),pe.prototype._maybeUpdateEncodings=function(G,X,se){if(void 0===se&&(se=!1),"video"!==G.kind)return!1;var ce=l.guessBrowser();return!!("safari"===ce||"chrome"===ce&&this._isAdaptiveSimulcastEnabled)&&(this._updateEncodings(G,X,se),!0)},pe.prototype._updateEncodings=function(G,X,se){if(this._isChromeScreenShareTrack(G)){var ce=[{scaleResolutionDownBy:1},{scaleResolutionDownBy:1}];X.forEach(function(Ee,Be){var Qe=ce[Be];Qe?(Ee.scaleResolutionDownBy=Qe.scaleResolutionDownBy,se&&delete Ee.active):(Ee.active=!1,delete Ee.scaleResolutionDownBy)})}else{var he=G.getSettings(),He=he.width*he.height,Ie=[{pixels:518400,maxActiveLayers:3},{pixels:129600,maxActiveLayers:2},{pixels:0,maxActiveLayers:1}].find(function(Ee){return He>=Ee.pixels}),Me=Math.min(X.length,Ie.maxActiveLayers);X.forEach(function(Ee,Be){Be<Me?(Ee.scaleResolutionDownBy=1<<Me-Be-1,se&&(Ee.active=!0)):(Ee.active=!1,delete Ee.scaleResolutionDownBy)})}this._log.debug("_updateEncodings:",X.map(function(Ee,Be){return"["+Be+": "+Ee.active+", "+(Ee.scaleResolutionDownBy||0)+"]"}).join(", "))},pe.prototype._addIceCandidate=function(G){var X=this;return Promise.resolve().then(function(){return G=new X._RTCIceCandidate(G),X._peerConnection.addIceCandidate(G)}).catch(function(se){X._log.warn("Failed to add RTCIceCandidate "+(G?'"'+G.candidate+'"':"null")+": "+se.message)})},pe.prototype._addIceCandidates=function(G){return Promise.all(G.map(this._addIceCandidate,this)).then(function(){})},pe.prototype._addOrUpdateTransceiver=function(G){var X=this,se=function(ge,pe){var G={audio:ge._preferredAudioCodecs.map(function(he){return he.codec.toLowerCase()}),video:ge._preferredVideoCodecs.map(function(he){return he.codec.toLowerCase()})}[pe],X=ge._recycledTransceivers[pe],se=G.find(function(he){return ge._localCodecs.has(he)});if(!se)return X.shift();var ce=X.find(function(he){var Re=ge._remoteCodecMaps.get(he.mid);return Re&&Re.has(se)});return ce&&X.splice(X.indexOf(ce),1),ce}(this,G.kind);if(se&&se.sender){var ce=se.sender.track?se.sender.track.id:null;return ce&&this._log.warn("Reusing transceiver: "+se.mid+"] "+ce+" => "+G.id),this._replaceTrackPromises.set(se,se.sender.replaceTrack(G).then(function(){se.direction="sendrecv"},function(){}).finally(function(){X._replaceTrackPromises.delete(se)})),se}return this._peerConnection.addTransceiver(G)},pe.prototype._checkIceBox=function(G){var X=ae(G);if(!X)return Promise.resolve();var se=this._remoteCandidates.setUfrag(X);return this._addIceCandidates(se)},pe.prototype._answer=function(G){var X=this;return Promise.resolve().then(function(){return X._negotiationRole||(X._negotiationRole="answerer"),X._setRemoteDescription(G)}).catch(function(){throw new V}).then(function(){return X._peerConnection.createAnswer()}).then(function(se){se=we?new X._RTCSessionDescription({sdp:P(se.sdp),type:se.type}):le(se);var ce=S(se.sdp,["mslabel","label"]);if(X._shouldApplySimulcast){var he=ce;ce=X._setSimulcast(he,X._trackIdsToAttributes),ce=X._revertSimulcast(ce,he,G.sdp)}return ce=ce.replace(/42e015/g,"42e01f"),X._setLocalDescription({type:se.type,sdp:ce})}).then(function(){return X._checkIceBox(G)}).then(function(){return X._queuedDescription&&X._updateDescription(X._queuedDescription)}).then(function(){return X._queuedDescription=null,X._maybeReoffer(X._peerConnection.localDescription)}).catch(function(se){var ce=se instanceof V?se:new $;throw X._publishMediaWarning({message:"Failed to _answer",code:ce.code,error:se}),ce})},pe.prototype._close=function(){return this._iceConnectionMonitor.stop(),"closed"!==this._peerConnection.signalingState&&(this._peerConnection.close(),this.preempt("closed"),this._encodingParameters.removeListener("changed",this._onEncodingParametersChanged),!0)},pe.prototype._handleConnectionStateChange=function(){this.emit("connectionStateChanged")},pe.prototype._handleDataChannelEvent=function(G){var X=this,se=G.channel,ce=new U(se);this._dataTrackReceivers.add(ce),se.addEventListener("close",function(){X._dataTrackReceivers.delete(ce)}),this.emit("trackAdded",ce)},pe.prototype._handleGlare=function(G){var X=this;return this._log.debug("Glare detected; rolling back"),this._isRestartingIce&&(this._log.debug("An ICE restart was in progress; we'll need to restart ICE again after rolling back"),this._isRestartingIce=!1,this._shouldRestartIce=!0),Promise.resolve().then(function(){return X._trackIdsToAttributes=new Map(X._appliedTrackIdsToAttributes),X._setLocalDescription({type:"rollback"})}).then(function(){return X._needsAnswer=!1,X._answer(G)}).then(function(se){return se?Promise.resolve():X._offer()})},pe.prototype._publishMediaWarning=function(G){this._eventObserver.emit("event",{level:"warning",name:"error",group:"media",payload:{message:G.message,code:G.code,context:JSON.stringify({error:G.error.message,sdp:G.sdp})}})},pe.prototype._handleIceCandidateEvent=function(G){G.candidate&&(this._log.debug("Clearing ICE gathering timeout"),this._didGenerateLocalCandidates=!0,this._iceGatheringTimeout.clear(),this._localCandidates.push(G.candidate));var X={ice:{candidates:this._isIceLite?[]:this._localCandidates.slice(),ufrag:this._localUfrag},id:this.id};G.candidate||(X.ice.complete=!0),this._isIceLite&&G.candidate||(X.ice.revision=this._localCandidatesRevision++,this.emit("candidates",X))},pe.prototype._handleIceConnectionStateChange=function(){var G=this,X=this._peerConnection.iceConnectionState,se=["connected","completed"].includes(X),ce=this._log;ce.debug('ICE connection state is "'+X+'"'),se&&(this._iceReconnectTimeout.clear(),this._iceRestartBackoff.reset()),"failed"===this._lastIceConnectionState||"failed"!==X||this._shouldRestartIce||this._isRestartingIce?["disconnected","failed"].includes(this._lastIceConnectionState)&&se&&ce.debug("ICE reconnected"):(ce.warn("ICE failed"),this._initiateIceRestartBackoff()),"connected"===X?(this._isIceConnectionInactive=!1,this._iceConnectionMonitor.start(function(){G._iceConnectionMonitor.stop(),!G._shouldRestartIce&&!G._isRestartingIce&&(ce.warn("ICE Connection Monitor detected inactivity"),G._isIceConnectionInactive=!0,G._initiateIceRestartBackoff(),G.emit("iceConnectionStateChanged"),G.emit("connectionStateChanged"))})):["disconnected","completed"].includes(X)||(this._iceConnectionMonitor.stop(),this._isIceConnectionInactive=!1),this._lastIceConnectionState=X,this.emit("iceConnectionStateChanged")},pe.prototype._handleIceGatheringTimeout=function(){this._log.warn("ICE failed to gather any local candidates"),this._iceGatheringFailed=!0,this._initiateIceRestartBackoff(),this.emit("iceConnectionStateChanged"),this.emit("connectionStateChanged")},pe.prototype._handleIceGatheringStateChange=function(){var G=this._peerConnection.iceGatheringState,X=this._log;X.debug('ICE gathering state is "'+G+'"');var se=this._iceGatheringTimeout;"gathering"===G&&!this._didGenerateLocalCandidates&&!se.isSet&&(X.debug("Starting ICE gathering timeout: "+se.delay),this._iceGatheringFailed=!1,this._iceGatheringTimeout.start())},pe.prototype._handleSignalingStateChange=function(){"stable"===this._peerConnection.signalingState&&(this._appliedTrackIdsToAttributes=new Map(this._trackIdsToAttributes))},pe.prototype._handleTrackEvent=function(G){var X=this,se=this._peerConnection.remoteDescription?this._peerConnection.remoteDescription.sdp:null;this._trackMatcher=this._trackMatcher||new q,this._trackMatcher.update(se);var ce=G.track,he=this._trackMatcher.match(G)||ce.id,Re=new K(he,ce);this._mediaTrackReceivers.forEach(function(De){De.track.id===Re.track.id&&X._mediaTrackReceivers.delete(De)}),this._mediaTrackReceivers.add(Re),ce.addEventListener("ended",function(){return X._mediaTrackReceivers.delete(Re)}),this.emit("trackAdded",Re)},pe.prototype._initiateIceRestart=function(){if("closed"!==this._peerConnection.signalingState){var G=this._log;G.warn("Attempting to restart ICE"),this._didGenerateLocalCandidates=!1,this._isIceRestartBackoffInProgress=!1,this._shouldRestartIce=!0;var X=this._iceReconnectTimeout;X.isSet||(G.debug("Starting ICE reconnect timeout: "+X.delay),this._iceReconnectTimeout.start()),this.offer().catch(function(he){G.error("offer failed in _initiateIceRestart with: "+he.message)})}},pe.prototype._initiateIceRestartBackoff=function(){"closed"===this._peerConnection.signalingState||this._isIceRestartBackoffInProgress||(this._log.warn("An ICE restart has been scheduled"),this._isIceRestartBackoffInProgress=!0,this._iceRestartBackoff.backoff())},pe.prototype._maybeReoffer=function(G){var X=this._shouldOffer;if(G&&G.sdp){var se=this._peerConnection.getSenders().filter(function(We){return We.track});X=["audio","video"].reduce(function(We,He){var Ie=E(G.sdp,He,"(sendrecv|sendonly)"),Me=se.filter(D.bind(null,He));return We||Ie.length<Me.length},X);var ce=this._dataChannels.size>0,he=E(G.sdp,"application").length>0;X=X||ce&&!he}return(X?this._offer():Promise.resolve()).then(function(){return X})},pe.prototype._offer=function(){var G=this,X=Object.assign({},this._offerOptions);return this._needsAnswer=!0,this._shouldRestartIce&&(this._shouldRestartIce=!1,this._isRestartingIce=!0,X.iceRestart=!0),Promise.all(this._replaceTrackPromises.values()).then(function(){return G._peerConnection.createOffer(X)}).catch(function(se){var ce=new $;throw G._publishMediaWarning({message:"Failed to create offer",code:ce.code,error:se}),ce}).then(function(se){se=we?new G._RTCSessionDescription({sdp:P(se.sdp),type:se.type}):le(se);var ce=S(se.sdp,["mslabel","label"]);ce=G._peerConnection.remoteDescription?R(ce,G._peerConnection.remoteDescription.sdp):ce;var he=G._setCodecPreferences(ce,G._preferredAudioCodecs,G._preferredVideoCodecs);return G._shouldOffer=!1,G._negotiationRole||(G._negotiationRole="offerer"),G._shouldApplySimulcast&&(G._localDescriptionWithoutSimulcast={type:"offer",sdp:he},he=G._setSimulcast(he,G._trackIdsToAttributes)),G._setLocalDescription({type:"offer",sdp:he})})},pe.prototype._getMediaTrackSenderId=function(G){var X=Array.from(this._rtpSenders.keys()).find(function(se){return se.track.id===G});return X?X.id:G},pe.prototype._addOrRewriteLocalTrackIds=function(G){var X=this,ce=this._peerConnection.getTransceivers().filter(function(Me){var Ee=Me.sender;return!Me.stopped&&Ee&&Ee.track}),he=ce.filter(function(Me){return Me.mid}),Re=new Map(he.map(function(Me){return[Me.mid,X._getMediaTrackSenderId(Me.sender.track.id)]})),De=g(G.sdp,Re),We=ce.filter(function(Me){return!Me.mid}),He=new Map(["audio","video"].map(function(Me){return[Me,We.filter(function(Ee){return Ee.sender.track.kind===Me}).map(function(Ee){return X._getMediaTrackSenderId(Ee.sender.track.id)})]})),Ie=v(De,Re,He);return new this._RTCSessionDescription({sdp:Ie,type:G.type})},pe.prototype._rollbackAndApplyOffer=function(G){var X=this;return this._setLocalDescription({type:"rollback"}).then(function(){return X._setLocalDescription(G)})},pe.prototype._setLocalDescription=function(G){var X=this;return"rollback"!==G.type&&this._shouldApplyDtx&&(G=new this._RTCSessionDescription({sdp:L(G.sdp),type:G.type})),this._peerConnection.setLocalDescription(G).catch(function(se){X._log.warn('Calling setLocalDescription with an RTCSessionDescription of type "'+G.type+'" failed with the error "'+se.message+'".',se);var ce=new $,he={message:'Calling setLocalDescription with an RTCSessionDescription of type "'+G.type+'" failed',code:ce.code,error:se};throw G.sdp&&(X._log.warn("The SDP was "+G.sdp),he.sdp=G.sdp),X._publishMediaWarning(he),ce}).then(function(){"rollback"!==G.type&&(X._localDescription=X._addOrRewriteLocalTrackIds(G),X._shouldApplyDtx&&(X._localDescription=new X._RTCSessionDescription({sdp:L(X._localDescription.sdp,[]),type:X._localDescription.type})),X._localCandidates=[],"offer"===G.type?X._descriptionRevision++:"answer"===G.type&&(X._lastStableDescriptionRevision=X._descriptionRevision,Fe(X)),X._localUfrag=ae(G),X.emit("description",X.getState()))})},pe.prototype._setRemoteDescription=function(G){var X=this;return G.sdp&&(G.sdp=this._setCodecPreferences(G.sdp,this._preferredAudioCodecs,this._preferredVideoCodecs),G.sdp=this._shouldApplyDtx?L(G.sdp):L(G.sdp,[]),we&&(G.sdp=function(ge){return ge.replace(/a=msid:[^ ]+ /g,"a=msid:- ")}(G.sdp)),this._peerConnection.remoteDescription||(this._isIceLite=/a=ice-lite/.test(G.sdp))),G=new this._RTCSessionDescription(G),Promise.resolve().then(function(){if("answer"===G.type&&X._localDescriptionWithoutSimulcast){var se=X._preferredVideoCodecs.find(function(Re){return"adaptiveSimulcast"in Re}),he=X._revertSimulcast(X._localDescription.sdp,X._localDescriptionWithoutSimulcast.sdp,G.sdp,!!se&&!1===se.adaptiveSimulcast);if(X._localDescriptionWithoutSimulcast=null,he!==X._localDescription.sdp)return X._rollbackAndApplyOffer({type:X._localDescription.type,sdp:he})}}).then(function(){return X._peerConnection.setRemoteDescription(G)}).then(function(){"answer"===G.type&&(X._isRestartingIce&&(X._log.debug("An ICE restart was in-progress and is now completed"),X._isRestartingIce=!1),Fe(X))},function(se){throw X._log.warn('Calling setRemoteDescription with an RTCSessionDescription of type "'+G.type+'" failed with the error "'+se.message+'".',se),G.sdp&&X._log.warn("The SDP was "+G.sdp),se})},pe.prototype._updateDescription=function(G){var X=this;switch(G.type){case"answer":case"pranswer":if(G.revision!==this._descriptionRevision||"have-local-offer"!==this._peerConnection.signalingState)return Promise.resolve();this._descriptionRevision=G.revision;break;case"close":return this._close();case"create-offer":return G.revision<=this._lastStableDescriptionRevision?Promise.resolve():this._needsAnswer?(this._queuedDescription=G,Promise.resolve()):(this._descriptionRevision=G.revision,this._offer());case"offer":return G.revision<=this._lastStableDescriptionRevision||"closed"===this._peerConnection.signalingState?Promise.resolve():"have-local-offer"===this._peerConnection.signalingState?this._needsAnswer&&0===this._lastStableDescriptionRevision?(this._queuedDescription=G,Promise.resolve()):(this._descriptionRevision=G.revision,this._handleGlare(G)):(this._descriptionRevision=G.revision,this._answer(G).then(function(){}))}var se=G.revision;return Promise.resolve().then(function(){return X._setRemoteDescription(G)}).catch(function(ce){var he=new V;throw X._publishMediaWarning({message:'Calling setRemoteDescription with an RTCSessionDescription of type "'+G.type+'" failed',code:he.code,error:ce,sdp:G.sdp}),he}).then(function(){return X._lastStableDescriptionRevision=se,X._needsAnswer=!1,X._checkIceBox(G)}).then(function(){return X._queuedDescription&&X._updateDescription(X._queuedDescription)}).then(function(){return X._queuedDescription=null,X._maybeReoffer(X._peerConnection.localDescription).then(function(){})})},pe.prototype._updateIce=function(G){var X=this._remoteCandidates.update(G);return this._addIceCandidates(X)},pe.prototype.addDataTrackSender=function(G){if(!this._dataChannels.has(G))try{var X={ordered:G.ordered};null!==G.maxPacketLifeTime&&(X.maxPacketLifeTime=G.maxPacketLifeTime),null!==G.maxRetransmits&&(X.maxRetransmits=G.maxRetransmits);var se=this._peerConnection.createDataChannel(G.id,X);G.addDataChannel(se),this._dataChannels.set(G,se)}catch(ce){this._log.warn('Error creating an RTCDataChannel for DataTrack "'+G.id+'": '+ce.message)}},pe.prototype._handleQueuedPublisherHints=function(){var G=this;"stable"===this._peerConnection.signalingState&&this._mediaTrackSenderToPublisherHints.forEach(function(X,se){var ce=X.deferred,he=X.encodings;G._mediaTrackSenderToPublisherHints.delete(se),G._setPublisherHint(se,he).then(function(Re){return ce.resolve(Re)}).catch(function(Re){return ce.reject(Re)})})},pe.prototype._setPublisherHint=function(G,X){var se=this;if(we)return Promise.resolve("COULD_NOT_APPLY_HINT");this._mediaTrackSenderToPublisherHints.has(G)&&(this._mediaTrackSenderToPublisherHints.get(G).deferred.resolve("REQUEST_SKIPPED"),this._mediaTrackSenderToPublisherHints.delete(G));var he=this._rtpSenders.get(G);if(!he)return this._log.warn("Could not apply publisher hint because RTCRtpSender was not found"),Promise.resolve("UNKNOWN_TRACK");if("closed"===this._peerConnection.signalingState)return this._log.warn('Could not apply publisher hint because signalingState was "closed"'),Promise.resolve("COULD_NOT_APPLY_HINT");if("stable"!==this._peerConnection.signalingState){this._log.debug("Queuing up publisher hint because signalingState:",this._peerConnection.signalingState);var Re=F();return this._mediaTrackSenderToPublisherHints.set(G,{deferred:Re,encodings:X}),Re.promise}var De=he.getParameters();return null!==X&&X.forEach(function(We){var He=We.enabled,Ie=We.layer_index;De.encodings.length>Ie?(se._log.debug("layer:"+Ie+", active:"+De.encodings[Ie].active+" => "+He),De.encodings[Ie].active=He):se._log.warn("invalid layer:"+Ie+", active:"+He)}),this._maybeUpdateEncodings(he.track,De.encodings,null===X),he.setParameters(De).then(function(){return"OK"}).catch(function(We){return se._log.error("Failed to apply publisher hints:",We),"COULD_NOT_APPLY_HINT"})},pe.prototype.addMediaTrackSender=function(G){var X=this;if("closed"!==this._peerConnection.signalingState&&!this._rtpSenders.has(G)){var ce=this._addOrUpdateTransceiver(G.track).sender;G.addSender(ce,function(he){return X._setPublisherHint(G,he)}),this._rtpNewSenders.add(ce),this._rtpSenders.set(G,ce)}},pe.prototype.close=function(){this._close()&&(this._descriptionRevision++,this._localDescription={type:"close"},this.emit("description",this.getState()))},pe.prototype.getTrackReceivers=function(){return Array.from(this._dataTrackReceivers).concat(Array.from(this._mediaTrackReceivers))},pe.prototype.getState=function(){if(!this._localDescription)return null;var X={type:this._localDescription.type,revision:"answer"===this._localDescription.type?this._lastStableDescriptionRevision:this._descriptionRevision};return this._localDescription.sdp&&(X.sdp=this._localDescription.sdp),{description:X,id:this.id}},pe.prototype.offer=function(){var G=this;return this._needsAnswer||this._isRestartingIce?(this._shouldOffer=!0,Promise.resolve()):this.bracket("offering",function(X){return G.transition("updating",X),(G._needsAnswer||G._isRestartingIce?Promise.resolve():G._offer()).then(function(){G.tryTransition("open",X)},function(ce){throw G.tryTransition("open",X),ce})})},pe.prototype.removeDataTrackSender=function(G){var X=this._dataChannels.get(G);X&&(G.removeDataChannel(X),this._dataChannels.delete(G),X.close())},pe.prototype.removeMediaTrackSender=function(G){var X=this._rtpSenders.get(G);X&&("closed"!==this._peerConnection.signalingState&&this._peerConnection.removeTrack(X),G.removeSender(X),this._mediaTrackSenderToPublisherHints.has(G)&&(this._mediaTrackSenderToPublisherHints.get(G).deferred.resolve("UNKNOWN_TRACK"),this._mediaTrackSenderToPublisherHints.delete(G)),this._rtpNewSenders.delete(X),this._rtpSenders.delete(G))},pe.prototype.setConfiguration=function(G){"function"==typeof this._peerConnection.setConfiguration&&this._peerConnection.setConfiguration(H(G))},pe.prototype.setIceReconnectTimeout=function(G){return this._iceReconnectTimeout.setDelay(G),this._log.debug("Updated ICE reconnection timeout period:",this._iceReconnectTimeout.delay),this},pe.prototype.update=function(G){var X=this;return this.bracket("updating",function(se){if("closed"===X.state)return Promise.resolve();X.transition("updating",se);var ce=[];return G.ice&&ce.push(X._updateIce(G.ice)),G.description&&ce.push(X._updateDescription(G.description)),Promise.all(ce).then(function(){X.tryTransition("open",se)},function(he){throw X.tryTransition("open",se),he})})},pe.prototype.getStats=function(){var G=this;return n(this._peerConnection).then(function(X){return function(ge,pe){return Object.assign(pe,{remoteAudioTrackStats:pe.remoteAudioTrackStats.map(function(G){return Z(ge,G)}),remoteVideoTrackStats:pe.remoteVideoTrackStats.map(function(G){return Z(ge,G)}),localAudioTrackStats:pe.localAudioTrackStats.map(function(G){return ue(ge,G)}),localVideoTrackStats:pe.localVideoTrackStats.map(function(G){return ue(ge,G)})})}(G,X)})},pe}(re);function ue(ge,pe){var G=ge._getMediaTrackSenderId(pe.trackId);return Object.assign(pe,{trackId:G})}function Z(ge,pe){var G=o([],h(ge._mediaTrackReceivers)).find(function(se){return se.track.id===pe.trackId});return Object.assign(pe,{trackId:G?G.id:null})}function ae(ge){if(ge.sdp){var pe=ge.sdp.match(/^a=ice-ufrag:([a-zA-Z0-9+/]+)/m);if(pe)return pe[1]}return null}function H(ge){return Object.assign({bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},ge)}function D(ge,pe){var G=pe.track;return G&&G.kind===ge&&"ended"!==G.readyState}function Fe(ge){(function(ge){ge._recycledTransceivers.audio=[],ge._recycledTransceivers.video=[],ge._peerConnection.getTransceivers().forEach(function(pe){(function(ge,pe){return!ge.stopped&&!pe._replaceTrackPromises.has(ge)&&["inactive","recvonly"].includes(ge.direction)})(pe,ge)&&ge._recycledTransceivers[pe.receiver.track.kind].push(pe)})})(ge),function(ge){var pe=ge._peerConnection.localDescription;!pe||!pe.sdp||E(pe.sdp).forEach(function(G){A(G).forEach(function(se,ce){return ge._localCodecs.add(ce)})})}(ge),function(ge){var pe=ge._peerConnection.remoteDescription;!pe||!pe.sdp||E(pe.sdp).forEach(function(G){var X=G.match(/^a=mid:(.+)$/m);if(X&&X[1]){var se=X[1],ce=A(G);ge._remoteCodecMaps.set(se,ce)}})}(ge),Ve(ge).then(function(){ge._handleQueuedPublisherHints()})}function Ve(ge){var pe=ge._encodingParameters,se=new Map([["audio",pe.maxAudioBitrate],["video",pe.maxVideoBitrate]]),ce=[];return ge._peerConnection.getSenders().filter(function(he){return he.track}).forEach(function(he){var Re=se.get(he.track.kind),De=he.getParameters();null===Re||0===Re?function(ge){Array.isArray(ge.encodings)&&ge.encodings.forEach(function(pe){return delete pe.maxBitrate})}(De):ge._isChromeScreenShareTrack(he.track)?ge._log.warn("Not setting maxBitrate for "+he.track.kind+" Track "+he.track.id+" because it appears to be screen share track: "+he.track.label):function(ge,pe){we?ge.encodings=[{maxBitrate:pe}]:ge.encodings.forEach(function(G){G.maxBitrate=pe})}(De,Re),!we&&ge._enableDscp&&De.encodings.length>0&&(De.encodings[0].networkPriority="high");var We=ge._rtpNewSenders.has(he);ge._maybeUpdateEncodings(he.track,De.encodings,We),ge._rtpNewSenders.delete(he);var He=he.setParameters(De).catch(function(Ie){ge._log.warn("Error while setting encodings parameters for "+he.track.kind+" Track "+he.track.id+": "+(Ie.message||Ie.name))});ce.push(He)}),Promise.all(ce)}C.exports=Oe},5971:function(C,w,a){"use strict";var E,p=this&&this.__extends||(E=function(S,T){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,M){x.__proto__=M}||function(x,M){for(var N in M)Object.prototype.hasOwnProperty.call(M,N)&&(x[N]=M[N])})(S,T)},function(S,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function x(){this.constructor=S}E(S,T),S.prototype=null===T?Object.create(T):(x.prototype=T.prototype,new x)}),h=this&&this.__read||function(E,S){var T="function"==typeof Symbol&&E[Symbol.iterator];if(!T)return E;var M,j,x=T.call(E),N=[];try{for(;(void 0===S||S-- >0)&&!(M=x.next()).done;)N.push(M.value)}catch($){j={error:$}}finally{try{M&&!M.done&&(T=x.return)&&T.call(x)}finally{if(j)throw j.error}}return N},o=this&&this.__spreadArray||function(E,S){for(var T=0,x=S.length,M=E.length;T<x;T++,M++)E[M]=S[T];return E},s=a(4911).guessBrowser,i=a(4556),t=a(5550),e=a(5468),r=a(3761),n=a(7061).MediaConnectionError,l="firefox"===s(),y=function(E){function S(T,x,M){var N=E.call(this)||this,j=(M=Object.assign({audioContextFactory:l?a(9057):null,PeerConnectionV2:i},M)).audioContextFactory?M.audioContextFactory.getOrCreate(N):null,$=j?{offerToReceiveVideo:!0}:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};return Object.defineProperties(N,{_audioContextFactory:{value:M.audioContextFactory},_closedPeerConnectionIds:{value:new Set},_configuration:{writable:!0,value:null},_configurationDeferred:{writable:!0,value:r.defer()},_connectionState:{value:"new",writable:!0},_dummyAudioTrackSender:{value:j?new t(_(j)):null},_encodingParameters:{value:T},_iceConnectionState:{writable:!0,value:"new"},_dataTrackSenders:{writable:!0,value:new Set},_lastConnectionState:{value:"new",writable:!0},_lastIceConnectionState:{writable:!0,value:"new"},_mediaTrackSenders:{writable:!0,value:new Set},_offerOptions:{value:$},_peerConnections:{value:new Map},_preferredCodecs:{value:x},_sessionTimeout:{value:null,writable:!0},_PeerConnectionV2:{value:M.PeerConnectionV2}}),N}return p(S,E),S.prototype.setEffectiveAdaptiveSimulcast=function(T){this._peerConnections.forEach(function(x){return x.setEffectiveAdaptiveSimulcast(T)}),this._preferredCodecs.video.forEach(function(x){"adaptiveSimulcast"in x&&(x.adaptiveSimulcast=T)})},Object.defineProperty(S.prototype,"connectionState",{get:function(){return this._connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"iceConnectionState",{get:function(){return this._iceConnectionState},enumerable:!1,configurable:!0}),S.prototype._closeAbsentPeerConnections=function(T){var x=new Set(T.map(function(M){return M.id}));return this._peerConnections.forEach(function(M){x.has(M.id)||M._close()}),this},S.prototype._getConfiguration=function(){return this._configurationDeferred.promise},S.prototype._getOrCreate=function(T,x){var M=this,N=this,j=this._peerConnections.get(T);if(!j){var $=this._PeerConnectionV2,V=Object.assign({dummyAudioMediaStreamTrack:this._dummyAudioTrackSender?this._dummyAudioTrackSender.track:null,offerOptions:this._offerOptions},this._sessionTimeout?{sessionTimeout:this._sessionTimeout}:{},x);try{j=new $(T,this._encodingParameters,this._preferredCodecs,V)}catch(B){throw new n}this._peerConnections.set(j.id,j),j.on("candidates",this.queue.bind(this,"candidates")),j.on("description",this.queue.bind(this,"description")),j.on("trackAdded",this.queue.bind(this,"trackAdded")),j.on("stateChanged",function B(ee){"closed"===ee&&(j.removeListener("stateChanged",B),N._dataTrackSenders.forEach(function(ne){return j.removeDataTrackSender(ne)}),N._mediaTrackSenders.forEach(function(ne){return j.removeMediaTrackSender(ne)}),N._peerConnections.delete(j.id),N._closedPeerConnectionIds.add(j.id),R(N),L(N))}),j.on("connectionStateChanged",function(){return R(M)}),j.on("iceConnectionStateChanged",function(){return L(M)}),this._dataTrackSenders.forEach(j.addDataTrackSender,j),this._mediaTrackSenders.forEach(j.addMediaTrackSender,j),L(this)}return j},S.prototype.close=function(){return this._peerConnections.forEach(function(T){T.close()}),this._dummyAudioTrackSender&&this._dummyAudioTrackSender.stop(),this._audioContextFactory&&this._audioContextFactory.release(this),L(this),this},S.prototype.createAndOffer=function(){var T=this;return this._getConfiguration().then(function(x){var M;do{M=r.makeUUID()}while(T._peerConnections.has(M));return T._getOrCreate(M,x)}).then(function(x){return x.offer()}).then(function(){return T})},S.prototype.getTrackReceivers=function(){return r.flatMap(this._peerConnections,function(T){return T.getTrackReceivers()})},S.prototype.getStates=function(){var T=[];return this._peerConnections.forEach(function(x){var M=x.getState();M&&T.push(M)}),T},S.prototype.setConfiguration=function(T){return this._configuration&&(this._configurationDeferred=r.defer(),this._peerConnections.forEach(function(x){x.setConfiguration(T)})),this._configuration=T,this._configurationDeferred.resolve(T),this},S.prototype.setIceReconnectTimeout=function(T){return null===this._sessionTimeout&&(this._peerConnections.forEach(function(x){x.setIceReconnectTimeout(T)}),this._sessionTimeout=T),this},S.prototype.setTrackSenders=function(T){var x=new Set(T.filter(function(j){return"data"===j.kind})),M=new Set(T.filter(function(j){return j&&("audio"===j.kind||"video"===j.kind)})),N=function(E,S,T){return{data:f(E,S),media:c(E,T)}}(this,x,M);return this._dataTrackSenders=x,this._mediaTrackSenders=M,function(E,S){(S.data.add.size||S.data.remove.size||S.media.add.size||S.media.remove.size)&&E._peerConnections.forEach(function(T){S.data.remove.forEach(T.removeDataTrackSender,T),S.media.remove.forEach(T.removeMediaTrackSender,T),S.data.add.forEach(T.addDataTrackSender,T),S.media.add.forEach(T.addMediaTrackSender,T),(S.media.add.size||S.media.remove.size||S.data.add.size&&!T.isApplicationSectionNegotiated)&&T.offer()})}(this,N),this},S.prototype.update=function(T,x){var M=this;return void 0===x&&(x=!1),x&&this._closeAbsentPeerConnections(T),this._getConfiguration().then(function(N){return Promise.all(T.map(function(j){return M._closedPeerConnectionIds.has(j.id)?null:M._getOrCreate(j.id,N).update(j)}))}).then(function(){return M})},S.prototype.getStats=function(){var T=Array.from(this._peerConnections.values());return Promise.all(T.map(function(x){return x.getStats().then(function(M){return[x.id,M]})})).then(function(x){return new Map(x)})},S}(e);function _(E){return E.createMediaStreamDestination().stream.getAudioTracks()[0]}function f(E,S){return{add:r.difference(S,E._dataTrackSenders),remove:r.difference(E._dataTrackSenders,S)}}function c(E,S){return{add:r.difference(S,E._mediaTrackSenders),remove:r.difference(E._mediaTrackSenders,S)}}var g,v={new:0,checking:1,connecting:2,connected:3,completed:4,disconnected:-1,failed:-2,closed:-3};function P(E){return E.length?(g=g||Object.keys(v).reduce(function(E,S){var T;return Object.assign(E,((T={})[v[S]]=S,T))},{}),E.reduce(function(S,T){return g[Math.max(v[S],v[T])]})):"new"}function L(E){E._lastIceConnectionState=E.iceConnectionState,E._iceConnectionState=P(o([],h(E._peerConnections.values())).map(function(S){return S.iceConnectionState})),E.iceConnectionState!==E._lastIceConnectionState&&E.emit("iceConnectionStateChanged")}function R(E){E._lastConnectionState=E.connectionState,E._connectionState=P(o([],h(E._peerConnections.values())).map(function(S){return S.connectionState})),E.connectionState!==E._lastConnectionState&&E.emit("connectionStateChanged")}C.exports=y},4574:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(762),o=1,s=function(i){function t(e,r){var n=i.call(this,e,"publisher_hints",r)||this;return n.on("ready",function(l){n._log.debug("publisher_hints transport ready:",l),l.on("message",function(y){switch(n._log.debug("Incoming: ",y),y.type){case"publisher_hints":y.publisher&&y.publisher.hints&&y.publisher.id&&n._processPublisherHints(y.publisher.hints,y.publisher.id);break;default:n._log.warn("Unknown message type: ",y.type)}})}),n}return p(t,i),t.prototype.sendTrackReplaced=function(e){if(this._transport){var n={type:"client_reset",track:e.trackSid,id:o++};this._log.debug("Outgoing: ",n),this._transport.publish(n)}},t.prototype.sendHintResponse=function(e){if(this._transport){var l={type:"publisher_hints",id:e.id,hints:e.hints};this._log.debug("Outgoing: ",l),this._transport.publish(l)}},t.prototype._processPublisherHints=function(e,r){try{this.emit("updated",e,r)}catch(n){this._log.error("error processing hints:",n)}},t}(h);C.exports=s},5117:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(){var t=s.call(this)||this;return Object.defineProperties(t,{_revision:{value:1,writable:!0}}),t}return p(i,s),i.prototype.update=function(t){return t.revision<this._revision?this:(this._revision=t.revision,this.enable(t.is_recording))},i}(a(8659));C.exports=o},5097:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(8760),o=a(3038),s=function(i){function t(e,r,n,l,y,_){var b=i.call(this,e.sid,e.identity)||this;return _=Object.assign({RemoteTrackPublicationV2:o},_),Object.defineProperties(b,{_revision:{writable:!0,value:null},_RemoteTrackPublicationV2:{value:_.RemoteTrackPublicationV2},_getInitialTrackSwitchOffState:{value:r},updateSubscriberTrackPriority:{value:function(f,u){return n(f,u)}},updateTrackRenderHint:{value:function(f,u){return l(f,u)}},clearTrackHint:{value:function(f){return y(f)}},revision:{enumerable:!0,get:function(){return this._revision}}}),b.update(e)}return p(t,i),t.prototype._getOrCreateTrack=function(e){var r=this._RemoteTrackPublicationV2,n=this.tracks.get(e.sid);return n||(n=new r(e,this._getInitialTrackSwitchOffState(e.sid)),this.addTrack(n)),n},t.prototype.update=function(e){var r=this;if(null!==this.revision&&e.revision<=this.revision)return this;this._revision=e.revision;var n=new Set;switch(e.tracks.forEach(function(l){var y=r._getOrCreateTrack(l);y.update(l),n.add(y)}),this.tracks.forEach(function(l){n.has(l)||r.removeTrack(l)}),e.state){case"disconnected":this.disconnect();break;case"reconnecting":this.reconnecting();break;case"connected":this.connect(this.sid,this.identity)}return this},t}(h);C.exports=s},3038:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){return s.call(this,t.sid,t.name,t.kind,t.enabled,t.priority,e)||this}return p(i,s),i.prototype.update=function(t){return this.enable(t.enabled),this.setPriority(t.priority),this},i}(a(2261));C.exports=o},9752:function(C,w,a){"use strict";var r,p=this&&this.__extends||(r=function(n,l){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,_){y.__proto__=_}||function(y,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(y[b]=_[b])})(n,l)},function(n,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function y(){this.constructor=n}r(n,l),n.prototype=null===l?Object.create(l):(y.prototype=l.prototype,new y)}),h=a(762),o=a(1190),s=a(3761).isDeepEqual,t=1,e=function(r){function n(l,y){var _=r.call(this,l,"render_hints",y)||this;return Object.defineProperties(_,{_trackSidsToRenderHints:{value:new Map},_responseTimer:{value:new o(function(){_._sendAllHints(),_._responseTimer.setDelay(2*_._responseTimer.delay)},2e3,!1)}}),_.on("ready",function(b){b.on("message",function(f){switch(_._log.debug("Incoming: ",f),f.type){case"render_hints":_._processHintResults(f&&f.subscriber&&f.subscriber.hints||[]);break;default:_._log.warn("Unknown message type: ",f.type)}}),_._sendAllHints()}),_}return p(n,r),n.prototype._sendAllHints=function(){var l=this;Array.from(this._trackSidsToRenderHints.keys()).forEach(function(y){var _=l._trackSidsToRenderHints.get(y);_.renderDimensions&&(_.isDimensionDirty=!0),"enabled"in _&&(_.isEnabledDirty=!0)}),this._sendHints()},n.prototype._processHintResults=function(l){var y=this;this._responseTimer.clear(),this._responseTimer.setDelay(2e3),l.forEach(function(_){"OK"!==_.result&&y._log.debug("Server error processing hint:",_)}),this._sendHints()},n.prototype._sendHints=function(){var l=this;if(this._transport&&!this._responseTimer.isSet){var y=[];if(Array.from(this._trackSidsToRenderHints.keys()).forEach(function(b){var f=l._trackSidsToRenderHints.get(b);if(f.isEnabledDirty||f.isDimensionDirty){var u={track:b};f.isEnabledDirty&&(u.enabled=f.enabled,f.isEnabledDirty=!1),f.isDimensionDirty&&(u.render_dimensions=f.renderDimensions,f.isDimensionDirty=!1),y.push(u)}}),y.length>0){var _={type:"render_hints",subscriber:{id:t++,hints:y}};this._log.debug("Outgoing: ",_),this._transport.publish(_),this._responseTimer.start()}}},n.prototype.setTrackHint=function(l,y){var _=this._trackSidsToRenderHints.get(l)||{isEnabledDirty:!1,isDimensionDirty:!1};"enabled"in y&&_.enabled!==y.enabled&&(_.enabled=!!y.enabled,_.isEnabledDirty=!0),y.renderDimensions&&!s(y.renderDimensions,_.renderDimensions)&&(_.renderDimensions=y.renderDimensions,_.isDimensionDirty=!0),this._trackSidsToRenderHints.set(l,_),this._sendHints()},n.prototype.clearTrackHint=function(l){this._trackSidsToRenderHints.delete(l)},n}(h);C.exports=e},3899:function(C,w,a){"use strict";var F,p=this&&this.__extends||(F=function(O,k){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,K){U.__proto__=K}||function(U,K){for(var re in K)Object.prototype.hasOwnProperty.call(K,re)&&(U[re]=K[re])})(O,k)},function(O,k){if("function"!=typeof k&&null!==k)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function U(){this.constructor=O}F(O,k),O.prototype=null===k?Object.create(k):(U.prototype=k.prototype,new U)}),h=this&&this.__read||function(F,O){var k="function"==typeof Symbol&&F[Symbol.iterator];if(!k)return F;var K,J,U=k.call(F),re=[];try{for(;(void 0===O||O-- >0)&&!(K=U.next()).done;)re.push(K.value)}catch(q){J={error:q}}finally{try{K&&!K.done&&(k=U.return)&&k.call(U)}finally{if(J)throw J.error}}return re},o=a(2222),s=a(8804),i=a(1159),t=a(5117),e=a(6996),r=a(5097),n=a(6614),l=a(7960),y=a(5084),_=a(9752),b=a(4574),f=a(3761),u=f.constants.DEFAULT_SESSION_TIMEOUT_SEC,c=f.createBandwidthProfilePayload,v=f.defer,g=f.difference,A=f.filterObject,P=f.flatMap,L=f.oncePerTick,R=a(2100),E=a(7061).createTwilioError,T=function(F){function O(k,U,K,re,J){var q=this;U.options=Object.assign({session_timeout:u},U.options),J=Object.assign({DominantSpeakerSignaling:o,NetworkQualityMonitor:s,NetworkQualitySignaling:i,RecordingSignaling:t,RemoteParticipantV2:r,TrackPrioritySignaling:l,TrackSwitchOffSignaling:y,bandwidthProfile:null,sessionTimeout:1e3*U.options.session_timeout,statsPublishIntervalMs:1e4},J),k.setBandwidthProfile(J.bandwidthProfile),re.setIceReconnectTimeout(J.sessionTimeout);var le=function(_e){return q._getTrackReceiver(_e)},ve=(q=F.call(this,k,U.sid,U.name,J)||this)._log;return Object.defineProperties(q,{_disconnectedParticipantRevisions:{value:new Map},_NetworkQualityMonitor:{value:J.NetworkQualityMonitor},_lastBandwidthProfileRevision:{value:k.bandwidthProfileRevision,writable:!0},_networkQualityMonitor:{value:null,writable:!0},_networkQualityConfiguration:{value:k.networkQualityConfiguration},_peerConnectionManager:{value:re},_published:{value:new Map},_publishedRevision:{value:0,writable:!0},_RemoteParticipantV2:{value:J.RemoteParticipantV2},_subscribed:{value:new Map},_subscribedRevision:{value:0,writable:!0},_subscriptionFailures:{value:new Map},_dominantSpeakerSignaling:{value:new J.DominantSpeakerSignaling(le,{log:ve})},_networkQualitySignaling:{value:new J.NetworkQualitySignaling(le,k.networkQualityConfiguration,{log:ve})},_renderHintsSignaling:{value:new _(le,{log:ve})},_publisherHintsSignaling:{value:new b(le,{log:ve})},_trackPrioritySignaling:{value:new J.TrackPrioritySignaling(le,{log:ve})},_trackSwitchOffSignaling:{value:new J.TrackSwitchOffSignaling(le,{log:ve})},_pendingSwitchOffStates:{value:new Map},_transport:{value:K},_trackReceiverDeferreds:{value:new Map},mediaRegion:{enumerable:!0,value:U.options.media_region||null}}),q._initTrackSwitchOffSignaling(),q._initDominantSpeakerSignaling(),q._initNetworkQualityMonitorSignaling(),q._initPublisherHintSignaling(),function(F,O){var k=L(function(){F._publishNewLocalParticipantState()}),U=L(function(){var K=P(O.tracks,function(re){return re.trackTransceiver});F._peerConnectionManager.setTrackSenders(K)});O.on("trackAdded",U),O.on("trackRemoved",U),O.on("updated",k),F.on("stateChanged",function K(re){"disconnected"===re&&(O.removeListener("trackAdded",U),O.removeListener("trackRemoved",U),O.removeListener("updated",k),F.removeListener("stateChanged",K),O.disconnect())}),F.on("signalingConnectionStateChanged",function(){var K=F.localParticipant,J=K.identity,q=K.sid;switch(F.signalingConnectionState){case"connected":K.connect(q,J);break;case"reconnecting":K.reconnecting()}})}(q,k),function(F,O){O.on("description",function(U){F._publishPeerConnectionState(U)}),O.dequeue("description"),O.on("candidates",function(U){F._publishPeerConnectionState(U)}),O.dequeue("candidates"),O.on("trackAdded",F._addTrackReceiver.bind(F)),O.dequeue("trackAdded"),O.getTrackReceivers().forEach(F._addTrackReceiver,F),O.on("connectionStateChanged",function(){F.emit("connectionStateChanged")}),O.on("iceConnectionStateChanged",function(){F.emit("iceConnectionStateChanged"),"failed"===F.iceConnectionState&&(null!==F.localParticipant.networkQualityLevel&&F.localParticipant.setNetworkQualityLevel(0),F.participants.forEach(function(k){null!==k.networkQualityLevel&&k.setNetworkQualityLevel(0)}))})}(q,re),function(F,O){O.on("message",F._update.bind(F)),O.on("stateChanged",function k(U,K){"disconnected"===U&&("disconnected"!==F.state&&F._disconnect(K),O.removeListener("stateChanged",k)),F.emit("signalingConnectionStateChanged")})}(q,K),function(F,O,k){var U=new Map,K=!1,re=setInterval(function(){F.getStats().then(function(J){K=!K,J.forEach(function(q,le){var ve=new n(le,q,!0);O.publishEvent("quality","stats-report","info",{audioTrackStats:ve.remoteAudioTrackStats.map(function(we,Se){return te(we,q.remoteAudioTrackStats[Se],U)}),localAudioTrackStats:ve.localAudioTrackStats.map(function(we,Se){return ne(we,q.localAudioTrackStats[Se],U)}),localVideoTrackStats:ve.localVideoTrackStats.map(function(we,Se){return ne(we,q.localVideoTrackStats[Se],U)}),peerConnectionId:ve.peerConnectionId,videoTrackStats:ve.remoteVideoTrackStats.map(function(we,Se){return te(we,q.remoteVideoTrackStats[Se],U)})});var _e=P(["localAudioTrackStats","localVideoTrackStats","remoteAudioTrackStats","remoteVideoTrackStats"],function(we){return ve[we].map(function(Se){return Se.trackSid+"+"+Se.ssrc})});if(g(Array.from(U.keys()),_e).forEach(function(we){return U.delete(we)}),K){var be=function(F,O){return(F=Object.assign({availableIncomingBitrate:0,availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,lastPacketReceivedTimestamp:0,lastPacketSentTimestamp:0,nominated:!1,peerConnectionId:O,priority:0,readable:!1,requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,retransmissionsReceived:0,retransmissionsSent:0,state:"failed",totalRoundTripTime:0,transportId:"",writable:!1},A(F||{},null))).localCandidate=Object.assign({candidateType:"host",deleted:!1,ip:"",port:0,priority:0,protocol:"udp",url:""},A(F.localCandidate||{},null)),F.remoteCandidate=Object.assign({candidateType:"host",ip:"",port:0,priority:0,protocol:"udp",url:""},A(F.remoteCandidate||{},null)),F}(q.activeIceCandidatePair,ve.peerConnectionId);O.publishEvent("quality","active-ice-candidate-pair","info",be)}})},function(){})},k);F.on("stateChanged",function J(q){"disconnected"===q&&(clearInterval(re),F.removeListener("stateChanged",J))})}(q,K,J.statsPublishIntervalMs),q._update(U),q._peerConnectionManager.setEffectiveAdaptiveSimulcast(q._publisherHintsSignaling.isSetup),q}return p(O,F),Object.defineProperty(O.prototype,"connectionState",{get:function(){return this._peerConnectionManager.connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"signalingConnectionState",{get:function(){return"syncing"===this._transport.state?"reconnecting":this._transport.state},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"iceConnectionState",{get:function(){return this._peerConnectionManager.iceConnectionState},enumerable:!1,configurable:!0}),O.prototype._deleteTrackReceiverDeferred=function(k){return this._trackReceiverDeferreds.delete(k)},O.prototype._getOrCreateTrackReceiverDeferred=function(k){var U=this._trackReceiverDeferreds.get(k)||v(),re=this._peerConnectionManager.getTrackReceivers().find(function(J){return J.id===k&&"ended"!==J.readyState});return re?U.resolve(re):this._trackReceiverDeferreds.set(k,U),U},O.prototype._addTrackReceiver=function(k){return this._getOrCreateTrackReceiverDeferred(k.id).resolve(k),this},O.prototype._disconnect=function(k){var U=F.prototype._disconnect.call(this,k);return U&&(this._teardownNetworkQualityMonitor(),this._transport.disconnect(),this._peerConnectionManager.close()),this.localParticipant.tracks.forEach(function(K){K.publishFailed(k||new Error("LocalParticipant disconnected"))}),U},O.prototype._getTrackReceiver=function(k){var U=this;return this._getOrCreateTrackReceiverDeferred(k).promise.then(function(K){return U._deleteTrackReceiverDeferred(k),K})},O.prototype._getInitialTrackSwitchOffState=function(k){var U=this._pendingSwitchOffStates.get(k)||!1;return this._pendingSwitchOffStates.delete(k),U&&this._log.warn("["+k+"] was initially switched off! "),U},O.prototype._getTrackSidsToTrackSignalings=function(){var k=P(this.participants,function(U){return Array.from(U.tracks)});return new Map(k)},O.prototype._getOrCreateRemoteParticipant=function(k){var U=this,K=this._RemoteParticipantV2,re=this.participants.get(k.sid),J=this;return re||((re=new K(k,function(q){return U._getInitialTrackSwitchOffState(q)},function(q,le){return U._trackPrioritySignaling.sendTrackPriorityUpdate(q,"subscribe",le)},function(q,le){return U._renderHintsSignaling.setTrackHint(q,le)},function(q){return U._renderHintsSignaling.clearTrackHint(q)})).on("stateChanged",function q(le){"disconnected"===le&&(re.removeListener("stateChanged",q),J.participants.delete(re.sid),J._disconnectedParticipantRevisions.set(re.sid,re.revision))}),this.connectParticipant(re)),re},O.prototype._getState=function(){return{participant:this.localParticipant.getState()}},O.prototype._maybeAddBandwidthProfile=function(k){var U=this.localParticipant,K=U.bandwidthProfile,re=U.bandwidthProfileRevision;return K&&this._lastBandwidthProfileRevision<re?(this._lastBandwidthProfileRevision=re,Object.assign({bandwidth_profile:c(K)},k)):k},O.prototype._publishNewLocalParticipantState=function(){this._transport.publish(this._maybeAddBandwidthProfile(this._getState()))},O.prototype._publishPeerConnectionState=function(k){this._transport.publish(Object.assign({peer_connections:[k]},this._getState()))},O.prototype._update=function(k){var U=this;if(k.subscribed&&k.subscribed.revision>this._subscribedRevision){this._subscribedRevision=k.subscribed.revision,k.subscribed.tracks.forEach(function(J){J.id?(U._subscriptionFailures.delete(J.sid),U._subscribed.set(J.sid,J.id)):J.error&&!U._subscriptionFailures.has(J.sid)&&U._subscriptionFailures.set(J.sid,J.error)});var K=new Set(k.subscribed.tracks.filter(function(J){return!!J.id}).map(function(J){return J.sid}));this._subscribed.forEach(function(J,q){K.has(q)||U._subscribed.delete(q)})}var re=new Set;return(k.participants||[]).forEach(function(J){if(J.sid!==U.localParticipant.sid){var q=U._disconnectedParticipantRevisions.get(J.sid);if(!(q&&J.revision<=q)){q&&U._disconnectedParticipantRevisions.delete(J.sid);var le=U._getOrCreateRemoteParticipant(J);le.update(J),re.add(le)}}}),"synced"===k.type&&this.participants.forEach(function(J){re.has(J)||J.disconnect()}),function(F){var O=F._getTrackSidsToTrackSignalings();F._subscriptionFailures.forEach(function(k,U){var K=O.get(U);K&&(F._subscriptionFailures.delete(U),K.subscribeFailed(E(k.code,k.message)))}),O.forEach(function(k){var U=F._subscribed.get(k.sid);(!U||k.isSubscribed&&k.trackTransceiver.id!==U)&&k.setTrackTransceiver(null),U&&F._getTrackReceiver(U).then(function(K){return k.setTrackTransceiver(K)})})}(this),k.peer_connections&&this._peerConnectionManager.update(k.peer_connections,"synced"===k.type),k.recording&&this.recording.update(k.recording),k.published&&k.published.revision>this._publishedRevision&&(this._publishedRevision=k.published.revision,k.published.tracks.forEach(function(J){J.sid&&U._published.set(J.id,J.sid)}),this.localParticipant.update(k.published)),k.participant&&this.localParticipant.connect(k.participant.sid,k.participant.identity),[this._dominantSpeakerSignaling,this._networkQualitySignaling,this._trackPrioritySignaling,this._trackSwitchOffSignaling,this._renderHintsSignaling,this._publisherHintsSignaling].forEach(function(J){var q=J.channel;!J.isSetup&&k.media_signaling&&k.media_signaling[q]&&k.media_signaling[q].transport&&"data-channel"===k.media_signaling[q].transport.type&&J.setup(k.media_signaling[q].transport.label)}),this},O.prototype._initPublisherHintSignaling=function(){var k=this;this._publisherHintsSignaling.on("updated",function(K,re){Promise.all(K.map(function(J){return k.localParticipant.setPublisherHint(J.track,J.encodings).then(function(q){return{track:J.track,result:q}})})).then(function(J){k._publisherHintsSignaling.sendHintResponse({id:re,hints:J})})});var U=function(K){"video"===K.kind&&K.trackTransceiver.on("replaced",function(){k._publisherHintsSignaling.sendTrackReplaced({trackSid:K.sid})})};Array.from(this.localParticipant.tracks.values()).forEach(function(K){return U(K)}),this.localParticipant.on("trackAdded",function(K){return U(K)})},O.prototype._initTrackSwitchOffSignaling=function(){var k=this;this._trackSwitchOffSignaling.on("updated",function(U,K){try{k._log.debug("received trackSwitch: ",{tracksOn:K,tracksOff:U});var re=new Map;K.forEach(function(J){return re.set(J,!0)}),U.forEach(function(J){re.get(J)&&k._log.warn(J+" is DUPLICATED in both tracksOff and tracksOn list"),re.set(J,!1)}),k.participants.forEach(function(J){J.tracks.forEach(function(q){var le=re.get(q.sid);void 0!==le&&(q.setSwitchedOff(!le),re.delete(q.sid))})}),re.forEach(function(J,q){return k._pendingSwitchOffStates.set(q,!J)})}catch(J){k._log.error("error processing track switch off:",J)}})},O.prototype._initDominantSpeakerSignaling=function(){var k=this;this._dominantSpeakerSignaling.on("updated",function(){return k.setDominantSpeaker(k._dominantSpeakerSignaling.loudestParticipantSid)})},O.prototype._initNetworkQualityMonitorSignaling=function(){var k=this;this._networkQualitySignaling.on("ready",function(){var U=new k._NetworkQualityMonitor(k._peerConnectionManager,k._networkQualitySignaling);k._networkQualityMonitor=U,U.on("updated",function(){"failed"!==k.iceConnectionState&&(k.localParticipant.setNetworkQualityLevel(U.level,U.levels),k.participants.forEach(function(K){var re=U.remoteLevels.get(K.sid);re&&K.setNetworkQualityLevel(re.level,re)}))}),U.start()}),this._networkQualitySignaling.on("teardown",function(){return k._teardownNetworkQualityMonitor()})},O.prototype._teardownNetworkQualityMonitor=function(){this._networkQualityMonitor&&(this._networkQualityMonitor.stop(),this._networkQualityMonitor=null)},O.prototype.getStats=function(){var k=this;return this._peerConnectionManager.getStats().then(function(U){return new Map(Array.from(U).map(function(K){var re=h(K,2),q=re[1];return[re[0],Object.assign({},q,{localAudioTrackStats:M(k,q.localAudioTrackStats),localVideoTrackStats:M(k,q.localVideoTrackStats),remoteAudioTrackStats:N(k,q.remoteAudioTrackStats),remoteVideoTrackStats:N(k,q.remoteVideoTrackStats)})]}))})},O}(e);function x(F,O){return O.reduce(function(k,U){var K=F.get(U.trackId);return K?[Object.assign({},U,{trackSid:K})].concat(k):k},[])}function M(F,O){return x(F._published,O)}function N(F,O){return x(new Map(Array.from(F._subscribed.entries()).map(function(U){var K=h(U,2);return[K[1],K[0]]})),O)}function ne(F,O,k){var U=O.framesEncoded,K=O.packetsSent,re=O.totalEncodeTime,J=O.totalPacketSendDelay,q=Object.assign({},F),le=F.trackSid+"+"+F.ssrc,ve=k.get(le)||new Map;if("number"==typeof re&&"number"==typeof U){var _e=ve.get("avgEncodeDelay")||new R;_e.putSample(1e3*re,U),q.avgEncodeDelay=Math.round(_e.get()),ve.set("avgEncodeDelay",_e)}if("number"==typeof J&&"number"==typeof K){var Pe=ve.get("avgPacketSendDelay")||new R;Pe.putSample(1e3*J,K),q.avgPacketSendDelay=Math.round(Pe.get()),ve.set("avgPacketSendDelay",Pe)}return k.set(le,ve),q}function te(F,O,k){var U=O.estimatedPlayoutTimestamp,K=O.framesDecoded,re=O.jitterBufferDelay,J=O.jitterBufferEmittedCount,q=O.totalDecodeTime,le=Object.assign({},F),ve=F.trackSid+"+"+F.ssrc,_e=k.get(ve)||new Map;if("number"==typeof U&&(le.estimatedPlayoutTimestamp=U),"number"==typeof K&&"number"==typeof q){var Pe=_e.get("avgDecodeDelay")||new R;Pe.putSample(1e3*q,K),le.avgDecodeDelay=Math.round(Pe.get()),_e.set("avgDecodeDelay",Pe)}if("number"==typeof re&&"number"==typeof J){var be=_e.get("avgJitterBufferDelay")||new R;be.putSample(1e3*re,J),le.avgJitterBufferDelay=Math.round(be.get()),_e.set("avgJitterBufferDelay",be)}return k.set(ve,_e),le}C.exports=T},7960:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,"track_priority",e)||this;return Object.defineProperties(r,{_enqueuedPriorityUpdates:{value:new Map}}),r.on("ready",function(n){Array.from(r._enqueuedPriorityUpdates.keys()).forEach(function(l){n.publish({type:"track_priority",track:l,subscribe:r._enqueuedPriorityUpdates.get(l)})})}),r}return p(i,s),i.prototype.sendTrackPriorityUpdate=function(t,e,r){if("subscribe"!==e)throw new Error("only subscribe priorities are supported, found: "+e);this._enqueuedPriorityUpdates.set(t,r),this._transport&&this._transport.publish({type:"track_priority",track:t,subscribe:r})},i}(a(762));C.exports=o},5084:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,"track_switch_off",e)||this;return r.on("ready",function(n){n.on("message",function(l){switch(l.type){case"track_switch_off":r._setTrackSwitchOffUpdates(l.off||[],l.on||[])}})}),r}return p(i,s),i.prototype._setTrackSwitchOffUpdates=function(t,e){this.emit("updated",t,e)},i}(a(762));C.exports=o},1328:function(C,w,a){"use strict";var j,p=this&&this.__extends||(j=function($,V){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,ee){B.__proto__=ee}||function(B,ee){for(var ne in ee)Object.prototype.hasOwnProperty.call(ee,ne)&&(B[ne]=ee[ne])})($,V)},function($,V){if("function"!=typeof V&&null!==V)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");function B(){this.constructor=$}j($,V),$.prototype=null===V?Object.create(V):(B.prototype=V.prototype,new B)}),h=a(1856),o=a(9616),s=a(4035),i=a(9917).reconnectBackoffConfig,t=a(1190),e=a(9917),r=e.SDK_NAME,n=e.SDK_VERSION,l=e.SDP_FORMAT,y=a(3761),_=y.createBandwidthProfilePayload,b=y.createMediaSignalingPayload,f=y.createSubscribePayload,u=y.getUserAgent,c=y.isNonArrayObject,v=a(7061),g=v.createTwilioError,A=v.RoomCompletedError,P=v.SignalingConnectionError,L=v.SignalingServerBusyError,S={connecting:["connected","disconnected"],connected:["disconnected","syncing"],syncing:["connected","disconnected"],disconnected:[]},T=function(j){function $(V,B,ee,ne,te,W){var F;return W=Object.assign({Backoff:s,TwilioConnection:o,iceServers:null,trackPriority:!0,trackSwitchOff:!0,renderHints:!0,userAgent:u()},W),F=j.call(this,"connecting",S)||this,Object.defineProperties(F,{_accessToken:{value:B},_automaticSubscription:{value:W.automaticSubscription},_bandwidthProfile:{value:W.bandwidthProfile},_dominantSpeaker:{value:W.dominantSpeaker},_adaptiveSimulcast:{value:W.adaptiveSimulcast},_eventObserver:{value:W.eventObserver,writable:!1},_renderHints:{value:W.renderHints},_iceServersStatus:{value:Array.isArray(W.iceServers)?"overrode":"acquire"},_localParticipant:{value:ee},_name:{value:V},_networkQuality:{value:c(W.networkQuality)||W.networkQuality},_options:{value:W},_peerConnectionManager:{value:ne},_sessionTimer:{value:null,writable:!0},_sessionTimeoutMS:{value:0,writable:!0},_reconnectBackoff:{value:W.Backoff.exponential(i)},_session:{value:null,writable:!0},_trackPriority:{value:W.trackPriority},_trackSwitchOff:{value:W.trackSwitchOff},_twilioConnection:{value:null,writable:!0},_updatesReceived:{value:[]},_updatesToSend:{value:[]},_userAgent:{value:W.userAgent},_wsServer:{value:te}}),function(j){function $(){if("disconnected"!==j.state){j._twilioConnection&&j._twilioConnection.removeListener("message",B);var O=j._options,K=O.TwilioConnection,re=new K(j._wsServer,Object.assign({helloBody:"connecting"===j.state&&"acquire"===j._iceServersStatus?j._createIceMessage():j._createConnectOrSyncOrDisconnectMessage()},O));re.once("close",function(J){J===K.CloseReason.LOCAL?V():V(new Error(J))}),re.on("message",B),j._twilioConnection=re}}function V(F){if("disconnected"!==j.state){if(!F)return void j.disconnect();var O=j._getReconnectTimer();if(!O){var k=F.message===o.CloseReason.BUSY?new L:new P;return void j.disconnect(k)}"connected"===j.state&&j.preempt("syncing"),O.then($)}}function B(F){if("disconnected"!==j.state){if("error"===F.type)return void j.disconnect(g(F.code,F.message));switch(j.state){case"connected":switch(F.type){case"connected":case"synced":case"update":return void j.emit("message",F);case"disconnected":return void j.disconnect("completed"===F.status?new A:null);default:return}case"connecting":switch(F.type){case"iced":return void j._options.onIced(F.ice_servers).then(function(){j._sendConnectOrSyncOrDisconnectMessage()});case"connected":return j._setSession(F.session,F.options.session_timeout),j.emit("connected",F),void j.preempt("connected");case"synced":case"update":return void j._updatesReceived.push(F);case"disconnected":return void j.disconnect("completed"===F.status?new A:null);default:return}case"syncing":switch(F.type){case"connected":case"update":return void j._updatesReceived.push(F);case"synced":return j._clearReconnectTimer(),j.emit("message",F),void j.preempt("connected");case"disconnected":return void j.disconnect("completed"===F.status?new A:null);default:return}default:return}}}j.on("stateChanged",function F(O){switch(O){case"connected":var k=j._updatesToSend.splice(0);return k.length&&j.publish(function(j){return j.reduce(function($,V){return(!$.participant&&V.participant||$.participant&&V.participant&&V.participant.revision>$.participant.revision)&&($.participant=V.participant),!$.peer_connections&&V.peer_connections?$.peer_connections=x(V.peer_connections):$.peer_connections&&V.peer_connections&&($.peer_connections=x($.peer_connections.concat(V.peer_connections))),$},{})}(k)),void j._updatesReceived.splice(0).forEach(function(U){return j.emit("message",U)});case"disconnected":return j._twilioConnection.removeListener("message",B),void j.removeListener("stateChanged",F);case"syncing":default:return}});var ee=j._options;"overrode"===j._iceServersStatus?(0,ee.onIced)(ee.iceServers).then($):$()}(F),F}return p($,j),$.prototype._createConnectOrSyncOrDisconnectMessage=function(){if("connected"===this.state)return null;if("disconnected"===this.state)return{session:this._session,type:"disconnect",version:2};var V={connecting:"connect",syncing:"sync"}[this.state],B={name:this._name,participant:this._localParticipant.getState(),peer_connections:this._peerConnectionManager.getStates(),type:V,version:2};return"connect"===B.type?(B.ice_servers=this._iceServersStatus,B.publisher={name:r,sdk_version:n,user_agent:this._userAgent},this._bandwidthProfile&&(B.bandwidth_profile=_(this._bandwidthProfile)),B.media_signaling=b(this._dominantSpeaker,this._networkQuality,this._trackPriority,this._trackSwitchOff,this._adaptiveSimulcast,this._renderHints),B.subscribe=f(this._automaticSubscription),B.format=l,B.token=this._accessToken):"sync"===B.type?(B.session=this._session,B.token=this._accessToken):"update"===B.type&&(B.session=this._session),B},$.prototype._createIceMessage=function(){return{edge:"roaming",token:this._accessToken,type:"ice",version:1}},$.prototype._sendConnectOrSyncOrDisconnectMessage=function(){var V=this._createConnectOrSyncOrDisconnectMessage();V&&this._twilioConnection.sendMessage(V)},$.prototype.disconnect=function(V){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[V]),this._sendConnectOrSyncOrDisconnectMessage(),this._twilioConnection.close(),!0)},$.prototype.publish=function(V){switch(this.state){case"connected":return this._twilioConnection.sendMessage(Object.assign({session:this._session,type:"update",version:2},V)),!0;case"connecting":case"syncing":return this._updatesToSend.push(V),!0;case"disconnected":default:return!1}},$.prototype.publishEvent=function(V,B,ee,ne){this._eventObserver.emit("event",{group:V,name:B,level:ee,payload:ne})},$.prototype.sync=function(){return"connected"===this.state&&(this.preempt("syncing"),this._sendConnectOrSyncOrDisconnectMessage(),!0)},$.prototype._setSession=function(V,B){this._session=V,this._sessionTimeoutMS=1e3*B},$.prototype._getReconnectTimer=function(){var V=this;return 0===this._sessionTimeoutMS?null:(this._sessionTimer||(this._sessionTimer=new t(function(){V._sessionTimer&&(V._sessionTimeoutMS=0)},this._sessionTimeoutMS)),new Promise(function(B){V._reconnectBackoff.once("ready",B),V._reconnectBackoff.backoff()}))},$.prototype._clearReconnectTimer=function(){this._reconnectBackoff.reset(),this._sessionTimer&&(this._sessionTimer.clear(),this._sessionTimer=null)},$}(h);function x(j){return Array.from(j.reduce(function($,V){var B=$.get(V.id)||V;return(!B.description&&V.description||B.description&&V.description&&V.description.revision>B.description.revision)&&(B.description=V.description),(!B.ice&&V.ice||B.ice&&V.ice&&V.ice.revision>B.ice.revision)&&(B.ice=V.ice),$.set(B.id,B),$},new Map).values())}C.exports=T},1856:function(C,w,a){"use strict";var b,p=this&&this.__extends||(b=function(f,u){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,v){c.__proto__=v}||function(c,v){for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&(c[g]=v[g])})(f,u)},function(f,u){if("function"!=typeof u&&null!==u)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function c(){this.constructor=f}b(f,u),f.prototype=null===u?Object.create(u):(c.prototype=u.prototype,new c)}),h=this&&this.__read||function(b,f){var u="function"==typeof Symbol&&b[Symbol.iterator];if(!u)return b;var v,A,c=u.call(b),g=[];try{for(;(void 0===f||f-- >0)&&!(v=c.next()).done;)g.push(v.value)}catch(P){A={error:P}}finally{try{v&&!v.done&&(u=c.return)&&u.call(c)}finally{if(A)throw A.error}}return g},o=this&&this.__spreadArray||function(b,f){for(var u=0,c=f.length,v=b.length;u<c;u++,v++)b[v]=f[u];return b},s=a(3105).EventEmitter,i=a(3761),t=function(b){function f(u,c){var v=b.call(this)||this,g=null,A=u;return c=function(b){var f=new Map;for(var u in b)f.set(u,new Set(b[u]));return f}(c),Object.defineProperties(v,{_lock:{get:function(){return g},set:function(P){g=P}},_reachableStates:{value:n(c)},_state:{get:function(){return A},set:function(P){A=P}},_states:{value:c},_whenDeferreds:{value:new Set},isLocked:{enumerable:!0,get:function(){return null!==g}},state:{enumerable:!0,get:function(){return A}}}),v.on("stateChanged",function(P){v._whenDeferreds.forEach(function(L){L.when(P,L.resolve,L.reject)})}),v}return p(f,b),f.prototype._whenPromise=function(u){var c=this;if("function"!=typeof u)return Promise.reject(new Error("when() executor must be a function"));var v=i.defer();return v.when=u,this._whenDeferreds.add(v),v.promise.then(function(g){return c._whenDeferreds.delete(v),g},function(g){throw c._whenDeferreds.delete(v),g})},f.prototype.bracket=function(u,c){var v,g=this;function A(P){if(g.hasLock(v)&&g.releaseLockCompletely(v),P)throw P}return this.takeLock(u).then(function(L){return c(v=L)}).then(function(L){return A(),L},A)},f.prototype.hasLock=function(u){return this._lock===u},f.prototype.preempt=function(u,c,v){if(!e(this._states,this.state,u))throw new Error('Cannot transition from "'+this.state+'" to "'+u+'"');var g;this.isLocked&&(g=this._lock,this._lock=null);var A=null;c&&(A=this.takeLockSync(c));var P=A?null:this.takeLockSync("preemption");return this.transition(u,A||P,v),g&&g.resolve(),P&&this.releaseLock(P),A},f.prototype.releaseLock=function(u){if(!this.isLocked)throw new Error("Could not release the lock for "+u.name+" because the StateMachine is not locked");if(!this.hasLock(u))throw new Error("Could not release the lock for "+u.name+" because "+this._lock.name+" has the lock");0===u.depth?(this._lock=null,u.resolve()):u.depth--},f.prototype.releaseLockCompletely=function(u){if(!this.isLocked)throw new Error("Could not release the lock for "+u.name+" because the StateMachine is not locked");if(!this.hasLock(u))throw new Error("Could not release the lock for "+u.name+" because "+this._lock.name+" has the lock");u.depth=0,this._lock=null,u.resolve()},f.prototype.takeLock=function(u){var c=this;if("object"==typeof u){var v=u;return new Promise(function(P){P(c.takeLockSync(v))})}var g=u;if(this.isLocked){var A=this.takeLock.bind(this,g);return this._lock.promise.then(A)}return Promise.resolve(this.takeLockSync(g))},f.prototype.takeLockSync=function(u){var c="string"==typeof u?null:u,v=c?c.name:u;if(c&&!this.hasLock(c)||!c&&this.isLocked)throw new Error("Could not take the lock for "+v+" because the lock for "+this._lock.name+" was not released");if(c)return c.depth++,c;var g=function(b){var f=i.defer();return f.name=b,f.depth=0,f}(v);return this._lock=g,g},f.prototype.transition=function(u,c,v){if(v=v||[],this.isLocked){if(!c)throw new Error("You must provide the key in order to transition");if(!this.hasLock(c))throw new Error("Could not transition using the key for "+c.name+" because "+this._lock.name+" has the lock")}else if(c)throw new Error("Key provided for "+c.name+", but the StateMachine was not locked (possibly due to preemption)");if(!e(this._states,this.state,u))throw new Error('Cannot transition from "'+this.state+'" to "'+u+'"');this._state=u,this.emit.apply(this,o([],h(["stateChanged",u].concat(v))))},f.prototype.tryTransition=function(u,c,v){try{this.transition(u,c,v)}catch(g){return!1}return!0},f.prototype.when=function(u){var c=this;return this.state===u?Promise.resolve(this):e(this._reachableStates,this.state,u)?this._whenPromise(function(v,g,A){v===u?g(c):e(c._reachableStates,v,u)||A(_(v,u))}):Promise.reject(_(this.state,u))},f}(s);function e(b,f,u){return b.get(f).has(u)}function n(b){return Array.from(b.keys()).reduce(function(f,u){return f.set(u,l(b,u))},new Map)}function l(b,f,u){return u=u||new Set,b.get(f).forEach(function(c){u.has(c)||(u.add(c),l(b,c,u).forEach(u.add,u))}),u}function _(b,f){return new Error('"'+f+'" cannot be reached from "'+b+'"')}C.exports=t},7642:C=>{"use strict";C.exports=function(a){return(a=a.filter(function(p){return"number"==typeof p})).length<1?void 0:a.reduce(function(p,h){return h+p})/a.length}},1955:C=>{"use strict";var w=function(){function a(p,h,o,s){Object.defineProperties(this,{availableSend:{enumerable:!0,value:o},recv:{enumerable:!0,value:h},rtt:{enumerable:!0,value:s},send:{enumerable:!0,value:p}})}return a.of=function(p,h){var o=(h.timestamp-p.timestamp)/1e3;return new a(o>0?(h.bytesSent-p.bytesSent)/o*8:0,o>0?(h.bytesReceived-p.bytesReceived)/o*8:0,h.availableOutgoingBitrate,h.currentRoundTripTime)},a}();C.exports=w},3979:(C,w,a)=>{"use strict";var p=a(1955),h=function(){function o(){Object.defineProperties(this,{lastReport:{enumerable:!0,value:new p(0,0),writable:!0},lastStats:{enumerable:!0,value:null,writable:!0}})}return o.prototype.next=function(s){var i=this.lastStats;if(this.lastStats=s,i){var t=i.id===s.id?p.of(i,s):new p(0,0);this.lastReport=t}return this.lastReport},o}();C.exports=h},1778:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r){var n=s.call(this,t,e,r)||this;return Object.defineProperties(n,{audioLevel:{value:"number"==typeof e.audioInputLevel?e.audioInputLevel:null,enumerable:!0},jitter:{value:"number"==typeof e.jitter?e.jitter:null,enumerable:!0}}),n}return p(i,s),i}(a(1899));C.exports=o},1899:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r){var n=s.call(this,t,e)||this;return Object.defineProperties(n,{bytesSent:{value:"number"==typeof e.bytesSent?e.bytesSent:r?0:null,enumerable:!0},packetsSent:{value:"number"==typeof e.packetsSent?e.packetsSent:r?0:null,enumerable:!0},roundTripTime:{value:"number"==typeof e.roundTripTime?e.roundTripTime:r?0:null,enumerable:!0}}),n}return p(i,s),i}(a(2313));C.exports=o},8651:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e,r){var n=s.call(this,t,e,r)||this,l=null;"number"==typeof e.frameWidthInput&&"number"==typeof e.frameHeightInput&&(l={},Object.defineProperties(l,{width:{value:e.frameWidthInput,enumerable:!0},height:{value:e.frameHeightInput,enumerable:!0}}));var y=null;return"number"==typeof e.frameWidthSent&&"number"==typeof e.frameHeightSent&&(y={},Object.defineProperties(y,{width:{value:e.frameWidthSent,enumerable:!0},height:{value:e.frameHeightSent,enumerable:!0}})),Object.defineProperties(n,{captureDimensions:{value:l,enumerable:!0},dimensions:{value:y,enumerable:!0},captureFrameRate:{value:"number"==typeof e.frameRateInput?e.frameRateInput:null,enumerable:!0},frameRate:{value:"number"==typeof e.frameRateSent?e.frameRateSent:null,enumerable:!0}}),n}return p(i,s),i}(a(1899));C.exports=o},7111:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t){return s.call(this,t)||this}return p(i,s),i}(a(6015));C.exports=o},5132:C=>{"use strict";C.exports=function(p){var h=p.actual,s=p.available,t=p.level;Object.defineProperties(this,{actual:{value:void 0===h?null:h,enumerable:!0},available:{value:void 0===s?null:s,enumerable:!0},level:{value:void 0===t?null:t,enumerable:!0}})}},8365:C=>{"use strict";C.exports=function(p){var h=p.fractionLost,s=p.level;Object.defineProperties(this,{fractionLost:{value:void 0===h?null:h,enumerable:!0},level:{value:void 0===s?null:s,enumerable:!0}})}},9392:C=>{"use strict";C.exports=function(p){var h=p.jitter,s=p.rtt,t=p.level;Object.defineProperties(this,{jitter:{value:void 0===h?null:h,enumerable:!0},rtt:{value:void 0===s?null:s,enumerable:!0},level:{value:void 0===t?null:t,enumerable:!0}})}},6015:(C,w,a)=>{"use strict";var p=a(8534),h=a(319);C.exports=function(i){var r=i.sendStats,n=void 0===r?null:r,l=i.recvStats,y=void 0===l?null:l;Object.defineProperties(this,{send:{value:i.send,enumerable:!0},recv:{value:i.recv,enumerable:!0},sendStats:{value:n?new p(n):null,enumerable:!0},recvStats:{value:y?new h(y):null,enumerable:!0}})}},319:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t){return s.call(this,t)||this}return p(i,s),i}(a(4391));C.exports=o},4391:(C,w,a)=>{"use strict";var p=a(5132),h=a(8365),o=a(9392);C.exports=function(t){var e=t.bandwidth,r=void 0===e?null:e,n=t.fractionLost,l=void 0===n?null:n,y=t.latency,_=void 0===y?null:y;Object.defineProperties(this,{bandwidth:{value:r?new p(r):null,enumerable:!0},fractionLost:{value:l?new h(l):null,enumerable:!0},latency:{value:_?new o(_):null,enumerable:!0}})}},8534:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t){return s.call(this,t)||this}return p(i,s),i}(a(4391));C.exports=o},5674:(C,w,a)=>{"use strict";var p=a(7111),h=a(4086);C.exports=function(i){var e=i.audio,r=i.video;Object.defineProperties(this,{level:{value:i.level,enumerable:!0},audio:{value:e?new p(e):null,enumerable:!0},video:{value:r?new h(r):null,enumerable:!0}})}},4086:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t){return s.call(this,t)||this}return p(i,s),i}(a(6015));C.exports=o},422:(C,w,a)=>{"use strict";var p=a(9369),h=a(4894),o=function(){function s(i,t,e){Object.defineProperties(this,{ice:{enumerable:!0,value:i},audio:{enumerable:!0,value:t},video:{enumerable:!0,value:e}})}return s.prototype.summarize=function(){var i=this.audio.send.concat(this.video.send),t=h.summarize(i),e=this.audio.recv.concat(this.video.recv),r=p.summarize(e);return{ice:this.ice,send:t,recv:r,audio:{send:h.summarize(this.audio.send),recv:p.summarize(this.audio.recv)},video:{send:h.summarize(this.video.send),recv:p.summarize(this.video.recv)}}},s}();C.exports=o},127:function(C,w,a){"use strict";var p=this&&this.__read||function(S,T){var x="function"==typeof Symbol&&S[Symbol.iterator];if(!x)return S;var N,$,M=x.call(S),j=[];try{for(;(void 0===T||T-- >0)&&!(N=M.next()).done;)j.push(N.value)}catch(V){$={error:V}}finally{try{N&&!N.done&&(x=M.return)&&x.call(M)}finally{if($)throw $.error}}return j},h=this&&this.__spreadArray||function(S,T){for(var x=0,M=T.length,N=S.length;x<M;x++,N++)S[N]=T[x];return S},o=this&&this.__values||function(S){var T="function"==typeof Symbol&&Symbol.iterator,x=T&&S[T],M=0;if(x)return x.call(S);if(S&&"number"==typeof S.length)return{next:function(){return S&&M>=S.length&&(S=void 0),{value:S&&S[M++],done:!S}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")},s=a(4911).guessBrowser,i=a(3979),t=a(422),e=a(3838),r=a(1208),n=function(){function S(T){Object.defineProperties(this,{pc:{enumerable:!0,value:T},ice:{enumerable:!0,value:new i},audio:{enumerable:!0,value:{send:new Map,recv:new Map}},video:{enumerable:!0,value:{send:new Map,recv:new Map}},lastReport:{enumerable:!0,value:null,writable:!0}})}return S.prototype.next=function(){var T=this;return("firefox"===s()?function(S){var T=S.pc.getTransceivers().filter(function(M){return M.currentDirection&&M.currentDirection.match(/send/)&&M.sender.track}).map(function(M){return M.sender}),x=S.pc.getTransceivers().filter(function(M){return M.currentDirection&&M.currentDirection.match(/recv/)}).map(function(M){return M.receiver});return Promise.all([l(T),l(x),S.pc.getStats()]).then(function(M){var N=p(M,3),j=N[0],$=N[1],V=N[2],B=_(S),ee=c(S);j.forEach(function(W,F){return g(S,W,ee,F)}),P(B,ee);var ne=b(S),te=v(S);$.forEach(function(W,F){return A(S,W,te,F)}),P(ne,te),L(S.ice,V)})}(this):function(S){return S.pc.getStats().then(function(T){var x=_(S),M=c(S);g(S,T,M),P(x,M);var N=b(S),j=v(S);A(S,T,j),P(N,j),L(S.ice,T)})}(this)).then(function(){var M=h([],p(T.audio.send.values())),N=h([],p(T.video.send.values())),j=h([],p(T.audio.recv.values())),$=h([],p(T.video.recv.values())),V=new t(T.ice.lastReport,{send:M.map(function(B){return B.lastReport}).filter(function(B){return B}),recv:j.map(function(B){return B.lastReport}).filter(function(B){return B})},{send:N.map(function(B){return B.lastReport}).filter(function(B){return B}),recv:$.map(function(B){return B.lastReport}).filter(function(B){return B})});return T.lastReport=V,V})},S}();function l(S){return Promise.all(S.map(function(T){var x=T.track.id;return T.getStats().then(function(M){var N,j;try{for(var $=o(M.values()),V=$.next();!V.done;V=$.next()){var B=V.value;"inbound-rtp"===B.type&&(B.id=x+"-"+B.id)}}catch(ee){N={error:ee}}finally{try{V&&!V.done&&(j=$.return)&&j.call($)}finally{if(N)throw N.error}}return[x,M]})})).then(function(T){return new Map(T)})}function y(S,T,x,M,N){var j=T[M.mediaType];if(!N){var $=x.get(M.trackId);$&&(N=$.trackIdentifier)}if(j&&N){if(j.has(M.id))return j.get(M.id);var V=new S(N,M);j.set(M.id,V)}return null}function _(S){return{audio:S.audio.send,video:S.video.send}}function b(S){return{audio:S.audio.recv,video:S.video.recv}}function f(S,T,x,M){return y(r,_(S),T,x,M)}function u(S,T,x,M){return y(e,b(S),T,x,M)}function c(S){return{audio:new Set(S.audio.send.keys()),video:new Set(S.video.send.keys())}}function v(S){return{audio:new Set(S.audio.recv.keys()),video:new Set(S.video.recv.keys())}}function g(S,T,x,M){var N,j;try{for(var $=o(T.values()),V=$.next();!V.done;V=$.next()){var B=V.value;if("outbound-rtp"===B.type&&!B.isRemote){if("firefox"!==s()&&!B.trackId)continue;var ee=x[B.mediaType];ee&&ee.delete(B.id);var ne=f(S,T,B,M);if(ne){var te=T.get(B.remoteId);ne.next(M||ne.trackId,B,te)}}}}catch(W){N={error:W}}finally{try{V&&!V.done&&(j=$.return)&&j.call($)}finally{if(N)throw N.error}}}function A(S,T,x,M){var N,j;try{for(var $=o(T.values()),V=$.next();!V.done;V=$.next()){var B=V.value;if("inbound-rtp"===B.type&&!B.isRemote){var ee=x[B.mediaType];ee&&ee.delete(B.id);var ne=u(S,T,B,M);ne&&ne.next(M||ne.trackId,B)}}}catch(te){N={error:te}}finally{try{V&&!V.done&&(j=$.return)&&j.call($)}finally{if(N)throw N.error}}}function P(S,T){var x=function(N){var j=S[N];T[N].forEach(function(V){return j.delete(V)})};for(var M in T)x(M)}function L(S,T){var x,M,N,j,$;try{for(var V=o(T.values()),B=V.next();!B.done;B=V.next())"transport"===(ee=B.value).type&&($=T.get(ee.selectedCandidatePairId))}catch(W){x={error:W}}finally{try{B&&!B.done&&(M=V.return)&&M.call(V)}finally{if(x)throw x.error}}if($)S.next($);else try{for(var ne=o(T.values()),te=ne.next();!te.done;te=ne.next()){var ee;"candidate-pair"===(ee=te.value).type&&ee.nominated&&(!("selected"in ee)||ee.selected)&&S.next(ee)}}catch(W){N={error:W}}finally{try{te&&!te.done&&(j=ne.return)&&j.call(ne)}finally{if(N)throw N.error}}}C.exports=n},9369:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(7642),o=a(3443),s=a(2697),i=function(t){function e(r,n,l,y,_,b,f){var u=t.call(this,r,n,l)||this;return Object.defineProperties(u,{deltaPacketsLost:{enumerable:!0,value:y},deltaPacketsReceived:{enumerable:!0,value:_},fractionLost:{enumerable:!0,value:b},jitter:{enumerable:!0,value:f},phonyFractionLost:{enumerable:!0,value:_>0?y/_:0}}),u}return p(e,t),e.of=function(r,n,l){if(n.id!==l.id)throw new Error("RTCStats IDs must match");var y=(l.timestamp-n.timestamp)/1e3,b=y>0?(l.bytesReceived-n.bytesReceived)/y*8:0,f=Math.max(l.packetsLost-n.packetsLost,0);return new e(n.id,r,b,f,l.packetsReceived-n.packetsReceived,l.fractionLost,l.jitter)},e.summarize=function(r){var n=r.map(function(b){return b.summarize()});return{bitrate:s(n.map(function(b){return b.bitrate})),fractionLost:h(n.map(function(b){return b.fractionLost})),jitter:h(n.map(function(b){return b.jitter}))}},e.prototype.summarize=function(){return{bitrate:this.bitrate,fractionLost:"number"==typeof this.fractionLost?this.fractionLost:this.phonyFractionLost,jitter:this.jitter}},e}(o);C.exports=i},3838:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(9369),s=function(i){function t(e,r){var n=i.call(this,r.id,e,r)||this;return Object.defineProperties(n,{lastReport:{enumerable:!0,value:null,writable:!0}}),n}return p(t,i),t.prototype.next=function(e,r){var n=this.lastStats;this.lastStats=r,this.trackId=e;var l=h.of(e,n,r);return this.lastReport=l,l},t}(a(2835));C.exports=s},457:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,e)||this;return Object.defineProperties(r,{audioLevel:{value:"number"==typeof e.audioOutputLevel?e.audioOutputLevel:null,enumerable:!0},jitter:{value:"number"==typeof e.jitter?e.jitter:null,enumerable:!0}}),r}return p(i,s),i}(a(3218));C.exports=o},3218:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,e)||this;return Object.defineProperties(r,{bytesReceived:{value:"number"==typeof e.bytesReceived?e.bytesReceived:null,enumerable:!0},packetsReceived:{value:"number"==typeof e.packetsReceived?e.packetsReceived:null,enumerable:!0}}),r}return p(i,s),i}(a(2313));C.exports=o},5021:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this,t,e)||this,n=null;return"number"==typeof e.frameWidthReceived&&"number"==typeof e.frameHeightReceived&&(n={},Object.defineProperties(n,{width:{value:e.frameWidthReceived,enumerable:!0},height:{value:e.frameHeightReceived,enumerable:!0}})),Object.defineProperties(r,{dimensions:{value:n,enumerable:!0},frameRate:{value:"number"==typeof e.frameRateReceived?e.frameRateReceived:null,enumerable:!0}}),r}return p(i,s),i}(a(3218));C.exports=o},3443:C=>{"use strict";C.exports=function(p,h,o){Object.defineProperties(this,{id:{enumerable:!0,value:p},trackId:{enumerable:!0,value:h},bitrate:{enumerable:!0,value:o}})}},2835:C=>{"use strict";C.exports=function(p,h,o){Object.defineProperties(this,{id:{enumerable:!0,value:p,writable:!0},trackId:{enumerable:!0,value:h,writable:!0},lastStats:{enumerable:!0,value:o,writable:!0}})}},4894:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(7642),o=a(3443),s=a(2697),i=function(t){function e(r,n,l,y){var _=t.call(this,r,n,l)||this;return Object.defineProperties(_,{rtt:{enumerable:!0,value:y}}),_}return p(e,t),e.of=function(r,n,l,y){if(n.id!==l.id)throw new Error("RTCStats IDs must match");var _=(l.timestamp-n.timestamp)/1e3;return new e(n.id,r,_>0?(l.bytesSent-n.bytesSent)/_*8:0,y&&"number"==typeof y.roundTripTime?y.roundTripTime/1e3:void 0)},e.summarize=function(r){return{bitrate:s(r.map(function(y){return y.bitrate})),rtt:h(r.map(function(y){return y.rtt}))}},e}(o);C.exports=i},1208:function(C,w,a){"use strict";var i,p=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=a(2835),o=a(4894),s=function(i){function t(e,r){var n=i.call(this,r.id,e,r)||this;return Object.defineProperties(n,{lastReport:{enumerable:!0,value:null,writable:!0}}),n}return p(t,i),t.prototype.next=function(e,r,n){var l=this.lastStats;this.lastStats=r,this.trackId=e;var y=o.of(e,l,r,n);return this.lastReport=y,y},t}(h);C.exports=s},6614:(C,w,a)=>{"use strict";var p=a(1778),h=a(8651),o=a(457),s=a(5021);C.exports=function(e,r,n){if("string"!=typeof e)throw new Error("RTCPeerConnection id must be a string");Object.defineProperties(this,{peerConnectionId:{value:e,enumerable:!0},localAudioTrackStats:{value:r.localAudioTrackStats.map(function(l){return new p(l.trackId,l,n)}),enumerable:!0},localVideoTrackStats:{value:r.localVideoTrackStats.map(function(l){return new h(l.trackId,l,n)}),enumerable:!0},remoteAudioTrackStats:{value:r.remoteAudioTrackStats.map(function(l){return new o(l.trackId,l)}),enumerable:!0},remoteVideoTrackStats:{value:r.remoteVideoTrackStats.map(function(l){return new s(l.trackId,l)}),enumerable:!0}})}},2697:C=>{"use strict";C.exports=function(a){return a.reduce(function(p,h){return"number"==typeof h?h+p:p},0)}},2313:C=>{"use strict";C.exports=function(p,h){if("string"!=typeof p)throw new Error("Track id must be a string");Object.defineProperties(this,{trackId:{value:p,enumerable:!0},trackSid:{value:h.trackSid,enumerable:!0},timestamp:{value:h.timestamp,enumerable:!0},ssrc:{value:h.ssrc,enumerable:!0},packetsLost:{value:"number"==typeof h.packetsLost?h.packetsLost:null,enumerable:!0},codec:{value:"string"==typeof h.codecName?h.codecName:null,enumerable:!0}})}},8699:function(C,w,a){"use strict";var s,p=this&&this.__extends||(s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])})(i,t)},function(i,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=function(s){function i(t,e){var r=s.call(this)||this;return Object.defineProperties(r,{id:{enumerable:!0,value:t},kind:{enumerable:!0,value:e}}),r}return p(i,s),i.prototype.stop=function(){this.emit("stopped")},i}(a(3105).EventEmitter);C.exports=o},9616:function(C,w,a){"use strict";var te,p=this&&this.__extends||(te=function(W,F){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,k){O.__proto__=k}||function(O,k){for(var U in k)Object.prototype.hasOwnProperty.call(k,U)&&(O[U]=k[U])})(W,F)},function(W,F){if("function"!=typeof F&&null!==F)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");function O(){this.constructor=W}te(W,F),W.prototype=null===F?Object.create(F):(O.prototype=F.prototype,new O)}),h=this&&this.__read||function(te,W){var F="function"==typeof Symbol&&te[Symbol.iterator];if(!F)return te;var k,K,O=F.call(te),U=[];try{for(;(void 0===W||W-- >0)&&!(k=O.next()).done;)U.push(k.value)}catch(re){K={error:re}}finally{try{k&&!k.done&&(F=O.return)&&F.call(O)}finally{if(K)throw K.error}}return U},o=this&&this.__spreadArray||function(te,W){for(var F=0,O=W.length,k=te.length;F<O;F++,k++)te[k]=W[F];return te},s=a(1856),i=a(3761),t=i.buildLogLevels,e=i.makeUUID,r=a(7394),n=a(4189),l=a(1190),y=0,_={closed:[],connecting:["closed","open","waiting"],early:["closed","connecting"],open:["closed"],waiting:["closed","connecting","early","open"]},b={closed:"close",open:"open",waiting:"waiting"},M=3005,$=global.window||global,V=$.WebSocket?$.WebSocket:a(6890),B={BUSY:"busy",FAILED:"failed",LOCAL:"local",REMOTE:"remote",TIMEOUT:"timeout"},ee=new Map([[3e3,B.TIMEOUT],[3001,B.TIMEOUT],[3002,B.FAILED],[3003,B.FAILED],[3004,B.TIMEOUT],[3006,B.BUSY],[3007,B.TIMEOUT]]),ne=function(te){function W(F,O){var k=te.call(this,"early",_)||this;O=Object.assign({helloBody:null,maxConsecutiveFailedHellos:3,maxConsecutiveMissedHeartbeats:3,requestedHeartbeatTimeout:5e3,openTimeout:15e3,welcomeTimeout:5e3,Log:r,WebSocket:V},O);var U=t(O.logLevel),K=new O.Log("default",k,U,O.loggerName),re=O.networkMonitor?new n(function(){var q=re.type,le="Network changed"+(q?" to "+q:"");K.debug(le),k._close({code:3004,reason:le})}):null;Object.defineProperties(k,{_busyWaitTimeout:{value:null,writable:!0},_consecutiveHeartbeatsMissed:{value:0,writable:!0},_cookie:{value:null,writable:!0},_eventObserver:{value:O.eventObserver},_heartbeatTimeout:{value:null,writable:!0},_hellosLeft:{value:O.maxConsecutiveFailedHellos,writable:!0},_instanceId:{value:++y},_log:{value:K},_messageQueue:{value:[]},_networkMonitor:{value:re},_options:{value:O},_openTimeout:{value:null,writable:!0},_sendHeartbeatTimeout:{value:null,writable:!0},_serverUrl:{value:F},_welcomeTimeout:{value:null,writable:!0},_ws:{value:null,writable:!0}});var J={connecting:"info",early:"info",open:"info",waiting:"warning",closed:"info"};return k.on("stateChanged",function(q){for(var le=[],ve=1;ve<arguments.length;ve++)le[ve-1]=arguments[ve];q in b&&k.emit.apply(k,o([b[q]],h(le)));var _e={name:q,group:"signaling",level:J[k.state]};if("closed"===q){var Pe=h(le,1),be=Pe[0];_e.payload={reason:be},_e.level=be===B.LOCAL?"info":"error"}k._eventObserver.emit("event",_e)}),k._eventObserver.emit("event",{name:k.state,group:"signaling",level:J[k.state]}),k._connect(),k}return p(W,te),W.prototype.toString=function(){return"[TwilioConnection #"+this._instanceId+": "+this._ws.url+"]"},W.prototype._close=function(F){var O=F.code,k=F.reason;if("closed"!==this.state){this._openTimeout&&this._openTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear(),this._heartbeatTimeout&&this._heartbeatTimeout.clear(),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.clear(),this._networkMonitor&&this._networkMonitor.stop(),this._busyWaitTimeout&&O!==M&&this._busyWaitTimeout.clear(),this._messageQueue.splice(0);var U=this._log;1e3===O?(U.debug("Closed"),this.transition("closed",null,[B.LOCAL])):(U.warn("Closed: "+O+" - "+k),O!==M&&this.transition("closed",null,[ee.get(O)||B.REMOTE]));var K=this._ws.readyState,re=this._options.WebSocket;K!==re.CLOSING&&K!==re.CLOSED&&this._ws.close(O,k)}},W.prototype._connect=function(){var F=this,O=this._log;if("waiting"===this.state)this.transition("early");else if("early"!==this.state)return void O.warn('Unexpected state "'+this.state+'" for connecting to the TCMP server.');this._ws=new this._options.WebSocket(this._serverUrl);var k=this._ws;O.debug("Created a new WebSocket:",k),k.addEventListener("close",function(K){return F._close(K)});var U=this._options.openTimeout;this._openTimeout=new l(function(){F._close({code:3007,reason:"Failed to open in "+U+" ms"})},U),k.addEventListener("open",function(){O.debug("WebSocket opened:",k),F._openTimeout.clear(),F._startHandshake(),F._networkMonitor&&F._networkMonitor.start()}),k.addEventListener("message",function(K){O.debug("Incoming: "+K.data);try{K=JSON.parse(K.data)}catch(re){return void F.emit("error",re)}switch(K.type){case"bad":F._handleBad(K);break;case"busy":F._handleBusy(K);break;case"bye":break;case"msg":F._handleMessage(K);case"heartbeat":F._handleHeartbeat();break;case"welcome":F._handleWelcome(K);break;default:F._log.debug("Unknown message type: "+K.type),F.emit("error",new Error("Unknown message type: "+K.type))}})},W.prototype._handleBad=function(F){var O=F.reason,k=this._log;if(["connecting","open"].includes(this.state))return"connecting"===this.state?(k.warn("Closing: 3002 - "+O),void this._close({code:3002,reason:O})):(k.debug("Error: "+O),void this.emit("error",new Error(O)));k.warn('Unexpected state "'+this.state+'" for handling a "bad" message from the TCMP server.')},W.prototype._handleBusy=function(F){var O=this,k=F.cookie,U=F.keepAlive,K=F.retryAfter,re=this._log;if(["connecting","waiting"].includes(this.state)){this._busyWaitTimeout&&this._busyWaitTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear();var J=K<0?'Received terminal "busy" message':'Received "busy" message, retrying after '+K+" ms";if(K<0)return re.warn("Closing: 3006 - "+J),void this._close({code:3006,reason:J});this._hellosLeft=this._options.maxConsecutiveFailedHellos,this._cookie=k||null,U?(re.warn(J),this._busyWaitTimeout=new l(function(){return O._startHandshake()},K)):(re.warn("Closing: 3005 - "+J),this._close({code:M,reason:J}),this._busyWaitTimeout=new l(function(){return O._connect()},K)),this.transition("waiting",null,[U,K])}else re.warn('Unexpected state "'+this.state+'" for handling a "busy" message from the TCMP server.')},W.prototype._handleHeartbeat=function(){"open"===this.state?this._heartbeatTimeout.reset():this._log.warn('Unexpected state "'+this.state+'" for handling a "heartbeat" message from the TCMP server.')},W.prototype._handleHeartbeatTimeout=function(){if("open"===this.state){var F=this._log,O=this._options.maxConsecutiveMissedHeartbeats;F.debug("Consecutive heartbeats missed: "+O);var k="Missed "+O+' "heartbeat" messages';F.warn("Closing: 3001 - "+k),this._close({code:3001,reason:k})}},W.prototype._handleMessage=function(F){"open"===this.state?this.emit("message",F.body):this._log.warn('Unexpected state "'+this.state+'" for handling a "msg" message from the TCMP server.')},W.prototype._handleWelcome=function(F){var O=this,k=F.negotiatedTimeout,U=this._log;if(["connecting","waiting"].includes(this.state)){"waiting"===this.state&&(U.debug('Received "welcome" message, no need to retry connection.'),this._busyWaitTimeout.clear());var re=k*this._options.maxConsecutiveMissedHeartbeats,J=k-200;this._welcomeTimeout.clear(),this._heartbeatTimeout=new l(function(){return O._handleHeartbeatTimeout()},re),this._messageQueue.splice(0).forEach(function(q){return O._send(q)}),this._sendHeartbeatTimeout=new l(function(){return O._sendHeartbeat()},J),this.transition("open")}else U.warn('Unexpected state "'+this.state+'" for handling a "welcome" message from the TCMP server.')},W.prototype._handleWelcomeTimeout=function(){if("connecting"===this.state){var F=this._log;if(this._hellosLeft<=0){var O="All handshake attempts failed";return F.warn("Closing: 3000 - "+O),void this._close({code:3e3,reason:O})}F.warn("Handshake attempt "+(this._options.maxConsecutiveFailedHellos-this._hellosLeft)+" failed"),this._startHandshake()}},W.prototype._send=function(F){if(this._ws.readyState===this._options.WebSocket.OPEN){var U=JSON.stringify(F);this._log.debug("Outgoing: "+U);try{this._ws.send(U),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.reset()}catch(re){var K="Failed to send message";this._log.warn("Closing: 3003 - "+K),this._close({code:3003,reason:K})}}},W.prototype._sendHeartbeat=function(){"closed"!==this.state&&this._send({type:"heartbeat"})},W.prototype._sendHello=function(){var F=this._options,O=F.helloBody,k=F.requestedHeartbeatTimeout,U={id:e(),timeout:k,type:"hello",version:2};this._cookie&&(U.cookie=this._cookie),O&&(U.body=O),this._send(U)},W.prototype._sendOrEnqueue=function(F){var O=this;"closed"!==this.state&&("open"===this.state?function(U){return O._send(U)}:function(U){return O._messageQueue.push(U)})(F)},W.prototype._startHandshake=function(){var F=this;["early","waiting"].includes(this.state)&&this.transition("connecting"),"connecting"===this.state&&(this._hellosLeft--,this._sendHello(),this._welcomeTimeout=new l(function(){return F._handleWelcomeTimeout()},this._options.welcomeTimeout))},W.prototype.close=function(){"closed"!==this.state&&(this._sendOrEnqueue({type:"bye"}),this._close({code:1e3,reason:"Normal"}))},W.prototype.sendMessage=function(F){this._sendOrEnqueue({body:F,type:"msg"})},W}(s);ne.CloseReason=B,C.exports=ne},8264:(C,w,a)=>{"use strict";var p=a(3761).defer,h=function(){function o(){Object.defineProperties(this,{_deferreds:{value:[]},_hasValue:{value:!1,writable:!0},_value:{value:null,writable:!0}})}return o.prototype.put=function(s){this._hasValue=!0,this._value=s;var i=this._deferreds.shift();return i&&i.resolve(s),this},o.prototype.take=function(){var s=this;if(this._hasValue&&!this._deferreds.length)return this._hasValue=!1,Promise.resolve(this._value);var i=p();return this._deferreds.push(i),i.promise.then(function(t){return s._hasValue=!1,t})},o}();C.exports=h},1222:function(C){"use strict";var w=this&&this.__read||function(e,r){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var y,b,l=n.call(e),_=[];try{for(;(void 0===r||r-- >0)&&!(y=l.next()).done;)_.push(y.value)}catch(f){b={error:f}}finally{try{y&&!y.done&&(n=l.return)&&n.call(l)}finally{if(b)throw b.error}}return _};C.exports={isAndroid:function(){return/Android/.test(navigator.userAgent)},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)},isMobile:function(){return/Mobi/.test(navigator.userAgent)},isNonChromiumEdge:function(e){return"chrome"===e&&/Edge/.test(navigator.userAgent)&&("undefined"==typeof chrome||void 0===chrome.runtime)},mobileWebKitBrowser:function(e){return"safari"!==e?null:"brave"in navigator?"brave":["edge","edg"].find(function(r){return navigator.userAgent.toLowerCase().includes(r)})||null},rebrandedChromeBrowser:function(e){if("chrome"!==e)return null;if("brave"in navigator)return"brave";var l=function(e){for(var r=[],n=[],l=0;l<e.length;l++)if("("===e[l])r.push(l);else if(")"===e[l]&&r.length>0){var y=r.pop();0===r.length&&n.push(e.substring(y,l+1))}return n}(navigator.userAgent).reduce(function(b,f){return b.replace(f,"")},navigator.userAgent).match(/[^\s]+/g)||[];return w(l.map(function(b){return b.split("/")[0].toLowerCase()})).slice(2).find(function(b){return!["chrome","mobile","safari"].includes(b)})||null}}},617:function(C){"use strict";var w=this&&this.__read||function(h,o){var s="function"==typeof Symbol&&h[Symbol.iterator];if(!s)return h;var t,r,i=s.call(h),e=[];try{for(;(void 0===o||o-- >0)&&!(t=i.next()).done;)e.push(t.value)}catch(n){r={error:n}}finally{try{t&&!t.done&&(s=i.return)&&s.call(i)}finally{if(r)throw r.error}}return e},a=this&&this.__spreadArray||function(h,o){for(var s=0,i=o.length,t=h.length;s<i;s++,t++)h[t]=o[s];return h},p=function(){function h(o,s){var i=this;Object.defineProperties(this,{_isCancelable:{writable:!0,value:!0},_isCanceled:{writable:!0,value:!1},_onCancel:{value:s}}),Object.defineProperty(this,"_promise",{value:new Promise(function(t,e){o(function(r){i._isCancelable=!1,t(r)},function(r){i._isCancelable=!1,e(r)},function(){return i._isCanceled})})})}return h.reject=function(o){return new h(function(i,t){t(o)},function(){})},h.resolve=function(o){return new h(function(i){i(o)},function(){})},h.prototype.cancel=function(){return this._isCancelable&&(this._isCanceled=!0,this._onCancel()),this},h.prototype.catch=function(){var o=[].slice.call(arguments),s=this._promise;return new h(function(t,e){s.catch.apply(s,a([],w(o))).then(t,e)},this._onCancel)},h.prototype.then=function(){var o=[].slice.call(arguments),s=this._promise;return new h(function(t,e){s.then.apply(s,a([],w(o))).then(t,e)},this._onCancel)},h.prototype.finally=function(){var o=[].slice.call(arguments),s=this._promise;return new h(function(t,e){s.finally.apply(s,a([],w(o))).then(t,e)},this._onCancel)},h}();C.exports=p},9917:(C,w,a)=>{"use strict";var p=a(1730);C.exports.SDK_NAME=p.name+".js",C.exports.SDK_VERSION=p.version,C.exports.SDP_FORMAT="unified",C.exports.DEFAULT_ENVIRONMENT="prod",C.exports.DEFAULT_REALM="us1",C.exports.DEFAULT_REGION="gll",C.exports.DEFAULT_LOG_LEVEL="warn",C.exports.DEFAULT_LOGGER_NAME="twilio-video",C.exports.WS_SERVER=function(o,s){return s="gll"===s?"global":encodeURIComponent(s),"prod"===o?"wss://"+s+".vss.twilio.com/signaling":"wss://"+s+".vss."+o+".twilio.com/signaling"},C.exports.PUBLISH_MAX_ATTEMPTS=5,C.exports.PUBLISH_BACKOFF_JITTER=10,C.exports.PUBLISH_BACKOFF_MS=20,C.exports.typeErrors={ILLEGAL_INVOKE:function(o,s){return new TypeError("Illegal call to "+o+": "+s)},INVALID_TYPE:function(o,s){return new TypeError(o+" must be "+function(o){return["a","e","i","o","u"].includes(o.toLowerCase()[0])?"an":"a"}(s)+" "+s)},INVALID_VALUE:function(o,s){return new RangeError(o+" must be one of "+s.join(", "))},REQUIRED_ARGUMENT:function(o){return new TypeError(o+" must be specified")}},C.exports.DEFAULT_FRAME_RATE=24,C.exports.DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS=1e4,C.exports.DEFAULT_ICE_GATHERING_TIMEOUT_MS=15e3,C.exports.DEFAULT_SESSION_TIMEOUT_SEC=30,C.exports.DEFAULT_NQ_LEVEL_LOCAL=1,C.exports.DEFAULT_NQ_LEVEL_REMOTE=0,C.exports.MAX_NQ_LEVEL=3,C.exports.ICE_ACTIVITY_CHECK_PERIOD_MS=1e3,C.exports.ICE_INACTIVITY_THRESHOLD_MS=3e3,C.exports.iceRestartBackoffConfig={factor:1.1,initialDelay:1,maxDelay:1e3*C.exports.DEFAULT_SESSION_TIMEOUT_SEC,randomisationFactor:.5},C.exports.reconnectBackoffConfig={factor:1.5,initialDelay:80,randomisationFactor:.5},C.exports.subscriptionMode={MODE_COLLABORATION:"collaboration",MODE_GRID:"grid",MODE_PRESENTATION:"presentation"},C.exports.trackSwitchOffMode={MODE_DISABLED:"disabled",MODE_DETECTED:"detected",MODE_PREDICTED:"predicted"},C.exports.trackPriority={PRIORITY_HIGH:"high",PRIORITY_LOW:"low",PRIORITY_STANDARD:"standard"},C.exports.clientTrackSwitchOffControl={MODE_AUTO:"auto",MODE_MANUAL:"manual"},C.exports.videoContentPreferencesMode={MODE_AUTO:"auto",MODE_MANUAL:"manual"}},3305:(C,w,a)=>{"use strict";var p=a(1923);C.exports=function(i){var t=a(9057),e={},r=t.getOrCreate(e),n=3;return function l(){return n--,p(r,i.srcObject,250).then(function(y){return!!y&&(!(n>0)||l())}).catch(function(){return!0})}().finally(function(){t.release(e)})}},4139:C=>{"use strict";var w=null;C.exports=function(t){return w=w||document.createElement("canvas"),new Promise(function(e){var r=3;setTimeout(function n(){return r--,function(t){try{var e=w.getContext("2d");e.drawImage(t,0,0,50,50);var n=e.getImageData(0,0,50,50).data.filter(function(y,_){return(_+1)%4});return 0===Math.max.apply(Math,n)}catch(y){return console.log("Error checking silence: ",y),!1}}(t)?r>0?setTimeout(n,250):e(!0):e(!1)},250)})}},296:C=>{"use strict";var w=function(){function a(p){var h=this;void 0===p&&(p=1),Object.defineProperties(this,{_listeners:{value:[]},_onVisibilityChange:{value:function(){h._emitVisible("visible"===document.visibilityState)}}});for(var o=0;o<p;o++)this._listeners.push([])}return a.prototype.clear=function(){for(var p=this._listeners.length,h=0;h<p;h++)this._listeners[h]=[]},a.prototype._listenerCount=function(){return this._listeners.reduce(function(p,h){return p+h.length},0)},a.prototype._emitVisible=function(p){for(var h=this,o=Promise.resolve(),s=function(t){o=o.then(function(){return h._emitVisiblePhase(t,p)})},i=1;i<=this._listeners.length;i++)s(i);return o},a.prototype._emitVisiblePhase=function(p,h){return Promise.all(this._listeners[p-1].map(function(s){var i=s(h);return i instanceof Promise?i:Promise.resolve(i)}))},a.prototype._start=function(){document.addEventListener("visibilitychange",this._onVisibilityChange)},a.prototype._stop=function(){document.removeEventListener("visibilitychange",this._onVisibilityChange)},a.prototype.onVisibilityChange=function(p,h){if("number"!=typeof p||p<=0||p>this._listeners.length)throw new Error("invalid phase: ",p);return this._listeners[p-1].push(h),1===this._listenerCount()&&this._start(),this},a.prototype.offVisibilityChange=function(p,h){if("number"!=typeof p||p<=0||p>this._listeners.length)throw new Error("invalid phase: ",p);var o=this._listeners[p-1],s=o.indexOf(h);return-1!==s&&(o.splice(s,1),0===this._listenerCount()&&this._stop()),this},a}();C.exports=new w(2)},8326:function(C,w,a){"use strict";var t,p=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,l){n.__proto__=l}||function(n,l){for(var y in l)Object.prototype.hasOwnProperty.call(l,y)&&(n[y]=l[y])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=a(3105).EventEmitter,o=["signaling","room","media","quality","video-processor","preflight"],s=["debug","error","info","warning"],i=function(t){function e(r,n,l,y){void 0===y&&(y=null);var _=t.call(this)||this;return _.on("event",function(b){var f=b.name,u=b.group,c=b.level,v=b.payload;if("string"!=typeof f)throw l.error("Unexpected name: ",f),new Error("Unexpected name: ",f);if(!o.includes(u))throw l.error("Unexpected group: ",u),new Error("Unexpected group: ",u);if(!s.includes(c))throw l.error("Unexpected level: ",c),new Error("Unexpected level: ",c);var g=Date.now(),A=g-n,P=Object.assign({elapsedTime:A,level:c},v||{});r.publish(u,f,P);var L=Object.assign({elapsedTime:A,group:u,level:c,name:f,timestamp:g},v?{payload:v}:{});l[{debug:"debug",error:"error",info:"info",warning:"warn"}[c]]("event",L),y&&"signaling"===u&&y.emit("event",L)}),_}return p(e,t),e}(h);C.exports=i},7060:C=>{"use strict";var w=function(){function a(p){p=Object.assign({getKey:function(o){return o},getValue:function(o){return o},isLessThanOrEqualTo:function(o,s){return o<=s}},p),Object.defineProperties(this,{_getKey:{value:p.getKey},_getValue:{value:p.getValue},_isLessThanOrEqualTo:{value:p.isLessThanOrEqualTo},_map:{value:new Map}})}return a.prototype.toMap=function(){return new Map(this._map)},a.prototype.updateAndFilter=function(p){return p.filter(this.update,this)},a.prototype.update=function(p){var h=this._getKey(p),o=this._getValue(p);return!(this._map.has(h)&&this._isLessThanOrEqualTo(o,this._map.get(h))||(this._map.set(h,o),0))},a}();C.exports=w},3761:function(C,w,a){"use strict";var Z,p=this&&this.__extends||(Z=function(ie,ae){return(Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,D){H.__proto__=D}||function(H,D){for(var Q in D)Object.prototype.hasOwnProperty.call(D,Q)&&(H[Q]=D[Q])})(ie,ae)},function(ie,ae){if("function"!=typeof ae&&null!==ae)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");function H(){this.constructor=ie}Z(ie,ae),ie.prototype=null===ae?Object.create(ae):(H.prototype=ae.prototype,new H)}),h=this&&this.__read||function(Z,ie){var ae="function"==typeof Symbol&&Z[Symbol.iterator];if(!ae)return Z;var D,me,H=ae.call(Z),Q=[];try{for(;(void 0===ie||ie-- >0)&&!(D=H.next()).done;)Q.push(D.value)}catch(fe){me={error:fe}}finally{try{D&&!D.done&&(ae=H.return)&&ae.call(H)}finally{if(me)throw me.error}}return Q},o=this&&this.__spreadArray||function(Z,ie){for(var ae=0,H=ie.length,D=Z.length;ae<H;ae++,D++)Z[D]=ie[ae];return Z},s=a(9917),i=s.typeErrors,t=s.trackPriority,e=a(4911),r=a(3187).sessionSID;function c(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"Unknown"}function E(Z,ie,ae,H){if(!(H in ie)&&!H.match(/^on[a-z]+$/)){var D;try{D=typeof Z[H]}catch(Q){}"function"===D&&(ie[H]=function(){for(var Q,me=[],fe=0;fe<arguments.length;fe++)me[fe]=arguments[fe];return(Q=this[ae])[H].apply(Q,o([],h(me)))})}}function x(Z){return"object"==typeof Z&&!Array.isArray(Z)}function ee(Z){Object.getOwnPropertyNames(Z).forEach(function(ie){ie.startsWith("_")&&te(Z,ie)})}function te(Z,ie){var ae=Object.getOwnPropertyDescriptor(Z,ie);ae.enumerable=!1,Object.defineProperty(Z,ie,ae)}function W(Z,ie){void 0===ie&&(ie=[]),ie.forEach(function(ae){Z.hasOwnProperty(ae)&&te(Z,ae)})}function F(Z){return Z.map(K)}function K(Z){return Array.isArray(Z)?F(Z):Z instanceof Set?function(Z){return F(o([],h(Z)))}(Z):Z instanceof Map?function(Z){return o([],h(Z.entries())).reduce(function(ie,ae){var H,D=h(ae,2);return Object.assign(((H={})[D[0]]=K(D[1]),H),ie)},{})}(Z):Z&&"object"==typeof Z?function(Z){return Object.entries(Z).reduce(function(ie,ae){var H,D=h(ae,2);return Object.assign(((H={})[D[0]]=K(D[1]),H),ie)},{})}(Z):Z}function q(Z){return Pe(Z,[{prop:"dominantSpeakerPriority",type:"string",payloadProp:"active_speaker_priority"},{prop:"maxSubscriptionBitrate",type:"number",payloadProp:"max_subscription_bandwidth"},{prop:"maxTracks",type:"number",payloadProp:"max_tracks"},{prop:"mode",type:"string"},{prop:"renderDimensions",type:"object",payloadProp:"render_dimensions",transform:_e},{prop:"trackSwitchOffMode",type:"string",payloadProp:"track_switch_off"}])}function ve(Z){return Pe(Z,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}function _e(Z){return Pe(Z,[{prop:t.PRIORITY_HIGH,type:"object",transform:ve},{prop:t.PRIORITY_LOW,type:"object",transform:ve},{prop:t.PRIORITY_STANDARD,type:"object",transform:ve}])}function Pe(Z,ie){return ie.reduce(function(ae,H){var D,Q=H.prop,fe=H.payloadProp,Ne=H.transform;return typeof Z[Q]===H.type?Object.assign(((D={})[void 0===fe?Q:fe]=(void 0===Ne?function(Fe){return Fe}:Ne)(Z[Q]),D),ae):ae},{})}w.constants=s,w.createBandwidthProfilePayload=function(Z){return Pe(Z,[{prop:"video",type:"object",transform:q}])},w.createMediaSignalingPayload=function(Z,ie,ae,H,D,Q){var me={transports:[{type:"data-channel"}]};return Object.assign(Z?{active_speaker:me}:{},ie?{network_quality:me}:{},Q?{render_hints:me}:{},D?{publisher_hints:me}:{},ae?{track_priority:me}:{},H?{track_switch_off:me}:{})},w.createRoomConnectEventPayload=function(Z){function ie(D){return D?"true":"false"}var ae={sessionSID:r,iceServers:(Z.iceServers||[]).length,audioTracks:(Z.tracks||[]).filter(function(D){return"audio"===D.kind}).length,videoTracks:(Z.tracks||[]).filter(function(D){return"video"===D.kind}).length,dataTracks:(Z.tracks||[]).filter(function(D){return"data"===D.kind}).length};if([["audio"],["automaticSubscription"],["enableDscp"],["eventListener"],["preflight"],["video"],["dominantSpeaker","enableDominantSpeaker"]].forEach(function(D){var Q=h(D,2),me=Q[0],fe=Q[1];ae[fe=fe||me]=ie(!!Z[me])}),[["maxVideoBitrate"],["maxAudioBitrate"]].forEach(function(D){var Q=h(D,2),me=Q[0],fe=Q[1];fe=fe||me,"number"==typeof Z[me]?ae[fe]=Z[me]:isNaN(Number(Z[me]))||(ae[fe]=Number(Z[me]))}),[["iceTransportPolicy"],["region"],["name","roomName"]].forEach(function(D){var Q=h(D,2),me=Q[0],fe=Q[1];fe=fe||me,"string"==typeof Z[me]?ae[fe]=Z[me]:"number"==typeof Z[me]&&"name"===me&&(ae[fe]=Z[me].toString())}),["preferredAudioCodecs","preferredVideoCodecs"].forEach(function(D){D in Z&&(ae[D]=JSON.stringify(Z[D]))}),"networkQuality"in Z&&(ae.networkQualityConfiguration={},x(Z.networkQuality)?["local","remote"].forEach(function(D){"number"==typeof Z.networkQuality[D]&&(ae.networkQualityConfiguration[D]=Z.networkQuality[D])}):(ae.networkQualityConfiguration.remote=0,ae.networkQualityConfiguration.local=Z.networkQuality?1:0)),Z.bandwidthProfile&&Z.bandwidthProfile.video){var H=Z.bandwidthProfile.video||{};ae.bandwidthProfileOptions={},["mode","maxTracks","trackSwitchOffMode","dominantSpeakerPriority","maxSubscriptionBitrate","renderDimensions","contentPreferencesMode","clientTrackSwitchOffControl"].forEach(function(D){"number"==typeof H[D]||"string"==typeof H[D]?ae.bandwidthProfileOptions[D]=H[D]:"boolean"==typeof H[D]?ae.bandwidthProfileOptions[D]=ie(H[D]):"object"==typeof H[D]&&(ae.bandwidthProfileOptions[D]=JSON.stringify(H[D]))})}return{group:"room",name:"connect",level:"info",payload:ae}},w.createSubscribePayload=function(Z){return{rules:[{type:Z?"include":"exclude",all:!0}],revision:1}},w.asLocalTrack=function(Z,ie){if(Z instanceof ie.LocalAudioTrack||Z instanceof ie.LocalVideoTrack||Z instanceof ie.LocalDataTrack)return Z;if(Z instanceof ie.MediaStreamTrack)return"audio"===Z.kind?new ie.LocalAudioTrack(Z,ie):new ie.LocalVideoTrack(Z,ie);throw i.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")},w.asLocalTrackPublication=function(Z,ie,ae,H){return new(0,{audio:H.LocalAudioTrackPublication,video:H.LocalVideoTrackPublication,data:H.LocalDataTrackPublication}[Z.kind])(ie,Z,ae,H)},w.capitalize=function(Z){return Z[0].toUpperCase()+Z.slice(1)},w.deprecateEvents=function(Z,ie,ae,H){var D=new Set;ie.on("newListener",function Q(me){ae.has(me)&&!D.has(me)&&(H.deprecated(Z+"#"+me+" has been deprecated and scheduled for removal in twilio-video.js@2.0.0."+(ae.get(me)?" Use "+Z+"#"+ae.get(me)+" instead.":"")),D.add(me)),D.size>=ae.size&&ie.removeListener("newListener",Q)})},w.difference=function(Z,ie){Z=Array.isArray(Z)?new Set(Z):new Set(Z.values()),ie=Array.isArray(ie)?new Set(ie):new Set(ie.values());var ae=new Set;return Z.forEach(function(H){ie.has(H)||ae.add(H)}),ae},w.filterObject=function(Z,ie){return Object.keys(Z).reduce(function(ae,H){return Z[H]!==ie&&(ae[H]=Z[H]),ae},{})},w.flatMap=function(Z,ie){var ae=Z instanceof Map||Z instanceof Set?Array.from(Z.values()):Z;return ie=ie||function(D){return D},ae.reduce(function(H,D){var Q=ie(D);return H.concat(Q)},[])},w.getPlatform=function(){var Z=c(),ae=h(Z.match(/\(([^)]+)\)/)||[],2)[1];return h((void 0===ae?"unknown":ae).split(";").map(function(me){return me.trim()}),1)[0].toLowerCase()},w.getUserAgent=c,w.hidePrivateProperties=ee,w.hidePrivateAndCertainPublicPropertiesInClass=function(Z,ie){return function(ae){function H(){for(var D=[],Q=0;Q<arguments.length;Q++)D[Q]=arguments[Q];var me=ae.apply(this,o([],h(D)))||this;return ee(me),W(me,ie),me}return p(H,ae),H}(Z)},w.isDeepEqual=function T(Z,ie){if(Z===ie)return!0;if(typeof Z!=typeof ie)return!1;if(null===Z)return null===ie;if(null===ie)return!1;if(Array.isArray(Z))return Array.isArray(ie)&&Z.length===ie.length&&Z.every(function(D,Q){return T(D,ie[Q])});if("object"==typeof Z){var ae=Object.keys(Z).sort(),H=Object.keys(ie).sort();return!Array.isArray(ie)&&T(ae,H)&&ae.every(function(D){return T(Z[D],ie[D])})}return!1},w.isNonArrayObject=x,w.inRange=function(Z,ie,ae){return ie<=Z&&Z<=ae},w.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(Z){var ie=16*Math.random()|0;return("x"===Z?ie:3&ie|8).toString(16)})},w.oncePerTick=function(Z){var ie=null;function ae(){ie=null,Z()}return function(){ie&&clearTimeout(ie),ie=setTimeout(ae)}},w.promiseFromEvents=function(Z,ie,ae,H){return new Promise(function(D,Q){function me(){var xe=[].slice.call(arguments);H&&ie.removeListener(H,fe),D.apply(void 0,o([],h(xe)))}function fe(){var xe=[].slice.call(arguments);ie.removeListener(ae,me),Q.apply(void 0,o([],h(xe)))}ie.once(ae,me),H&&ie.once(H,fe),Z()})},w.getOrNull=function(Z,ie){return ie.split(".").reduce(function(ae,H){return ae?ae[H]:null},Z)},w.defer=function(){var Z={};return Z.promise=new Promise(function(ie,ae){Z.resolve=ie,Z.reject=ae}),Z},w.delegateMethods=function(Z,ie,ae){for(var H in Z)E(Z,ie,ae,H)},w.proxyProperties=function(Z,ie,ae){Object.getOwnPropertyNames(Z).forEach(function(H){!function(Z,ie,ae,H){if(!(H in ie)){if(H.match(/^on[a-z]+$/))return Object.defineProperty(ie,H,{value:null,writable:!0}),void ae.addEventListener(H.slice(2),function(){for(var D=[],Q=0;Q<arguments.length;Q++)D[Q]=arguments[Q];ie.dispatchEvent.apply(ie,o([],h(D)))});Object.defineProperty(ie,H,{enumerable:!0,get:function(){return ae[H]}})}}(0,ie,ae,H)})},w.legacyPromise=function(Z,ie,ae){return ie?Z.then(function(H){ie(H)},function(H){ae(H)}):Z},w.buildLogLevels=function(Z){return"string"==typeof Z?{default:Z,media:Z,signaling:Z,webrtc:Z}:Z},w.trackClass=function(Z,ie){return(ie=ie?"Local":"")+(Z.kind||"").replace(/\w{1}/,function(ae){return ae.toUpperCase()})+"Track"},w.trackPublicationClass=function(Z,ie){return(ie=ie?"Local":"")+(Z.kind||"").replace(/\w{1}/,function(ae){return ae.toUpperCase()})+"TrackPublication"},w.valueToJSON=K,w.withJitter=function(Z,ie){var ae=Math.random();return Z-ie+Math.floor(2*ie*ae+.5)},w.isChromeScreenShareTrack=function(Z){return"chrome"===e.guessBrowser()&&"video"===Z.kind&&"displaySurface"in Z.getSettings()},w.isUserMediaTrack=function(Z){return"string"==typeof Z.getSettings().deviceId},w.waitForSometime=function(Z){return void 0===Z&&(Z=10),new Promise(function(ie){return setTimeout(ie,Z)})},w.waitForEvent=function(Z,ie){return new Promise(function(ae){Z.addEventListener(ie,function H(D){Z.removeEventListener(ie,H),ae(D)})})}},3066:function(C,w,a){"use strict";var u,p=this&&this.__extends||(u=function(c,v){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,A){g.__proto__=A}||function(g,A){for(var P in A)Object.prototype.hasOwnProperty.call(A,P)&&(g[P]=A[P])})(c,v)},function(c,v){if("function"!=typeof v&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function g(){this.constructor=c}u(c,v),c.prototype=null===v?Object.create(v):(g.prototype=v.prototype,new g)}),h=a(3105).EventEmitter,o=a(3761).getUserAgent,e=global.window||global,r=e.WebSocket?e.WebSocket:a(6890),n=a(3761),l=function(u){function c(v,g,A,P,L,R){var E=u.call(this)||this;return R=Object.assign({gateway:_(P,L)+"/v1/VideoEvents",maxReconnectAttempts:5,reconnectIntervalMs:50,userAgent:o(),WebSocket:r},R),Object.defineProperties(E,{_connectTimestamp:{value:0,writable:!0},_eventQueue:{value:[]},_readyToConnect:{value:n.defer()},_reconnectAttemptsLeft:{value:R.maxReconnectAttempts,writable:!0},_ws:{value:null,writable:!0},_WebSocket:{value:R.WebSocket}}),E._readyToConnect.promise.then(function(S){var T=S.roomSid,x=S.participantSid,M=E;E.on("disconnected",function N(j){if(M._session=null,j&&M._reconnectAttemptsLeft>0)return M.emit("reconnecting"),void function(u,c,v,g,A,P,L){var R=Date.now()-u._connectTimestamp,E=L.reconnectIntervalMs-R;E>0?setTimeout(function(){y(u,c,v,g,A,P,L)},E):y(u,c,v,g,A,P,L)}(M,v,g,A,T,x,R);M.removeListener("disconnected",N)}),y(E,v,g,A,T,x,R)}).catch(function(){}),E}return p(c,u),c.prototype.connect=function(v,g){this._readyToConnect.resolve({roomSid:v,participantSid:g})},c.prototype._publish=function(v){v.session=this._session,this._ws.send(JSON.stringify(v))},c.prototype.disconnect=function(){if(null===this._ws||this._ws.readyState===this._WebSocket.CLOSING||this._ws.readyState===this._WebSocket.CLOSED)return!1;try{this._ws.close()}catch(v){}return this.emit("disconnected"),!0},c.prototype.publish=function(v,g,A){return(null===this._ws||this._ws.readyState!==this._WebSocket.CLOSING&&this._ws.readyState!==this._WebSocket.CLOSED)&&(("string"==typeof this._session?this._publish.bind(this):this._eventQueue.push.bind(this._eventQueue))({group:v,name:g,payload:A,timestamp:Date.now(),type:"event",version:1}),!0)},c}(h);function y(u,c,v,g,A,P,L){u._connectTimestamp=Date.now(),u._reconnectAttemptsLeft--,u._ws=new L.WebSocket(L.gateway);var R=u._ws;R.addEventListener("close",function(E){1e3!==E.code?u.emit("disconnected",new Error("WebSocket Error "+E.code+": "+E.reason)):u.emit("disconnected")}),R.addEventListener("message",function(E){!function(u,c,v){switch(c.type){case"connected":u._session=c.session,u._reconnectAttemptsLeft=v.maxReconnectAttempts,u._eventQueue.splice(0).forEach(u._publish,u),u.emit("connected");break;case"error":u._ws.close(),u.emit("disconnected",new Error(c.message))}}(u,JSON.parse(E.data),L)}),R.addEventListener("open",function(){var E={type:"connect",token:c,version:1};E.publisher={name:v,sdkVersion:g,userAgent:L.userAgent,participantSid:P,roomSid:A},R.send(JSON.stringify(E))})}function _(u,c){return"prod"===u?"wss://sdkgw."+c+".twilio.com":"wss://sdkgw."+u+"-"+c+".twilio.com"}C.exports=l},7217:C=>{"use strict";var w=function(){function a(){Object.defineProperties(this,{_connected:{writable:!0,value:!0}})}return a.prototype.connect=function(){},a.prototype.disconnect=function(){return!!this._connected&&(this._connected=!1,!0)},a.prototype.publish=function(){return this._connected},a}();C.exports=w},9388:(C,w,a)=>{"use strict";var p=a(3761).defer,h=function(){function o(){Object.defineProperties(this,{_audio:{value:p(),writable:!0},_video:{value:p(),writable:!0}}),this._audio.resolve(),this._video.resolve()}return o.prototype.resolveDeferred=function(s){"audio"===s?this._audio.resolve():this._video.resolve()},o.prototype.startDeferred=function(s){"audio"===s?this._audio=p():this._video=p()},o.prototype.whenResolved=function(s){return"audio"===s?this._audio.promise:this._video.promise},o}();C.exports=new h},7394:function(C,w,a){"use strict";var r,p=this&&this.__read||function(c,v){var g="function"==typeof Symbol&&c[Symbol.iterator];if(!g)return c;var P,R,A=g.call(c),L=[];try{for(;(void 0===v||v-- >0)&&!(P=A.next()).done;)L.push(P.value)}catch(E){R={error:E}}finally{try{P&&!P.done&&(g=A.return)&&g.call(A)}finally{if(R)throw R.error}}return L},h=this&&this.__spreadArray||function(c,v){for(var g=0,A=v.length,P=c.length;g<A;g++,P++)c[P]=v[g];return c},o=a(6828).getLogger,s=a(9917),i=s.DEFAULT_LOG_LEVEL,t=s.DEFAULT_LOGGER_NAME,e=a(9917).typeErrors,l=function(){function c(v,g,A,P,L){if("string"!=typeof v)throw e.INVALID_TYPE("moduleName","string");if(!g)throw e.REQUIRED_ARGUMENT("component");"object"!=typeof A&&(A={}),L=L||o,u(A),Object.defineProperties(this,{_component:{value:g},_logLevels:{value:A},_warnings:{value:new Set},_loggerName:{get:function(){var E=P&&"string"==typeof P?P:t;return this._logLevelsEqual||(E=E+"-"+v),E}},_logger:{get:function(){var E=L(this._loggerName),S=this._logLevels[v]||i;return E.setDefaultLevel(S="off"===S?"silent":S),E}},_logLevelsEqual:{get:function(){return 1===new Set(Object.values(this._logLevels)).size}},logLevel:{get:function(){return c.getLevelByName(A[v]||i)}},name:{get:g.toString.bind(g)}})}return c.getLevelByName=function(v){return isNaN(v)?(f(v=v.toUpperCase()),c[v]):parseInt(v,10)},c.prototype.createLog=function(v,g){var A=this._loggerName;return this._logLevelsEqual||(A=A.substring(0,A.lastIndexOf("-"))),new c(v,g,this._logLevels,A)},c.prototype.setLevels=function(v){return u(v),Object.assign(this._logLevels,v),this},c.prototype.log=function(v,g){var A=c._levels[v];if(!A)throw e.INVALID_VALUE("logLevel",_);A=A.toLowerCase();var P=[(new Date).toISOString(),A,this.name];return(this._logger[A]||function(){}).apply(void 0,h([],p(P.concat(g)))),this},c.prototype.debug=function(){return this.log(c.DEBUG,[].slice.call(arguments))},c.prototype.deprecated=function(v){var g=function(c){if((r=r||new Map).has(c))return r.get(c);var v=new Set;return r.set(c,v),v}(this._component.constructor);return g.has(v)?this:(g.add(v),this.warn(v))},c.prototype.info=function(){return this.log(c.INFO,[].slice.call(arguments))},c.prototype.warn=function(){return this.log(c.WARN,[].slice.call(arguments))},c.prototype.warnOnce=function(v){return this._warnings.has(v)?this:(this._warnings.add(v),this.warn(v))},c.prototype.error=function(){return this.log(c.ERROR,[].slice.call(arguments))},c.prototype.throw=function(v,g){throw v.clone&&(v=v.clone(g)),this.log(c.ERROR,v),v},c}();Object.defineProperties(l,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:["DEBUG","INFO","WARN","ERROR","OFF"]}});var y={},_=[],b=l._levels.map(function(c,v){return y[c]=!0,_.push(v),c});function f(c){if(!(c in y))throw e.INVALID_VALUE("level",b)}function u(c){Object.keys(c).forEach(function(v){f(c[v].toUpperCase())})}C.exports=l},2100:C=>{"use strict";var w=function(){function a(){Object.defineProperties(this,{_samples:{value:[{denominator:0,numerator:0},{denominator:0,numerator:0}]}})}return a.prototype.get=function(){var p=this._samples;return(p[1].numerator-p[0].numerator)/(p[1].denominator-p[0].denominator||1/0)},a.prototype.putSample=function(p,h){var o=this._samples;o.shift(),o.push({denominator:h,numerator:p})},a}();C.exports=w},4189:C=>{"use strict";var w=function(){function a(p,h){var o=this,s=(h=Object.assign({navigator,window},h)).navigator,i=s.connection||{type:null},t=i.type,e=i.type?{_events:{value:["change","typechange"]},_listener:{value:function(){var y=t!==o.type&&o.isOnline;t=o.type,y&&p()}},_target:{value:i}}:{_events:{value:["online"]},_listener:{value:p},_target:{value:h.window}};Object.defineProperties(this,{isOnline:{enumerable:!0,get:function(){return"boolean"!=typeof s.onLine||s.onLine}},type:{enumerable:!0,get:function(){return i.type||null}},_listener:e._listener,_events:e._events,_target:e._target})}return a.prototype.start=function(){var p=this;this._events.forEach(function(h){p._target.addEventListener(h,p._listener)})},a.prototype.stop=function(){var p=this;this._events.forEach(function(h){p._target.removeEventListener(h,p._listener)})},a}();C.exports=w},5092:function(C){"use strict";var o,w=this&&this.__extends||(o=function(s,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(s,i)},function(s,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=s}o(s,i),s.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),a=function(){function o(s){Object.defineProperties(this,{_callback:{value:s}})}return o.prototype.observe=function(){},o.prototype.unobserve=function(){},o.prototype.makeVisible=function(s){var i=this._makeFakeEntry(s,!0);this._callback([i])},o.prototype.makeInvisible=function(s){var i=this._makeFakeEntry(s,!1);this._callback([i])},o.prototype._makeFakeEntry=function(s,i){return{target:s,isIntersecting:i}},o}(),p=function(o){function s(){return null!==o&&o.apply(this,arguments)||this}return w(s,o),s}(a),h=function(o){function s(){return null!==o&&o.apply(this,arguments)||this}return w(s,o),s.prototype.resize=function(i){var t=this._makeFakeEntry(i,!0);this._callback([t])},s}(a);C.exports={NullIntersectionObserver:p,NullResizeObserver:h,NullObserver:a}},3028:function(C,w,a){"use strict";var p=this&&this.__read||function(N,j){var $="function"==typeof Symbol&&N[Symbol.iterator];if(!$)return N;var B,ne,V=$.call(N),ee=[];try{for(;(void 0===j||j-- >0)&&!(B=V.next()).done;)ee.push(B.value)}catch(te){ne={error:te}}finally{try{B&&!B.done&&($=V.return)&&$.call(V)}finally{if(ne)throw ne.error}}return ee},h=a(3761),o=h.difference,s=h.flatMap,i=a(8726),t={0:"PCMU",8:"PCMA"};function e(N){return Array.from(n(N)).reduce(function(j,$){var V=$[0],B=$[1],ee=j.get(B)||[];return j.set(B,ee.concat(V))},new Map)}function r(N){return _(N).reduce(function(j,$){var V=y($);return V?j.set(V,$):j},new Map)}function n(N){return b(N).reduce(function(j,$){var V=new RegExp("a=rtpmap:"+$+" ([^/]+)"),B=N.match(V),ee=B?B[1].toLowerCase():t[$]?t[$].toLowerCase():"";return j.set($,ee)},new Map)}function l(N,j){var $=new RegExp("^a=fmtp:"+N+" (.+)$","m"),V=j.match($);return V&&V[1].split(";").reduce(function(B,ee){var ne=p(ee.split("="),2),W=ne[1];return B[ne[0]]=isNaN(W)?W:parseInt(W,10),B},{})}function y(N){var j=N.match(/^a=mid:(.+)$/m);return j&&j[1]}function _(N,j,$){return N.replace(/\r\n\r\n$/,"\r\n").split("\r\nm=").slice(1).map(function(V){return"m="+V}).filter(function(V){var B=new RegExp("m="+(j||".*"),"gm"),ee=new RegExp("a="+($||".*"),"gm");return B.test(V)&&ee.test(V)})}function b(N){var $=N.split("\r\n")[0].match(/([0-9]+)/g);return $?$.slice(1).map(function(V){return parseInt(V,10)}):[]}function u(N,j){var $=j.split("\r\n"),V=$[0],B=$.slice(1);return[V=V.replace(/([0-9]+\s?)+$/,N.join(" "))].concat(B).join("\r\n")}function E(N,j){var $=_(N);return[N.split("\r\nm=")[0]].concat($.map(function(B){if(!/^m=(audio|video)/.test(B))return B;var ee=y(B);if(!ee)return B;var ne=j.get(ee);if(!ne)return B;var te=(B.match(/^a=msid:(.+)$/m)||[])[1];if(!te)return B;var W=p(te.split(" "),2),F=W[0],O=W[1],k=new RegExp("msid:"+F+(O?" "+O:"")+"$","gm");return B.replace(k,"msid:"+F+" "+ne)})).join("\r\n")}function x(N,j){return"a=fmtp:"+N+" "+Object.entries(j).map(function(V){var B=p(V,2);return B[0]+"="+B[1]}).join(";")}w.addOrRewriteNewTrackIds=function(N,j,$){var V=Array.from($).reduce(function(B,ee){var ne=p(ee,2),W=ne[1];return _(N,ne[0],"send(only|recv)").map(y).filter(function(k){return!j.has(k)}).forEach(function(k,U){return B.set(k,W[U])}),B},new Map);return E(N,V)},w.addOrRewriteTrackIds=E,w.createCodecMapForMediaSection=e,w.createPtToCodecName=n,w.disableRtx=function(N){var j=_(N);return[N.split("\r\nm=")[0]].concat(j.map(function(V){if(!/^m=video/.test(V))return V;var ee=e(V).get("rtx");if(!ee)return V;var ne=new Set(b(V));ee.forEach(function(O){return ne.delete(O)});var te=V.match(/a=ssrc-group:FID [0-9]+ ([0-9]+)/),W=te&&te[1],F=[/^a=fmtp:.+ apt=.+$/,/^a=rtpmap:.+ rtx\/.+$/,/^a=ssrc-group:.+$/].concat(W?[new RegExp("^a=ssrc:"+W+" .+$")]:[]);return V=V.split("\r\n").filter(function(O){return F.every(function(k){return!k.test(O)})}).join("\r\n"),u(Array.from(ne),V)})).join("\r\n")},w.enableDtxForOpus=function(N,j){var $=_(N),V=N.split("\r\nm=")[0];return j=j||$.filter(function(B){return/^m=audio/.test(B)}).map(y),[V].concat($.map(function(B){if(!/^m=audio/.test(B))return B;var ne=e(B).get("opus");if(!ne)return B;var te=l(ne,B);if(!te)return B;var W=x(ne,te),F=new RegExp(W),O=y(B);j.includes(O)?te.usedtx=1:delete te.usedtx;var k=x(ne,te);return B.replace(F,k)})).join("\r\n")},w.filterLocalCodecs=function(N,j){var $=_(N),V=N.split("\r\nm=")[0],B=r(j);return[V].concat($.map(function(ee){return function(N,j,$){if(!/^m=(audio|video)/.test(N))return N;var V=y(N),B=V&&j.get(V);if(!B)return N;var ee=n(B),ne=e(N),te=s(Array.from(ee),function(k){var U=p(k,2),K=U[0],re=U[1];return"rtx"===re||$.includes(re)?[]:function(N,j,$,V,B){var ee=$.get(N)||[];if(ee.length<=1)return ee;var ne=l(j,B);if(!ne)return ee;var te=ee.find(function(W){var F=l(W,V);return F&&Object.keys(ne).every(function(O){return ne[O]===F[O]})});return"number"==typeof te?[te]:ee}(re,K,ne,N,B)}),W=ne.get("rtx")||[];te=te.concat(W.filter(function(k){var U=l(k,N);return U&&te.includes(U.apt)}));var F=N.split("\r\n").filter(function(k){var U=k.match(/^a=(rtpmap|fmtp|rtcp-fb):(.+) .+$/),K=U&&U[2];return!U||K&&te.includes(parseInt(K,10))});return u(b(N).filter(function(k){return te.includes(k)}),F.join("\r\n"))}(ee,B,[])})).join("\r\n")},w.getMediaSections=_,w.removeSSRCAttributes=function(N,j){return N.split("\r\n").filter(function($){return!j.find(function(V){return new RegExp("a=ssrc:.*"+V+":","g").test($)})}).join("\r\n")},w.revertSimulcast=function(N,j,$,V){void 0===V&&(V=!1);var B=r($),ee=r(j),ne=_(N);return[N.split("\r\nm=")[0]].concat(ne.map(function(W){if(W=W.replace(/\r\n$/,""),!/^m=video/.test(W))return W;var F=W.match(/^a=mid:(.+)$/m),O=F&&F[1];if(!O)return W;var k=B.get(O),U=n(k),K=b(k),re=K.length&&"vp8"===U.get(K[0]);return V||!re?ee.get(O).replace(/\r\n$/,""):W})).concat("").join("\r\n")},w.setCodecPreferences=function(N,j,$){var V=_(N);return[N.split("\r\nm=")[0]].concat(V.map(function(ee){if(!/^m=(audio|video)/.test(ee))return ee;var ne=ee.match(/^m=(audio|video)/)[1],te=e(ee),F=function(N,j){j=j.map(function(ee){return ee.codec.toLowerCase()});var $=s(j,function(ee){return N.get(ee)||[]}),V=o(Array.from(N.keys()),j),B=s(V,function(ee){return N.get(ee)});return $.concat(B)}(te,"audio"===ne?j:$),O=u(F,ee),k=te.get("pcma")||[],U=te.get("pcmu")||[];return("audio"===ne?new Set(k.concat(U)):new Set).has(F[0])?O.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):O})).join("\r\n")},w.setSimulcast=function(N,j){var $=_(N);return[N.split("\r\nm=")[0]].concat($.map(function(B){if(B=B.replace(/\r\n$/,""),!/^m=video/.test(B))return B;var ee=e(B),ne=b(B),te=new Set(ee.get("vp8")||[]);return ne.some(function(F){return te.has(F)})?i(B,j):B})).concat("").join("\r\n")}},556:(C,w,a)=>{"use strict";var p=a(4135).RTCSessionDescription,h=a(3028),o=h.createPtToCodecName,s=h.getMediaSections;function e(u){var c=o(u);u=function(u,c){return Array.from(c.keys()).reduce(function(v,g){var A=new RegExp("^a=rtpmap:"+g+" rtx.+$","gm");return(v.match(A)||[]).slice("rtx"===c.get(g)?1:0).reduce(function(P,L){var R=new RegExp("\r\n"+L),E=new RegExp("\r\na=fmtp:"+g+" apt=[0-9]+");return P.replace(R,"").replace(E,"")},v)},u)}(u,c);var v=function(u){var c=new Map;return u.forEach(function(v,g){var A=c.get(v)||new Set;return c.set(v,A.add(g))}),c}(c),g=v.get("rtx")||new Set,A=new Set,L=function(u,c){var v=Array.from(u).reduce(function(g,A){var P=A[0],L=A[1],R=g.get(L)||new Set;return g.set(L,R.add(P))},new Map);return Array.from(v).reduce(function(g,A){var P=A[0],L=Array.from(A[1]);return L.length>1?(L.forEach(function(R){c.add(R)}),g):g.set(P,L[0])},new Map)}(function(u,c,v,g){return Array.from(v).reduce(function(A,P){var L=new RegExp("a=fmtp:"+P+" apt=(\\d+)"),R=u.match(L);if(!R)return g.add(P),A;var E=Number.parseInt(R[1]);return c.has(E)?"rtx"===c.get(E)?(g.add(P),A):A.set(P,E):(g.add(P),A)},new Map)}(u,c,g,A),A),R=Array.from(A);return["h264","vp8","vp9"].reduce(function(T,x){var M=v.get(x)||new Set;return Array.from(M).reduce(function(N,j){return L.has(j)?N:N.add(j)},T)},new Set).forEach(function(T){if(R.length){var x=R.shift();u=function(u,c,v){return u.endsWith("\r\n")?u+"a=fmtp:"+c+" apt="+v+"\r\n":u+"\r\na=fmtp:"+c+" apt="+v}(u=_(u,x),x,T)}}),R.forEach(function(T){u=function(u,c){var v=new RegExp("a=rtpmap:"+c+".*\r\n","gm");return u.replace(v,"")}(u=_(u,T),T)}),u}function _(u,c){var v=new RegExp("a=fmtp:"+c+".*\r\n","gm");return u.replace(v,"")}C.exports=function(u){var c={type:u.type};return"rollback"!==u.type&&(c.sdp=function(u){var c=s(u);return[u.split("\r\nm=")[0]].concat(c.map(e)).join("\r\n")}(u.sdp)),new p(c)}},8726:function(C,w,a){"use strict";var p=this&&this.__read||function(f,u){var c="function"==typeof Symbol&&f[Symbol.iterator];if(!c)return f;var g,P,v=c.call(f),A=[];try{for(;(void 0===u||u-- >0)&&!(g=v.next()).done;)A.push(g.value)}catch(L){P={error:L}}finally{try{g&&!g.done&&(c=v.return)&&c.call(v)}finally{if(P)throw P.error}}return A},h=a(3761),o=h.difference,s=h.flatMap;function i(){return String(Math.floor(4294967295*Math.random()))}var t=function(){function f(u,c,v){Object.defineProperties(this,{cName:{enumerable:!0,value:v},isSimulcastEnabled:{enumerable:!0,value:!1,writable:!0},primarySSRCs:{enumerable:!0,value:new Set},rtxPairs:{enumerable:!0,value:new Map},streamId:{enumerable:!0,value:c},trackId:{enumerable:!0,value:u}})}return f.prototype.addSimulcastSSRCs=function(){if(!this.isSimulcastEnabled){var u=[i(),i()];u.forEach(function(c){this.primarySSRCs.add(c)},this),this.rtxPairs.size&&u.forEach(function(c){this.rtxPairs.set(i(),c)},this)}},f.prototype.addSSRC=function(u,c,v){c?this.rtxPairs.set(u,c):this.primarySSRCs.add(u),this.isSimulcastEnabled=this.isSimulcastEnabled||v},f.prototype.toSdpLines=function(u){var c=this,v=u?[]:Array.from(this.rtxPairs.entries()).map(function(E){return E.reverse()}),g=Array.from(this.primarySSRCs.values()),A=v.length?s(v):g,P=s(A,function(E){return["a=ssrc:"+E+" cname:"+c.cName,"a=ssrc:"+E+" msid:"+c.streamId+" "+c.trackId]}),L=v.map(function(E){return"a=ssrc-group:FID "+E.join(" ")}),R=["a=ssrc-group:SIM "+g.join(" ")];return L.concat(P).concat(R)},f}();function e(f,u){return(f.match(new RegExp(u,"gm"))||[]).map(function(v){return(v.match(new RegExp(u))||[]).slice(1)})}C.exports=function(f,u){var c=function(f){var u=function(f){return new Set(s(e(f,"^a=ssrc-group:SIM ([0-9]+) ([0-9]+) ([0-9]+)$")))}(f),c=function(f){return new Map(e(f,"^a=ssrc-group:FID ([0-9]+) ([0-9]+)$").map(function(c){return c.reverse()}))}(f);return function(f){var u=p(s(e(f,"^a=msid:(.+) (.+)$")),2),c=u[0],v=u[1];return s(e(f,"^a=ssrc:(.+) cname:.+$")).map(function(A){return[A,c,v]})}(f).reduce(function(g,A){var P=A[0],L=A[1],R=A[2],E=g.get(R)||new t(R,L,function(f,u,c){return f.match(new RegExp("a=ssrc:"+u+" cname:(.+)"))[1]}(f,P)),S=c.get(P)||null;return E.addSSRC(P,S,u.has(P)),g.set(R,E)},new Map)}(f),v=Array.from(c.keys()),g=Array.from(u.keys()),A=o(v,g),P=o(g,v);s(A,function(N){return c.get(N)}).forEach(function(N){N.addSimulcastSSRCs(),u.set(N.trackId,N)}),g=Array.from(u.keys());var R=o(g,P),E=s(R,function(N){return u.get(N)}),S=!f.match(/a=rtpmap:[0-9]+ rtx/),T=s(E,function(N){return N.toSdpLines(S)}),x=s(new Set(f.split("\r\n").concat(T))),M="a=x-google-flag:conference";return f.match(M)||x.push(M),x.join("\r\n")}},5612:(C,w,a)=>{"use strict";var p=a(3028).getMediaSections,h=function(){function o(){Object.defineProperties(this,{_midsToTrackIds:{value:new Map,writable:!0}})}return o.prototype.match=function(s){return this._midsToTrackIds.get(s.transceiver.mid)||null},o.prototype.update=function(s){var i=p(s,"(audio|video)");this._midsToTrackIds=i.reduce(function(t,e){var r=e.match(/^a=mid:(.+)$/m)||[],n=e.match(/^a=msid:.+ (.+)$/m)||[],l=r[1],y=n[1];return l&&y?t.set(l,y):t},this._midsToTrackIds)},o}();C.exports=h},3187:(C,w)=>{var a="1234567890abcdef";function h(o){for(var s="",i=0;i<32;i++)s+=a.charAt(Math.floor(Math.random()*a.length));return""+o+s}w.sessionSID=h("SS"),w.createSID=h},563:(C,w,a)=>{"use strict";var p=a(4911),h=p.guessBrowser,o=p.support,s=a(1222),i=s.isAndroid,t=s.isMobile,e=s.isNonChromiumEdge,r=s.rebrandedChromeBrowser,n=s.mobileWebKitBrowser,l=["crios","edg","edge","electron","headlesschrome"],y=["chrome","firefox"],_=["chrome","safari"],b=[];C.exports=function(){var u=h();if(!u)return!1;var c=r(u),v=n(u),g=i()?y:_;return!!u&&o()&&(!c||l.includes(c))&&!e(u)&&(!v||b.includes(v))&&(!t()||g.includes(u))}},1190:C=>{"use strict";var w=function(){function a(p,h,o){void 0===o&&(o=!0),Object.defineProperties(this,{_delay:{value:h,writable:!0},_fn:{value:p},_timeout:{value:null,writable:!0}}),o&&this.start()}return Object.defineProperty(a.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isSet",{get:function(){return!!this._timeout},enumerable:!1,configurable:!0}),a.prototype.setDelay=function(p){this._delay=p},a.prototype.start=function(){var p=this;this.isSet||(this._timeout=setTimeout(function(){var h=p._fn;p.clear(),h()},this._delay))},a.prototype.clear=function(){clearTimeout(this._timeout),this._timeout=null},a.prototype.reset=function(){this.clear(),this.start()},a}();C.exports=w},7061:function(C,w,a){"use strict";var H,p=this&&this.__extends||(H=function(D,Q){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(me,fe){me.__proto__=fe}||function(me,fe){for(var xe in fe)Object.prototype.hasOwnProperty.call(fe,xe)&&(me[xe]=fe[xe])})(D,Q)},function(D,Q){if("function"!=typeof Q&&null!==Q)throw new TypeError("Class extends value "+String(Q)+" is not a constructor or null");function me(){this.constructor=D}H(D,Q),D.prototype=null===Q?Object.create(Q):(me.prototype=Q.prototype,new me)}),h=a(8208),o={};w.createTwilioError=function(D,Q){return Q="string"==typeof Q&&Q?Q:"Unknown error",o[D="number"==typeof D?D:0]?new o[D]:new h(D,Q)};var s=function(H){function D(){var Q=H.call(this,20101,"Invalid Access Token")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenInvalidError=s,Object.defineProperty(o,20101,{value:s});var i=function(H){function D(){var Q=H.call(this,20102,"Invalid Access Token header")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenHeaderInvalidError=i,Object.defineProperty(o,20102,{value:i});var t=function(H){function D(){var Q=H.call(this,20103,"Invalid Access Token issuer/subject")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenIssuerInvalidError=t,Object.defineProperty(o,20103,{value:t});var e=function(H){function D(){var Q=H.call(this,20104,"Access Token expired or expiration date invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenExpiredError=e,Object.defineProperty(o,20104,{value:e});var r=function(H){function D(){var Q=H.call(this,20105,"Access Token not yet valid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenNotYetValidError=r,Object.defineProperty(o,20105,{value:r});var n=function(H){function D(){var Q=H.call(this,20106,"Invalid Access Token grants")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenGrantsInvalidError=n,Object.defineProperty(o,20106,{value:n});var l=function(H){function D(){var Q=H.call(this,20107,"Invalid Access Token signature")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.AccessTokenSignatureInvalidError=l,Object.defineProperty(o,20107,{value:l});var y=function(H){function D(){var Q=H.call(this,53e3,"Signaling connection error")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingConnectionError=y,Object.defineProperty(o,53e3,{value:y});var _=function(H){function D(){var Q=H.call(this,53001,"Signaling connection disconnected")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingConnectionDisconnectedError=_,Object.defineProperty(o,53001,{value:_});var b=function(H){function D(){var Q=H.call(this,53002,"Signaling connection timed out")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingConnectionTimeoutError=b,Object.defineProperty(o,53002,{value:b});var f=function(H){function D(){var Q=H.call(this,53003,"Client received an invalid signaling message")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingIncomingMessageInvalidError=f,Object.defineProperty(o,53003,{value:f});var u=function(H){function D(){var Q=H.call(this,53004,"Client sent an invalid signaling message")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingOutgoingMessageInvalidError=u,Object.defineProperty(o,53004,{value:u});var c=function(H){function D(){var Q=H.call(this,53006,"Video server is busy")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.SignalingServerBusyError=c,Object.defineProperty(o,53006,{value:c});var v=function(H){function D(){var Q=H.call(this,53100,"Room name is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomNameInvalidError=v,Object.defineProperty(o,53100,{value:v});var g=function(H){function D(){var Q=H.call(this,53101,"Room name is too long")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomNameTooLongError=g,Object.defineProperty(o,53101,{value:g});var A=function(H){function D(){var Q=H.call(this,53102,"Room name contains invalid characters")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomNameCharsInvalidError=A,Object.defineProperty(o,53102,{value:A});var P=function(H){function D(){var Q=H.call(this,53103,"Unable to create Room")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomCreateFailedError=P,Object.defineProperty(o,53103,{value:P});var L=function(H){function D(){var Q=H.call(this,53104,"Unable to connect to Room")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomConnectFailedError=L,Object.defineProperty(o,53104,{value:L});var R=function(H){function D(){var Q=H.call(this,53105,"Room contains too many Participants")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomMaxParticipantsExceededError=R,Object.defineProperty(o,53105,{value:R});var E=function(H){function D(){var Q=H.call(this,53106,"Room not found")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomNotFoundError=E,Object.defineProperty(o,53106,{value:E});var S=function(H){function D(){var Q=H.call(this,53107,"MaxParticipants is out of range")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomMaxParticipantsOutOfRangeError=S,Object.defineProperty(o,53107,{value:S});var T=function(H){function D(){var Q=H.call(this,53108,"RoomType is not valid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomTypeInvalidError=T,Object.defineProperty(o,53108,{value:T});var x=function(H){function D(){var Q=H.call(this,53109,"Timeout is out of range")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomTimeoutOutOfRangeError=x,Object.defineProperty(o,53109,{value:x});var M=function(H){function D(){var Q=H.call(this,53110,"StatusCallbackMethod is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomStatusCallbackMethodInvalidError=M,Object.defineProperty(o,53110,{value:M});var N=function(H){function D(){var Q=H.call(this,53111,"StatusCallback is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomStatusCallbackInvalidError=N,Object.defineProperty(o,53111,{value:N});var j=function(H){function D(){var Q=H.call(this,53112,"Status is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomStatusInvalidError=j,Object.defineProperty(o,53112,{value:j});var $=function(H){function D(){var Q=H.call(this,53113,"Room exists")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomRoomExistsError=$,Object.defineProperty(o,53113,{value:$});var V=function(H){function D(){var Q=H.call(this,53114,"Room creation parameter(s) incompatible with the Room type")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomInvalidParametersError=V,Object.defineProperty(o,53114,{value:V});var B=function(H){function D(){var Q=H.call(this,53115,"MediaRegion is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomMediaRegionInvalidError=B,Object.defineProperty(o,53115,{value:B});var ee=function(H){function D(){var Q=H.call(this,53116,"There are no media servers available in the MediaRegion")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomMediaRegionUnavailableError=ee,Object.defineProperty(o,53116,{value:ee});var ne=function(H){function D(){var Q=H.call(this,53117,"The subscription operation requested is not supported for the Room type")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomSubscriptionOperationNotSupportedError=ne,Object.defineProperty(o,53117,{value:ne});var te=function(H){function D(){var Q=H.call(this,53118,"Room completed")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomCompletedError=te,Object.defineProperty(o,53118,{value:te});var W=function(H){function D(){var Q=H.call(this,53124,"The AudioOnly flag is not supported for the Room type")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomAudioOnlyFlagNotSupportedError=W,Object.defineProperty(o,53124,{value:W});var F=function(H){function D(){var Q=H.call(this,53125,"The track kind is not supported by the Room")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.RoomTrackKindNotSupportedError=F,Object.defineProperty(o,53125,{value:F});var O=function(H){function D(){var Q=H.call(this,53200,"Participant identity is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantIdentityInvalidError=O,Object.defineProperty(o,53200,{value:O});var k=function(H){function D(){var Q=H.call(this,53201,"Participant identity is too long")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantIdentityTooLongError=k,Object.defineProperty(o,53201,{value:k});var U=function(H){function D(){var Q=H.call(this,53202,"Participant identity contains invalid characters")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantIdentityCharsInvalidError=U,Object.defineProperty(o,53202,{value:U});var K=function(H){function D(){var Q=H.call(this,53203,"The maximum number of published tracks allowed in the Room at the same time has been reached")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantMaxTracksExceededError=K,Object.defineProperty(o,53203,{value:K});var re=function(H){function D(){var Q=H.call(this,53204,"Participant not found")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantNotFoundError=re,Object.defineProperty(o,53204,{value:re});var J=function(H){function D(){var Q=H.call(this,53205,"Participant disconnected because of duplicate identity")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ParticipantDuplicateIdentityError=J,Object.defineProperty(o,53205,{value:J});var q=function(H){function D(){var Q=H.call(this,53300,"Track is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackInvalidError=q,Object.defineProperty(o,53300,{value:q});var le=function(H){function D(){var Q=H.call(this,53301,"Track name is invalid")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackNameInvalidError=le,Object.defineProperty(o,53301,{value:le});var ve=function(H){function D(){var Q=H.call(this,53302,"Track name is too long")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackNameTooLongError=ve,Object.defineProperty(o,53302,{value:ve});var _e=function(H){function D(){var Q=H.call(this,53303,"Track name contains invalid characters")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackNameCharsInvalidError=_e,Object.defineProperty(o,53303,{value:_e});var Pe=function(H){function D(){var Q=H.call(this,53304,"Track name is duplicated")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackNameIsDuplicatedError=Pe,Object.defineProperty(o,53304,{value:Pe});var be=function(H){function D(){var Q=H.call(this,53305,"The server has reached capacity and cannot fulfill this request")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.TrackServerTrackCapacityReachedError=be,Object.defineProperty(o,53305,{value:be});var we=function(H){function D(){var Q=H.call(this,53400,"Client is unable to create or apply a local media description")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaClientLocalDescFailedError=we,Object.defineProperty(o,53400,{value:we});var Se=function(H){function D(){var Q=H.call(this,53401,"Server is unable to create or apply a local media description")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaServerLocalDescFailedError=Se,Object.defineProperty(o,53401,{value:Se});var Le=function(H){function D(){var Q=H.call(this,53402,"Client is unable to apply a remote media description")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaClientRemoteDescFailedError=Le,Object.defineProperty(o,53402,{value:Le});var Ce=function(H){function D(){var Q=H.call(this,53403,"Server is unable to apply a remote media description")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaServerRemoteDescFailedError=Ce,Object.defineProperty(o,53403,{value:Ce});var Oe=function(H){function D(){var Q=H.call(this,53404,"No supported codec")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaNoSupportedCodecError=Oe,Object.defineProperty(o,53404,{value:Oe});var ue=function(H){function D(){var Q=H.call(this,53405,"Media connection failed or Media activity ceased")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaConnectionError=ue,Object.defineProperty(o,53405,{value:ue});var Z=function(H){function D(){var Q=H.call(this,53407,"Media connection failed due to DTLS handshake failure")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.MediaDTLSTransportFailedError=Z,Object.defineProperty(o,53407,{value:Z});var ie=function(H){function D(){var Q=H.call(this,53500,"Unable to acquire configuration")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ConfigurationAcquireFailedError=ie,Object.defineProperty(o,53500,{value:ie});var ae=function(H){function D(){var Q=H.call(this,53501,"Unable to acquire TURN credentials")||this;return Object.setPrototypeOf(Q,D.prototype),Q}return p(D,H),D}(h);w.ConfigurationAcquireTurnFailedError=ae,Object.defineProperty(o,53501,{value:ae})},8208:function(C){"use strict";var o,w=this&&this.__extends||(o=function(s,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(s,i)},function(s,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=s}o(s,i),s.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),a=this&&this.__read||function(o,s){var i="function"==typeof Symbol&&o[Symbol.iterator];if(!i)return o;var e,n,t=i.call(o),r=[];try{for(;(void 0===s||s-- >0)&&!(e=t.next()).done;)r.push(e.value)}catch(l){n={error:l}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}return r},p=this&&this.__spreadArray||function(o,s){for(var i=0,t=s.length,e=o.length;i<t;i++,e++)o[e]=s[i];return o},h=function(o){function s(i){var t=this,e=[].slice.call(arguments,1);t=o.apply(this,p([],a(e)))||this,Object.setPrototypeOf(t,s.prototype);var r=Error.apply(t,e);return r.name="TwilioError",Object.defineProperty(t,"code",{value:i,enumerable:!0}),Object.getOwnPropertyNames(r).forEach(function(n){Object.defineProperty(this,n,{value:r[n],enumerable:!0})},t),t}return w(s,o),s.prototype.toString=function(){return this.name+" "+this.code+(this.message?": "+this.message:"")},s}(Error);C.exports=h},6901:(C,w,a)=>{"use strict";var h=a(3761).isNonArrayObject,o=a(9917),s=o.typeErrors,i=o.clientTrackSwitchOffControl,t=o.videoContentPreferencesMode,e=o.subscriptionMode,r=o.trackPriority,n=o.trackSwitchOffMode;function _(f,u,c){return void 0===c&&(c=[]),void 0===f?null:null!==f&&h(f)?c.reduce(function(v,g){var A=g.prop,P=g.type,L=g.values;if(v||!(A in f))return v;var R=f[A];return P&&typeof R!==P||"number"===P&&isNaN(R)?s.INVALID_TYPE(u+"."+A,P):Array.isArray(L)&&!L.includes(R)?s.INVALID_VALUE(u+"."+A,L):v},null):s.INVALID_TYPE(u,"object")}w.kG=function(f){var u=_(f,"options.bandwidthProfile");return!f||u||(u=_(f.video,"options.bandwidthProfile.video",[{prop:"contentPreferencesMode",values:Object.values(t)},{prop:"dominantSpeakerPriority",values:Object.values(r)},{prop:"maxSubscriptionBitrate",type:"number"},{prop:"maxTracks",type:"number"},{prop:"mode",values:Object.values(e)},{prop:"clientTrackSwitchOffControl",values:Object.values(i)},{prop:"trackSwitchOffMode",values:Object.values(n)}]))?u:f.video?"maxTracks"in f.video&&"clientTrackSwitchOffControl"in f.video?new TypeError("options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead."):"renderDimensions"in f.video&&"contentPreferencesMode"in f.video?new TypeError("options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead."):function(f){var u="options.bandwidthProfile.video.renderDimensions",c=_(f,u);return f?c||Object.values(r).reduce(function(v,g){return v||_(f[g],u+"."+g,[{prop:"height",type:"number"},{prop:"width",type:"number"}])},null):c}(f.video.renderDimensions):null},w.Wv=function(f,u){if(!(f instanceof u.LocalAudioTrack||f instanceof u.LocalDataTrack||f instanceof u.LocalVideoTrack||f instanceof u.MediaStreamTrack))throw s.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")}},6828:C=>{var w=function(){},a="undefined",p=typeof window!==a&&typeof window.navigator!==a&&/Trident\/|MSIE /.test(window.navigator.userAgent),h=["trace","debug","info","warn","error"];function o(b,f){var u=b[f];if("function"==typeof u.bind)return u.bind(b);try{return Function.prototype.bind.call(u,b)}catch(c){return function(){return Function.prototype.apply.apply(u,[b,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function i(b){return"debug"===b&&(b="log"),typeof console!==a&&("trace"===b&&p?s:void 0!==console[b]?o(console,b):void 0!==console.log?o(console,"log"):w)}function t(b,f){for(var u=0;u<h.length;u++){var c=h[u];this[c]=u<b?w:this.methodFactory(c,b,f)}this.log=this.debug}function e(b,f,u){return function(){typeof console!==a&&(t.call(this,f,u),this[b].apply(this,arguments))}}function r(b,f,u){return i(b)||e.apply(this,arguments)}function n(b,f,u){var v,c=this,g="loglevel";function P(){var R;if(typeof window!==a&&g){try{R=window.localStorage[g]}catch(T){}if(typeof R===a)try{var E=window.document.cookie,S=E.indexOf(encodeURIComponent(g)+"=");-1!==S&&(R=/^([^;]+)/.exec(E.slice(S))[1])}catch(T){}return void 0===c.levels[R]&&(R=void 0),R}}"string"==typeof b?g+=":"+b:"symbol"==typeof b&&(g=void 0),c.name=b,c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=u||r,c.getLevel=function(){return v},c.setLevel=function(R,E){if("string"==typeof R&&void 0!==c.levels[R.toUpperCase()]&&(R=c.levels[R.toUpperCase()]),!("number"==typeof R&&R>=0&&R<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+R;if(v=R,!1!==E&&function(R){var E=(h[R]||"silent").toUpperCase();if(typeof window!==a&&g){try{return void(window.localStorage[g]=E)}catch(S){}try{window.document.cookie=encodeURIComponent(g)+"="+E+";"}catch(S){}}}(R),t.call(c,R,b),typeof console===a&&R<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(R){P()||c.setLevel(R,!1)},c.enableAll=function(R){c.setLevel(c.levels.TRACE,R)},c.disableAll=function(R){c.setLevel(c.levels.SILENT,R)};var L=P();null==L&&(L=null==f?"WARN":f),c.setLevel(L,!1)}var l=new n,y={};l.getLogger=function(f){if("symbol"!=typeof f&&"string"!=typeof f||""===f)throw new TypeError("You must supply a name when creating a logger.");var u=y[f];return u||(u=y[f]=new n(f,l.getLevel(),l.methodFactory)),u};var _=typeof window!==a?window.log:void 0;l.noConflict=function(){return typeof window!==a&&window.log===l&&(window.log=_),l},l.getLoggers=function(){return y},l.default=l,C.exports=l},9057:C=>{"use strict";var w="undefined"!=typeof AudioContext?AudioContext:"undefined"!=typeof webkitAudioContext?webkitAudioContext:null,a=function(){function p(h){h=Object.assign({AudioContext:w},h),Object.defineProperties(this,{_AudioContext:{value:h.AudioContext},_audioContext:{value:null,writable:!0},_holders:{value:new Set},AudioContextFactory:{enumerable:!0,value:p}})}return p.prototype.getOrCreate=function(h){if(!this._holders.has(h)&&(this._holders.add(h),this._AudioContext&&!this._audioContext))try{this._audioContext=new this._AudioContext}catch(o){}return this._audioContext},p.prototype.release=function(h){this._holders.has(h)&&(this._holders.delete(h),!this._holders.size&&this._audioContext&&(this._audioContext.close(),this._audioContext=null))},p}();C.exports=new a},1923:C=>{"use strict";C.exports=function(p,h,o){o="number"==typeof o?o:250;var s=p.createMediaStreamSource(h),i=p.createAnalyser();i.fftSize=2048,s.connect(i);var t=new Uint8Array(i.fftSize),e=!1;return setTimeout(function(){e=!0},o),function r(){return e?Promise.resolve(!0):(i.getByteTimeDomainData(t),t.some(function(n){return 128!==n&&0!==n})?Promise.resolve(!1):function(p){return p="number"==typeof p?p:0,new Promise(function(h){return setTimeout(h,p)})}().then(r))}().then(function(n){return s.disconnect(),n},function(n){throw s.disconnect(),n})}},8201:(C,w,a)=>{"use strict";var p=a(1923);C.exports=function(o,s,i,t,e){t="number"==typeof t?t:3;var r=0,n=a(9057),l={},y=n.getOrCreate(l);return function _(){return s(i).then(function(b){return(i.audio?p(y,b,e).catch(function(u){return o.warn("Encountered an error while detecting silence",u),!0}):Promise.resolve(!1)).then(function(u){return u?t<=0?(o.warn("Got a silent audio MediaStreamTrack. Normally we would try to get a new one, but we've run out of retries; returning it anyway."),b):(o.warn("Got a silent audio MediaStreamTrack. Stopping all MediaStreamTracks and calling getUserMedia again. This is retry #"+ ++r+"."),b.getTracks().forEach(function(c){return c.stop()}),t--,_()):(o.info("Got a non-silent audio MediaStreamTrack; returning it."),b)})})}().then(function(b){return n.release(l),b},function(b){throw n.release(l),b})}},633:(C,w,a)=>{"use strict";var p=a(4911).flatMap,h=a(4911).guessBrowser,o=a(4911).guessBrowserVersion,s=a(1225).getSdpFormat,i=h(),t=o(),e="chrome"===i,r="firefox"===i,n="safari"===i,l=e?t.major:null;function u(S){var T=Array.from(S.values()).find(function(B){return"candidate-pair"===B.type&&B.nominated});if(!T)return null;var x=S.get(T.localCandidateId),M=S.get(T.remoteCandidateId),N=[{key:"candidateType",type:"string"},{key:"ip",type:"string"},{key:"port",type:"number"},{key:"priority",type:"number"},{key:"protocol",type:"string"},{key:"url",type:"string"}],j=N.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),$=x?j.reduce(function(B,ee){return B[ee.key]=typeof x[ee.key]===ee.type?x[ee.key]:"deleted"!==ee.key&&null,B},{}):null,V=M?N.reduce(function(B,ee){return B[ee.key]=typeof M[ee.key]===ee.type?M[ee.key]:null,B},{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string",fixup:function(B){return"inprogress"===B?"in-progress":B}},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce(function(B,ee){return B[ee.key]=typeof T[ee.key]===ee.type?ee.fixup?ee.fixup(T[ee.key]):T[ee.key]:null,B},{localCandidate:$,remoteCandidate:V})}function c(S){var T=Array.from(S.values()).find(function(ee){return"candidate-pair"===ee.type&&ee.nominated});if(!T)return null;var x=S.get(T.localCandidateId),M=S.get(T.remoteCandidateId),N=[{key:"candidateType",type:"string"},{key:"ip",ffKeys:["address","ipAddress"],type:"string"},{key:"port",ffKeys:["portNumber"],type:"number"},{key:"priority",type:"number"},{key:"protocol",ffKeys:["transport"],type:"string"},{key:"url",type:"string"}],j=N.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),$={host:"host",peerreflexive:"prflx",relayed:"relay",serverreflexive:"srflx"},V=x?j.reduce(function(ee,ne){var te=ne.ffKeys&&ne.ffKeys.find(function(W){return W in x})||ne.key;return ee[ne.key]=typeof x[te]===ne.type?"candidateType"===te&&$[x[te]]||x[te]:"deleted"!==te&&null,ee},{}):null,B=M?N.reduce(function(ee,ne){var te=ne.ffKeys&&ne.ffKeys.find(function(W){return W in M})||ne.key;return ee[ne.key]=typeof M[te]===ne.type?"candidateType"===te&&$[M[te]]||M[te]:null,ee},{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string"},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce(function(ee,ne){return ee[ne.key]=typeof T[ne.key]===ne.type?T[ne.key]:null,ee},{localCandidate:V,remoteCandidate:B})}function v(S,T,x){var M="local"===x?"getSenders":"getReceivers";return S[M]?S[M]().map(function(j){return j.track}).filter(function(j){return j&&j.kind===T}):p(S["local"===x?"getLocalStreams":"getRemoteStreams"](),function(j){return j["audio"===T?"getAudioTracks":"getVideoTracks"]()})}function A(S,T){return new Promise(function(x,M){l&&l<67?S.getStats(function(N){x([L(N,T)])},null,M):S.getStats(T).then(function(N){x(function(S){var T=null,x=[],M=null,N=null,j=null,$=null,V=null;S.forEach(function(W){switch(W.type){case"inbound-rtp":T=W;break;case"outbound-rtp":x.push(W);break;case"media-source":V=W;break;case"track":j=W;break;case"codec":$=W;break;case"remote-inbound-rtp":M=W;break;case"remote-outbound-rtp":N=W}});var B=j&&j.remoteSource,ne=[],te=B?N:M;return(B?[T]:x).forEach(function(W){var F={},O=[W,V,j,$,te&&te.ssrc===W.ssrc?te:null];function k(me){var fe=O.find(function(xe){return xe&&void 0!==xe[me]})||null;return fe?fe[me]:null}var U=k("ssrc");"number"==typeof U&&(F.ssrc=String(U));var K=k("timestamp");F.timestamp=Math.round(K);var re=k("mimeType");"string"==typeof re&&(re=re.split("/"),F.codecName=re[re.length-1]);var J=k("roundTripTime");"number"==typeof J&&(F.roundTripTime=Math.round(1e3*J));var q=k("jitter");"number"==typeof q&&(F.jitter=Math.round(1e3*q));var le=k("frameWidth");"number"==typeof le&&(B?F.frameWidthReceived=le:(F.frameWidthSent=le,F.frameWidthInput=j.frameWidth));var ve=k("frameHeight");"number"==typeof ve&&(B?F.frameHeightReceived=ve:(F.frameHeightSent=ve,F.frameHeightInput=j.frameHeight));var _e=k("framesPerSecond");"number"==typeof _e&&(F[B?"frameRateReceived":"frameRateSent"]=_e);var Pe=k("bytesReceived");"number"==typeof Pe&&(F.bytesReceived=Pe);var be=k("bytesSent");"number"==typeof be&&(F.bytesSent=be);var we=k("packetsLost");"number"==typeof we&&(F.packetsLost=we);var Se=k("packetsReceived");"number"==typeof Se&&(F.packetsReceived=Se);var Le=k("packetsSent");"number"==typeof Le&&(F.packetsSent=Le);var Ce=k("audioLevel");"number"==typeof Ce&&(Ce=Math.round(32767*Ce),B?F.audioOutputLevel=Ce:F.audioInputLevel=Ce);var Oe=k("totalPacketSendDelay");"number"==typeof Oe&&(F.totalPacketSendDelay=Oe);var ue=k("totalEncodeTime");"number"==typeof ue&&(F.totalEncodeTime=ue);var Z=k("framesEncoded");"number"==typeof Z&&(F.framesEncoded=Z);var ie=k("estimatedPlayoutTimestamp");"number"==typeof ie&&(F.estimatedPlayoutTimestamp=ie);var ae=k("totalDecodeTime");"number"==typeof ae&&(F.totalDecodeTime=ae);var H=k("framesDecoded");"number"==typeof H&&(F.framesDecoded=H);var D=k("jitterBufferDelay");"number"==typeof D&&(F.jitterBufferDelay=D);var Q=k("jitterBufferEmittedCount");"number"==typeof Q&&(F.jitterBufferEmittedCount=Q),ne.push(F)}),ne}(N))},M)})}function L(S,T){var x=S.result().find(function(N){return"ssrc"===N.type&&N.stat("googTrackId")===T.id}),M={};return x&&(M.timestamp=Math.round(Number(x.timestamp)),M=x.names().reduce(function(N,j){switch(j){case"googCodecName":N.codecName=x.stat(j);break;case"googRtt":N.roundTripTime=Number(x.stat(j));break;case"googJitterReceived":N.jitter=Number(x.stat(j));break;case"googFrameWidthInput":N.frameWidthInput=Number(x.stat(j));break;case"googFrameHeightInput":N.frameHeightInput=Number(x.stat(j));break;case"googFrameWidthSent":N.frameWidthSent=Number(x.stat(j));break;case"googFrameHeightSent":N.frameHeightSent=Number(x.stat(j));break;case"googFrameWidthReceived":N.frameWidthReceived=Number(x.stat(j));break;case"googFrameHeightReceived":N.frameHeightReceived=Number(x.stat(j));break;case"googFrameRateInput":N.frameRateInput=Number(x.stat(j));break;case"googFrameRateSent":N.frameRateSent=Number(x.stat(j));break;case"googFrameRateReceived":N.frameRateReceived=Number(x.stat(j));break;case"ssrc":N[j]=x.stat(j);break;case"bytesReceived":case"bytesSent":case"packetsLost":case"packetsReceived":case"packetsSent":case"audioInputLevel":case"audioOutputLevel":N[j]=Number(x.stat(j))}return N},M)),M}function E(S,T){S=S||new Map;var x=null,M=null;S.forEach(function(Se){if(!Se.isRemote)switch(Se.type){case"inbound-rtp":x=Se,M=S.get(Se.remoteId);break;case"outbound-rtp":M=Se,x=S.get(Se.remoteId)}});var N=T?x:M,j=T?M:x;function $(Se){return N&&void 0!==N[Se]?N[Se]:j&&void 0!==j[Se]?j[Se]:null}var V={},B=$("timestamp");V.timestamp=Math.round(B);var ee=$("ssrc");"number"==typeof ee&&(V.ssrc=String(ee));var ne=$("bytesSent");"number"==typeof ne&&(V.bytesSent=ne);var te=$("packetsLost");"number"==typeof te&&(V.packetsLost=te);var W=$("packetsSent");"number"==typeof W&&(V.packetsSent=W);var F=$("roundTripTime");"number"==typeof F&&(V.roundTripTime=Math.round(1e3*F));var O=$("jitter");"number"==typeof O&&(V.jitter=Math.round(1e3*O));var k=$("framerateMean");"number"==typeof k&&(V.frameRateSent=Math.round(k));var U=$("bytesReceived");"number"==typeof U&&(V.bytesReceived=U);var K=$("packetsReceived");"number"==typeof K&&(V.packetsReceived=K);var re=$("framerateMean");"number"==typeof re&&(V.frameRateReceived=Math.round(re));var J=$("totalPacketSendDelay");"number"==typeof J&&(V.totalPacketSendDelay=J);var q=$("totalEncodeTime");"number"==typeof q&&(V.totalEncodeTime=q);var le=$("framesEncoded");"number"==typeof le&&(V.framesEncoded=le);var ve=$("estimatedPlayoutTimestamp");"number"==typeof ve&&(V.estimatedPlayoutTimestamp=ve);var _e=$("totalDecodeTime");"number"==typeof _e&&(V.totalDecodeTime=_e);var Pe=$("framesDecoded");"number"==typeof Pe&&(V.framesDecoded=Pe);var be=$("jitterBufferDelay");"number"==typeof be&&(V.jitterBufferDelay=be);var we=$("jitterBufferEmittedCount");return"number"==typeof we&&(V.jitterBufferEmittedCount=we),V}C.exports=function(S,T){return S&&"function"==typeof S.getStats?function(S,T){var x=v(S,"audio","local"),M=v(S,"video","local"),N=v(S,"audio"),j=v(S,"video"),$={activeIceCandidatePair:null,localAudioTrackStats:[],localVideoTrackStats:[],remoteAudioTrackStats:[],remoteVideoTrackStats:[]},V=p([[x,"localAudioTrackStats",!1],[M,"localVideoTrackStats",!1],[N,"remoteAudioTrackStats",!0],[j,"remoteVideoTrackStats",!0]],function(B){var ne=B[1],te=B[2];return B[0].map(function(W){return function(S,T,x){return void 0!==(x=x||{}).testForChrome||e?A(S,T):void 0!==x.testForFirefox||r?function(S,T,x){return new Promise(function(M,N){S.getStats(T).then(function(j){M([E(j,x)])},N)})}(S,T,x.isRemote):void 0!==x.testForSafari||n?void 0!==x.testForSafari||"unified"===s()?A(S,T):Promise.reject(new Error(["getStats() is not supported on this version of Safari","due to this bug: https://bugs.webkit.org/show_bug.cgi?id=192601"].join(" "))):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(S,W,Object.assign({isRemote:te},T)).then(function(F){F.forEach(function(O){O.trackId=W.id,$[ne].push(O)})})})});return Promise.all(V).then(function(){return function(S,T){return void 0!==(T=T||{}).testForChrome||e||void 0!==T.testForSafari||n?S.getStats().then(u):void 0!==T.testForFirefox||r?S.getStats().then(c):Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(S,T)}).then(function(B){return $.activeIceCandidatePair=B,$})}(S,T):Promise.reject(new Error("Given PeerConnection does not support getStats"))}},2214:C=>{"use strict";C.exports=function(a){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia?(a=a||{audio:!0,video:!0},navigator.mediaDevices.getUserMedia(a)):Promise.reject(new Error("getUserMedia is not supported"))}},4135:(C,w,a)=>{"use strict";var p={};Object.defineProperties(p,{getStats:{enumerable:!0,value:a(633)},getUserMedia:{enumerable:!0,value:a(2214)},MediaStream:{enumerable:!0,value:a(5308)},MediaStreamTrack:{enumerable:!0,value:a(5476)},RTCIceCandidate:{enumerable:!0,value:a(9033)},RTCPeerConnection:{enumerable:!0,value:a(4916)},RTCSessionDescription:{enumerable:!0,value:a(2842)}}),C.exports=p},5308:C=>{"use strict";C.exports="function"==typeof MediaStream?MediaStream:function(){throw new Error("MediaStream is not supported")}},5476:C=>{"use strict";C.exports="function"==typeof MediaStreamTrack?MediaStreamTrack:function(){throw new Error("MediaStreamTrack is not supported")}},9033:C=>{"use strict";C.exports="function"==typeof RTCIceCandidate?RTCIceCandidate:function(){throw new Error("RTCIceCandidate is not supported")}},1107:(C,w,a)=>{"use strict";var p=a(932),h=a(7328),o=a(1732).inherits,s=a(2774),i=a(5308),t=a(7845),e=a(1225),r=a(4911),n=a(4911).isIOSChrome,l="unified"===e.getSdpFormat();function y(P,L){if(!(this instanceof y))return new y(P,L);h.call(this),P=P||{};var R=Object.assign(P.iceTransportPolicy?{iceTransports:P.iceTransportPolicy}:{},P);r.interceptEvent(this,"datachannel"),r.interceptEvent(this,"signalingstatechange");var E=e.getSdpFormat(R.sdpSemantics),S=new RTCPeerConnection(R,L);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_localStream:{value:new i},_peerConnection:{value:S},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_sdpFormat:{value:E},_senders:{value:new Map},_signalingStateLatch:{value:new s},_tracksToSSRCs:{value:new Map,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer?this._pendingLocalOffer:S.localDescription}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer?this._pendingRemoteOffer:S.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":S.signalingState}}});var T=this;S.addEventListener("datachannel",function(M){g(M.channel),T.dispatchEvent(M)}),S.addEventListener("signalingstatechange",function(){"stable"===S.signalingState&&(T._appliedTracksToSSRCs=new Map(T._tracksToSSRCs)),!T._pendingLocalOffer&&!T._pendingRemoteOffer&&T.dispatchEvent.apply(T,arguments)}),S.ontrack=function(){},"function"!=typeof RTCPeerConnection.prototype.addTrack&&S.addStream(this._localStream),r.proxyProperties(RTCPeerConnection.prototype,this,S)}function _(P,L,R){var j,V,T=L?P._pendingLocalOffer:P._pendingRemoteOffer,M=L?"have-local-offer":"have-remote-offer",N=L?"setLocalDescription":"setRemoteDescription";if(!L&&(L?P._pendingRemoteOffer:P._pendingLocalOffer)&&"answer"===R.type)j=function(P,L){return P._peerConnection.setLocalDescription(P._pendingLocalOffer).then(function(){return P._pendingLocalOffer=null,P.setRemoteDescription(L)}).then(function(){P._signalingStateLatch.lower()})}(P,R);else if("offer"===R.type){if(P.signalingState!==M&&"stable"!==P.signalingState)return Promise.reject(new Error("Cannot set "+(L?"local":"remote")+" offer in state "+P.signalingState));!T&&"low"===P._signalingStateLatch.state&&P._signalingStateLatch.raise();var $=P.signalingState;V=u(R),L?P._pendingLocalOffer=V:P._pendingRemoteOffer=V,j=Promise.resolve(),P.signalingState!==$&&j.then(function(){P.dispatchEvent(new Event("signalingstatechange"))})}else"rollback"===R.type&&(P.signalingState!==M?j=Promise.reject(new Error("Cannot rollback "+(L?"local":"remote")+" description in "+P.signalingState)):(L?P._pendingLocalOffer=null:P._pendingRemoteOffer=null,P._rolledBackTracksToSSRCs=new Map(P._tracksToSSRCs),P._tracksToSSRCs=new Map(P._appliedTracksToSSRCs),(j=Promise.resolve()).then(function(){P.dispatchEvent(new Event("signalingstatechange"))})));return j||P._peerConnection[N](u(R))}function f(P,L){return!!P.getTransceivers().find(function(R){return R.receiver&&R.receiver.track&&R.receiver.track.kind===L})}function u(P){return P instanceof p&&P._description?P._description:new RTCSessionDescription(P)}function c(){return"maxRetransmitTime"in RTCDataChannel.prototype&&!("maxPacketLifeTime"in RTCDataChannel.prototype)}function g(P){return Object.defineProperty(P,"maxRetransmits",{value:65535===P.maxRetransmits?null:P.maxRetransmits}),c()&&Object.defineProperty(P,"maxPacketLifeTime",{value:65535===P.maxRetransmitTime?null:P.maxRetransmitTime}),P}function A(P,L,R){return"unified"===P?e.updateUnifiedPlanTrackIdsToSSRCs(L,R):e.updatePlanBTrackIdsToSSRCs(L,R)}o(y,h),"function"!=typeof RTCPeerConnection.prototype.addTrack?(y.prototype.addTrack=function(){var L=[].slice.call(arguments),R=L[0];if("closed"===this._peerConnection.signalingState)throw new Error("Cannot add MediaStreamTrack ["+R.id+", "+R.kind+"]: RTCPeerConnection is closed");var E=this._senders.get(R);if(E&&E.track)throw new Error("Cannot add MediaStreamTrack ["+R.id+", "+R.kind+"]: RTCPeerConnection already has it");return this._peerConnection.removeStream(this._localStream),this._localStream.addTrack(R),this._peerConnection.addStream(this._localStream),E=new t(R),this._senders.set(R,E),E},y.prototype.removeTrack=function(L){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");var R=L.track;!R||(L=this._senders.get(R))&&L.track&&(L.track=null,this._peerConnection.removeStream(this._localStream),this._localStream.removeTrack(R),this._peerConnection.addStream(this._localStream))},y.prototype.getSenders=function(){return Array.from(this._senders.values())}):y.prototype.removeTrack=function(L){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");try{this._peerConnection.removeTrack(L)}catch(R){}},y.prototype.addIceCandidate=function(L){var E,R=[].slice.call(arguments),S=this;return E="have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then(function(){return S._peerConnection.addIceCandidate(L)}):this._peerConnection.addIceCandidate(L),R.length>1?r.legacyPromise(E,R[1],R[2]):E},y.prototype.close=function(){"closed"!==this.signalingState&&(this._pendingLocalOffer=null,this._pendingRemoteOffer=null,this._peerConnection.close())},y.prototype.createAnswer=function(){var R,L=[].slice.call(arguments),E=this;return R=this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then(function(){return E._signalingStateLatch.lower(),E._peerConnection.createAnswer()}).then(function(T){return E._pendingRemoteOffer=null,E._rolledBackTracksToSSRCs.clear(),new p({type:"answer",sdp:A(E._sdpFormat,E._tracksToSSRCs,T.sdp)})},function(T){throw E._pendingRemoteOffer=null,T}):this._peerConnection.createAnswer().then(function(S){return E._rolledBackTracksToSSRCs.clear(),new p({type:"answer",sdp:A(E._sdpFormat,E._tracksToSSRCs,S.sdp)})}),L.length>1?r.legacyPromise(R,L[0],L[1]):R},y.prototype.createOffer=function(){var L=[].slice.call(arguments),R=(L.length>1?L[2]:L[0])||{},E=this;if(n()){if(R.offerToReceiveVideo&&!this._audioTransceiver&&(!l||!f(this,"audio"))){delete R.offerToReceiveAudio;try{this._audioTransceiver=l?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(T){return Promise.reject(T)}}if(R.offerToReceiveVideo&&!this._videoTransceiver&&(!l||!f(this,"video"))){delete R.offerToReceiveVideo;try{this._videoTransceiver=l?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(T){return Promise.reject(T)}}}var S=this._peerConnection.createOffer(R).then(function(T){return E._rolledBackTracksToSSRCs.clear(),new p({type:T.type,sdp:A(E._sdpFormat,E._tracksToSSRCs,T.sdp)})});return L.length>1?r.legacyPromise(S,L[0],L[1]):S},y.prototype.createDataChannel=function(L,R){var P;P=R,P=Object.assign({},P),c()&&"maxPacketLifeTime"in P&&(P.maxRetransmitTime=P.maxPacketLifeTime);var E=this._peerConnection.createDataChannel(L,R=P);return g(E),E},y.prototype.setLocalDescription=function(){var L=[].slice.call(arguments),R=L[0];this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear());var E=_(this,!0,R);return L.length>1?r.legacyPromise(E,L[1],L[2]):E},y.prototype.setRemoteDescription=function(){var L=[].slice.call(arguments),R=L[0];this._rolledBackTracksToSSRCs.clear();var E=_(this,!1,R);return L.length>1?r.legacyPromise(E,L[1],L[2]):E},r.delegateMethods(RTCPeerConnection.prototype,y.prototype,"_peerConnection"),C.exports=y},2294:(C,w,a)=>{"use strict";var p=a(7328),h=a(1512),o=a(1732).inherits,s=a(1225).updateUnifiedPlanTrackIdsToSSRCs,i=a(4911),t="object"==typeof navigator&&navigator.userAgent&&(navigator.userAgent.match(/Firefox\/61/)||navigator.userAgent.match(/Firefox\/62/));function e(y){if(!(this instanceof e))return new e(y);p.call(this),i.interceptEvent(this,"signalingstatechange");var _=new RTCPeerConnection(y);Object.defineProperties(this,{_initiallyNegotiatedDtlsRole:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:_},_rollingBack:{value:!1,writable:!0},_tracksToSSRCs:{value:new Map},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},localDescription:{enumerable:!0,get:function(){return l(this._peerConnection.localDescription,this._initiallyNegotiatedDtlsRole)}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.signalingState}}});var f,b=this;_.addEventListener("signalingstatechange",function(){if(!b._rollingBack&&b.signalingState!==f){f=b.signalingState;var c=b.dispatchEvent.apply.bind(b.dispatchEvent,b,arguments);b._isClosed?setTimeout(c):c()}}),i.proxyProperties(RTCPeerConnection.prototype,this,_)}function r(y,_,b){var f=_?"setLocalDescription":"setRemoteDescription";return y._rollingBack=!0,y._peerConnection[f](new h({type:"rollback"})).then(b).then(function(c){return y._rollingBack=!1,c},function(c){throw y._rollingBack=!1,c})}function n(y,_,b){if(!y._initiallyNegotiatedDtlsRole&&"offer"!==_.type){var f=_.sdp.match(/a=setup:([a-z]+)/);if(f){var u=f[1];y._initiallyNegotiatedDtlsRole=b?{active:"passive",passive:"active"}[u]:u}}}function l(y,_){return y&&"answer"===y.type&&_?new h({type:y.type,sdp:y.sdp.replace(/a=setup:[a-z]+/g,"a=setup:"+_)}):y}o(e,p),Object.defineProperty(e.prototype,"peerIdentity",{enumerable:!0,value:Promise.resolve({idp:"",name:""})}),t&&(e.prototype.addTrack=function(){var _=arguments[0],b=this._peerConnection.addTrack.apply(this._peerConnection,arguments);return b.replaceTrack(_),b}),e.prototype.createAnswer=function(){var b,_=[].slice.call(arguments),f=this;return b=this._peerConnection.createAnswer().then(function(c){return n(f,c),l(c,f._initiallyNegotiatedDtlsRole)}),"function"==typeof _[0]?i.legacyPromise(b,_[0],_[1]):b},e.prototype.createOffer=function(){var f,_=[].slice.call(arguments),b=(_.length>1?_[2]:_[0])||{},u=this;if("have-local-offer"===this.signalingState||"have-remote-offer"===this.signalingState){var c="have-local-offer"===this.signalingState;f=r(this,c,function(){return u.createOffer(b)})}else f=u._peerConnection.createOffer(b);return f=f.then(function(v){return new h({type:v.type,sdp:s(u._tracksToSSRCs,v.sdp)})}),_.length>1?i.legacyPromise(f,_[0],_[1]):f},e.prototype.setLocalDescription=function(){var f,_=[].slice.call(arguments),b=_[0];return b&&"answer"===b.type&&"have-local-offer"===this.signalingState&&(f=Promise.reject(new Error("Cannot set local answer in state have-local-offer"))),f?_.length>1?i.legacyPromise(f,_[1],_[2]):f:this._peerConnection.setLocalDescription.apply(this._peerConnection,_)},e.prototype.setRemoteDescription=function(){var f,_=[].slice.call(arguments),b=_[0],u=this;return b&&"have-remote-offer"===this.signalingState&&("answer"===b.type?f=Promise.reject(new Error("Cannot set remote answer in state have-remote-offer")):"offer"===b.type&&(f=r(this,!1,function(){return u._peerConnection.setRemoteDescription(b)}))),f||(f=this._peerConnection.setRemoteDescription(b)),f=f.then(function(){n(u,b,!0)}),_.length>1?i.legacyPromise(f,_[1],_[2]):f},e.prototype.close=function(){"closed"!==this.signalingState&&(this._isClosed=!0,this._peerConnection.close())},i.delegateMethods(RTCPeerConnection.prototype,e.prototype,"_peerConnection"),C.exports=e},4916:(C,w,a)=>{"use strict";if("function"==typeof RTCPeerConnection)switch((0,a(4911).guessBrowser)()){case"chrome":C.exports=a(1107);break;case"firefox":C.exports=a(2294);break;case"safari":C.exports=a(1453);break;default:C.exports=RTCPeerConnection}else C.exports=function(){throw new Error("RTCPeerConnection is not supported")}},1453:(C,w,a)=>{"use strict";var p=a(7328),h=a(1732).inherits,o=a(2774),s=a(1225),i=a(4911),t="unified"===s.getSdpFormat(),e=t?s.updateUnifiedPlanTrackIdsToSSRCs:s.updatePlanBTrackIdsToSSRCs;function r(b){if(!(this instanceof r))return new r(b);p.call(this),i.interceptEvent(this,"datachannel"),i.interceptEvent(this,"iceconnectionstatechange"),i.interceptEvent(this,"signalingstatechange"),i.interceptEvent(this,"track");var f=new RTCPeerConnection(b);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_audioTransceiver:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:f},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_signalingStateLatch:{value:new o},_tracksToSSRCs:{value:new Map,writable:!0},_videoTransceiver:{value:null,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer||this._peerConnection.localDescription}},iceConnectionState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.iceConnectionState}},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer||this._peerConnection.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":this._peerConnection.signalingState}}});var u=this;f.addEventListener("datachannel",function(v){_(v.channel),u.dispatchEvent(v)}),f.addEventListener("iceconnectionstatechange",function(){u._isClosed||u.dispatchEvent.apply(u,arguments)}),f.addEventListener("signalingstatechange",function(){u._isClosed||("stable"===f.signalingState&&(u._appliedTracksToSSRCs=new Map(u._tracksToSSRCs)),!u._pendingLocalOffer&&!u._pendingRemoteOffer&&u.dispatchEvent.apply(u,arguments))}),f.addEventListener("track",function(v){u._pendingRemoteOffer=null,u.dispatchEvent(v)}),i.proxyProperties(RTCPeerConnection.prototype,this,f)}function n(b,f,u){var E,g=f?b._pendingLocalOffer:b._pendingRemoteOffer,P=f?"have-local-offer":"have-remote-offer",L=f?"setLocalDescription":"setRemoteDescription";if(!f&&(f?b._pendingRemoteOffer:b._pendingLocalOffer)&&"answer"===u.type)return function(b,f){return b._peerConnection.setLocalDescription(b._pendingLocalOffer).then(function(){return b._pendingLocalOffer=null,b.setRemoteDescription(f)}).then(function(){b._signalingStateLatch.lower()})}(b,u);if("offer"===u.type){if(b.signalingState!==P&&"stable"!==b.signalingState)return Promise.reject(new Error("Cannot set "+(f?"local":"remote")+" offer in state "+b.signalingState));!g&&"low"===b._signalingStateLatch.state&&b._signalingStateLatch.raise();var R=b.signalingState;return E=u,f?b._pendingLocalOffer=E:b._pendingRemoteOffer=E,b.signalingState!==R?Promise.resolve().then(function(){b.dispatchEvent(new Event("signalingstatechange"))}):Promise.resolve()}return"rollback"===u.type?b.signalingState!==P?Promise.reject(new Error("Cannot rollback "+(f?"local":"remote")+" description in "+b.signalingState)):(f?b._pendingLocalOffer=null:b._pendingRemoteOffer=null,b._rolledBackTracksToSSRCs=new Map(b._tracksToSSRCs),b._tracksToSSRCs=new Map(b._appliedTracksToSSRCs),Promise.resolve().then(function(){b.dispatchEvent(new Event("signalingstatechange"))})):b._peerConnection[L](u)}function y(b,f){return!!b.getTransceivers().find(function(u){return u.receiver&&u.receiver.track&&u.receiver.track.kind===f})}function _(b){return Object.defineProperties(b,{maxPacketLifeTime:{value:65535===b.maxPacketLifeTime?null:b.maxPacketLifeTime},maxRetransmits:{value:65535===b.maxRetransmits?null:b.maxRetransmits}})}h(r,p),r.prototype.addIceCandidate=function(f){var u=this;return"have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then(function(){return u._peerConnection.addIceCandidate(f)}):this._peerConnection.addIceCandidate(f)},r.prototype.createOffer=function(f){f=Object.assign({},f);var u=this;if(f.offerToReceiveVideo&&!this._audioTransceiver&&(!t||!y(this,"audio"))){delete f.offerToReceiveAudio;try{this._audioTransceiver=t?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(c){return Promise.reject(c)}}if(f.offerToReceiveVideo&&!this._videoTransceiver&&(!t||!y(this,"video"))){delete f.offerToReceiveVideo;try{this._videoTransceiver=t?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(c){return Promise.reject(c)}}return this._peerConnection.createOffer(f).then(function(c){return u._rolledBackTracksToSSRCs.clear(),new RTCSessionDescription({type:c.type,sdp:e(u._tracksToSSRCs,c.sdp)})})},r.prototype.createAnswer=function(f){var u=this;return this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then(function(){return u._signalingStateLatch.lower(),u._peerConnection.createAnswer()}).then(function(v){return u._pendingRemoteOffer=null,u._rolledBackTracksToSSRCs.clear(),t?new RTCSessionDescription({type:v.type,sdp:e(u._tracksToSSRCs,v.sdp)}):v},function(v){throw u._pendingRemoteOffer=null,v}):this._peerConnection.createAnswer(f).then(function(v){return u._rolledBackTracksToSSRCs.clear(),t?new RTCSessionDescription({type:v.type,sdp:e(u._tracksToSSRCs,v.sdp)}):v})},r.prototype.createDataChannel=function(f,u){var c=this._peerConnection.createDataChannel(f,u);return _(c),c},r.prototype.removeTrack=function(f){f.replaceTrack(null),this._peerConnection.removeTrack(f)},r.prototype.setLocalDescription=function(f){return this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear()),n(this,!0,f)},r.prototype.setRemoteDescription=function(f){return this._rolledBackTracksToSSRCs.clear(),n(this,!1,f)},r.prototype.close=function(){if(!this._isClosed){this._isClosed=!0,this._peerConnection.close();var f=this;setTimeout(function(){f.dispatchEvent(new Event("iceconnectionstatechange")),f.dispatchEvent(new Event("signalingstatechange"))})}},i.delegateMethods(RTCPeerConnection.prototype,r.prototype,"_peerConnection"),C.exports=r},7845:C=>{"use strict";C.exports=function(a){Object.defineProperties(this,{track:{enumerable:!0,value:a,writable:!0}})}},932:C=>{"use strict";C.exports=function w(a){if(!(this instanceof w))return new w(a);var p=a&&"rollback"===a.type?null:new RTCSessionDescription(a);Object.defineProperties(this,{_description:{get:function(){return p}},sdp:{enumerable:!0,value:p?p.sdp:a.sdp},type:{enumerable:!0,value:p?p.type:a.type}})}},1512:C=>{"use strict";C.exports=RTCSessionDescription},2842:(C,w,a)=>{"use strict";if("function"==typeof RTCSessionDescription)switch((0,a(4911).guessBrowser)()){case"chrome":C.exports=a(932);break;case"firefox":C.exports=a(1512);break;default:C.exports=RTCSessionDescription}else C.exports=function(){throw new Error("RTCSessionDescription is not supported")}},7328:(C,w,a)=>{"use strict";var p=a(3105).EventEmitter;function h(){Object.defineProperties(this,{_eventEmitter:{value:new p}})}h.prototype.dispatchEvent=function(s){return this._eventEmitter.emit(s.type,s)},h.prototype.addEventListener=function(){return this._eventEmitter.addListener.apply(this._eventEmitter,arguments)},h.prototype.removeEventListener=function(){return this._eventEmitter.removeListener.apply(this._eventEmitter,arguments)},C.exports=h},4911:(C,w)=>{"use strict";function p(u,c,v,g){if(!(g in c)&&!g.match(/^on[a-z]+$/)){var A=!1;try{var P=Object.getOwnPropertyDescriptor(u,g);A=P&&!!P.get}catch(R){}if(!A){var L;try{L=typeof u[g]}catch(R){}"function"===L&&(c[g]=function(){return this[v][g].apply(this[v],arguments)})}}}function i(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:null}function t(u){return void 0===u&&(u=i()),/Chrome|CriOS/.test(u)?"chrome":/Firefox|FxiOS/.test(u)?"firefox":/Safari|iPhone|iPad|iPod/.test(u)?"safari":null}w.defer=function(){var u={};return u.promise=new Promise(function(c,v){u.resolve=c,u.reject=v}),u},w.delegateMethods=function(u,c,v){for(var g in u)p(u,c,v,g)},w.difference=function(u,c){u=Array.isArray(u)?new Set(u):new Set(u.values()),c=Array.isArray(c)?new Set(c):new Set(c.values());var v=new Set;return u.forEach(function(g){c.has(g)||v.add(g)}),v},w.flatMap=function(u,c){return(u instanceof Map||u instanceof Set?Array.from(u.values()):u).reduce(function(g,A){var P=c(A);return g.concat(P)},[])},w.guessBrowser=t,w.guessBrowserVersion=function(u){void 0===u&&(u=i());var c={chrome:"Chrome|CriOS",firefox:"Firefox|FxiOS",safari:"Version"}[t(u)];if(!c)return null;var v=new RegExp("("+c+")/([^\\s]+)"),g=(u.match(v)||[])[2];if(!g)return null;var A=g.split(".").map(Number);return{major:isNaN(A[0])?null:A[0],minor:isNaN(A[1])?null:A[1]}},w.isIOSChrome=function(u){return void 0===u&&(u=i()),/Mobi/.test(u)&&"chrome"===t()&&/iPad|iPhone|iPod/.test(u)},w.interceptEvent=function(u,c){var v=null;Object.defineProperty(u,"on"+c,{get:function(){return v},set:function(g){v&&this.removeEventListener(c,v),"function"==typeof g?this.addEventListener(c,v=g):v=null}})},w.legacyPromise=function(u,c,v){return c?u.then(function(g){c(g)},function(g){v(g)}):u},w.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var c=16*Math.random()|0;return("x"===u?c:3&c|8).toString(16)})},w.proxyProperties=function(u,c,v){Object.getOwnPropertyNames(u).forEach(function(g){!function(u,c,v,g){if(!(g in c)){if(g.match(/^on[a-z]+$/))return Object.defineProperty(c,g,{value:null,writable:!0}),void v.addEventListener(g.slice(2),function(){c.dispatchEvent.apply(c,arguments)});Object.defineProperty(c,g,{enumerable:!0,get:function(){return v[g]}})}}(0,c,v,g)})},w.support=function(){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia&&"function"==typeof RTCPeerConnection}},2774:(C,w,a)=>{"use strict";var p=a(4911).defer,h={high:new Set(["low"]),low:new Set(["high"])};function o(i){if(!(this instanceof o))return new o(i);var t=i||"low";Object.defineProperties(this,{_state:{set:function(e){if(t!==e){var r=this._whenDeferreds.get(t=e);r.forEach(function(n){n.resolve(this)},this),r.clear()}},get:function(){return t}},_whenDeferreds:{value:new Map([["high",new Set],["low",new Set]])},state:{enumerable:!0,get:function(){return this._state}}})}function s(i,t){return new Error('Cannot transition from "'+i+'" to "'+t+'"')}o.prototype.lower=function(){return this.transition("low")},o.prototype.raise=function(){return this.transition("high")},o.prototype.transition=function(t){if(!h[this.state].has(t))throw s(this.state,t);return this._state=t,this},o.prototype.when=function(t){if(this.state===t)return Promise.resolve(this);if(!h[this.state].has(t))return Promise.reject(s(this.state,t));var e=p();return this._whenDeferreds.get(t).add(e),e.promise},C.exports=o},1225:(C,w,a)=>{"use strict";var p=a(4911).flatMap,h=a(4911).guessBrowser,o=null,i=null;function e(S){return S&&function(){if("boolean"==typeof o)return o;if("undefined"==typeof RTCPeerConnection)return o=!1;try{new RTCPeerConnection({sdpSemantics:"foo"}),o=!1}catch(S){o=!0}return o}()?{"plan-b":"planb","unified-plan":"unified"}[S]:function(){if(!i)if("undefined"!=typeof RTCPeerConnection&&"addTransceiver"in RTCPeerConnection.prototype)try{(new RTCPeerConnection).addTransceiver("audio"),i="unified"}catch(S){i="planb"}else i="planb";return i}()}function l(S,T){return(T.match(new RegExp(S,"gm"))||[]).reduce(function(M,N){var j=N.match(new RegExp(S));return j?M.add(j[1]):M},new Set)}function y(S,T){return l(S,T)}function _(S){return y("^a=ssrc:[0-9]+ +msid:.+ +(.+) *$",S)}function b(S){return y("^a=msid:.+ +(.+) *$",S)}function f(S,T){return l("^a=ssrc:([0-9]+) +msid:[^ ]+ +"+T+" *$",S)}function u(S,T,x){return T=T||".*",x=x||".*",S.split("\r\nm=").slice(1).map(function(M){return"m="+M}).filter(function(M){var N=new RegExp("m="+T,"gm"),j=new RegExp("a="+x,"gm");return N.test(M)&&j.test(M)})}function c(S){return Array.from(l("^a=ssrc:([0-9]+) +.*$",S))}function v(S,T){var x=u(S),M=new RegExp("^a=msid:[^ ]+ +"+T+" *$","gm"),N=x.filter(function(j){return j.match(M)});return new Set(p(N,c))}function g(S,T,x){return new Map(Array.from(S(x)).map(function(M){return[M,T(x,M)]}))}function A(S){return g(_,f,S)}function P(S){return g(b,v,S)}function L(S,T,x){var M=S(x),N=new Map;M.forEach(function(V,B){if(T.has(B)){var ee=Array.from(T.get(B)),ne=Array.from(V);ee.forEach(function(te,W){var F=ne[W];N.set(F,te);var k="a=ssrc:"+te+" $1";x=x.replace(new RegExp("^a=ssrc:"+F+" (.*)$","gm"),k)})}else T.set(B,V)});var j="^(a=ssrc-group:[^ ]+ +)(.*)$";return(x.match(new RegExp(j,"gm"))||[]).forEach(function(V){var B=V.match(new RegExp(j));if(B){var ee=B[1],te=B[2].split(" ").map(function(W){return N.get(W)||W}).join(" ");x=x.replace(B[0],ee+te)}}),x}w.getSdpFormat=function(S){return{chrome:e(S),firefox:"unified",safari:"undefined"!=typeof RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype?"unified":"planb"}[h()]||null},w.getMediaSections=u,w.getPlanBTrackIds=_,w.getUnifiedPlanTrackIds=b,w.getPlanBSSRCs=f,w.getUnifiedPlanSSRCs=v,w.updatePlanBTrackIdsToSSRCs=function(S,T){return L(A,S,T)},w.updateUnifiedPlanTrackIdsToSSRCs=function(S,T){return L(P,S,T)}},6890:C=>{C.exports=WebSocket},826:C=>{C.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},7775:(C,w,a)=>{"use strict";var p=a(7316),h=a(2197),o=a(3446),s=a(7579);function i(ue){return ue.call.bind(ue)}var t="undefined"!=typeof BigInt,e="undefined"!=typeof Symbol,r=i(Object.prototype.toString),n=i(Number.prototype.valueOf),l=i(String.prototype.valueOf),y=i(Boolean.prototype.valueOf);if(t)var _=i(BigInt.prototype.valueOf);if(e)var b=i(Symbol.prototype.valueOf);function f(ue,Z){if("object"!=typeof ue)return!1;try{return Z(ue),!0}catch(ie){return!1}}function N(ue){return"[object Map]"===r(ue)}function $(ue){return"[object Set]"===r(ue)}function B(ue){return"[object WeakMap]"===r(ue)}function ne(ue){return"[object WeakSet]"===r(ue)}function W(ue){return"[object ArrayBuffer]"===r(ue)}function F(ue){return"undefined"!=typeof ArrayBuffer&&(W.working?W(ue):ue instanceof ArrayBuffer)}function O(ue){return"[object DataView]"===r(ue)}function k(ue){return"undefined"!=typeof DataView&&(O.working?O(ue):ue instanceof DataView)}w.isArgumentsObject=p,w.isGeneratorFunction=h,w.isTypedArray=s,w.isPromise=function(ue){return"undefined"!=typeof Promise&&ue instanceof Promise||null!==ue&&"object"==typeof ue&&"function"==typeof ue.then&&"function"==typeof ue.catch},w.isArrayBufferView=function(ue){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(ue):s(ue)||k(ue)},w.isUint8Array=function(ue){return"Uint8Array"===o(ue)},w.isUint8ClampedArray=function(ue){return"Uint8ClampedArray"===o(ue)},w.isUint16Array=function(ue){return"Uint16Array"===o(ue)},w.isUint32Array=function(ue){return"Uint32Array"===o(ue)},w.isInt8Array=function(ue){return"Int8Array"===o(ue)},w.isInt16Array=function(ue){return"Int16Array"===o(ue)},w.isInt32Array=function(ue){return"Int32Array"===o(ue)},w.isFloat32Array=function(ue){return"Float32Array"===o(ue)},w.isFloat64Array=function(ue){return"Float64Array"===o(ue)},w.isBigInt64Array=function(ue){return"BigInt64Array"===o(ue)},w.isBigUint64Array=function(ue){return"BigUint64Array"===o(ue)},N.working="undefined"!=typeof Map&&N(new Map),w.isMap=function(ue){return"undefined"!=typeof Map&&(N.working?N(ue):ue instanceof Map)},$.working="undefined"!=typeof Set&&$(new Set),w.isSet=function(ue){return"undefined"!=typeof Set&&($.working?$(ue):ue instanceof Set)},B.working="undefined"!=typeof WeakMap&&B(new WeakMap),w.isWeakMap=function(ue){return"undefined"!=typeof WeakMap&&(B.working?B(ue):ue instanceof WeakMap)},ne.working="undefined"!=typeof WeakSet&&ne(new WeakSet),w.isWeakSet=function(ue){return ne(ue)},W.working="undefined"!=typeof ArrayBuffer&&W(new ArrayBuffer),w.isArrayBuffer=F,O.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&O(new DataView(new ArrayBuffer(1),0,1)),w.isDataView=k;var U="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function K(ue){return"[object SharedArrayBuffer]"===r(ue)}function re(ue){return void 0!==U&&(void 0===K.working&&(K.working=K(new U)),K.working?K(ue):ue instanceof U)}function Pe(ue){return f(ue,n)}function be(ue){return f(ue,l)}function we(ue){return f(ue,y)}function Se(ue){return t&&f(ue,_)}function Le(ue){return e&&f(ue,b)}w.isSharedArrayBuffer=re,w.isAsyncFunction=function(ue){return"[object AsyncFunction]"===r(ue)},w.isMapIterator=function(ue){return"[object Map Iterator]"===r(ue)},w.isSetIterator=function(ue){return"[object Set Iterator]"===r(ue)},w.isGeneratorObject=function(ue){return"[object Generator]"===r(ue)},w.isWebAssemblyCompiledModule=function(ue){return"[object WebAssembly.Module]"===r(ue)},w.isNumberObject=Pe,w.isStringObject=be,w.isBooleanObject=we,w.isBigIntObject=Se,w.isSymbolObject=Le,w.isBoxedPrimitive=function(ue){return Pe(ue)||be(ue)||we(ue)||Se(ue)||Le(ue)},w.isAnyArrayBuffer=function(ue){return"undefined"!=typeof Uint8Array&&(F(ue)||re(ue))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(ue){Object.defineProperty(w,ue,{enumerable:!1,value:function(){throw new Error(ue+" is not supported in userland")}})})},1732:(C,w,a)=>{var p=Object.getOwnPropertyDescriptors||function(k){for(var U=Object.keys(k),K={},re=0;re<U.length;re++)K[U[re]]=Object.getOwnPropertyDescriptor(k,U[re]);return K},h=/%[sdj%]/g;w.format=function(O){if(!L(O)){for(var k=[],U=0;U<arguments.length;U++)k.push(t(arguments[U]));return k.join(" ")}U=1;for(var K=arguments,re=K.length,J=String(O).replace(h,function(le){if("%%"===le)return"%";if(U>=re)return le;switch(le){case"%s":return String(K[U++]);case"%d":return Number(K[U++]);case"%j":try{return JSON.stringify(K[U++])}catch(ve){return"[Circular]"}default:return le}}),q=K[U];U<re;q=K[++U])g(q)||!T(q)?J+=" "+q:J+=" "+t(q);return J},w.deprecate=function(O,k){if("undefined"!=typeof process&&!0===process.noDeprecation)return O;if("undefined"==typeof process)return function(){return w.deprecate(O,k).apply(this,arguments)};var U=!1;return function(){if(!U){if(process.throwDeprecation)throw new Error(k);process.traceDeprecation?console.trace(k):console.error(k),U=!0}return O.apply(this,arguments)}};var o={},s=/^$/;if(process.env.NODE_DEBUG){var i=process.env.NODE_DEBUG;i=i.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+i+"$","i")}function t(O,k){var U={seen:[],stylize:r};return arguments.length>=3&&(U.depth=arguments[2]),arguments.length>=4&&(U.colors=arguments[3]),v(k)?U.showHidden=k:k&&w._extend(U,k),E(U.showHidden)&&(U.showHidden=!1),E(U.depth)&&(U.depth=2),E(U.colors)&&(U.colors=!1),E(U.customInspect)&&(U.customInspect=!0),U.colors&&(U.stylize=e),l(U,O,U.depth)}function e(O,k){var U=t.styles[k];return U?"\x1b["+t.colors[U][0]+"m"+O+"\x1b["+t.colors[U][1]+"m":O}function r(O,k){return O}function l(O,k,U){if(O.customInspect&&k&&N(k.inspect)&&k.inspect!==w.inspect&&(!k.constructor||k.constructor.prototype!==k)){var K=k.inspect(U,O);return L(K)||(K=l(O,K,U)),K}var re=function(O,k){if(E(k))return O.stylize("undefined","undefined");if(L(k)){var U="'"+JSON.stringify(k).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return O.stylize(U,"string")}return P(k)?O.stylize(""+k,"number"):v(k)?O.stylize(""+k,"boolean"):g(k)?O.stylize("null","null"):void 0}(O,k);if(re)return re;var J=Object.keys(k),q=function(O){var k={};return O.forEach(function(U,K){k[U]=!0}),k}(J);if(O.showHidden&&(J=Object.getOwnPropertyNames(k)),M(k)&&(J.indexOf("message")>=0||J.indexOf("description")>=0))return _(k);if(0===J.length){if(N(k))return O.stylize("[Function"+(k.name?": "+k.name:"")+"]","special");if(S(k))return O.stylize(RegExp.prototype.toString.call(k),"regexp");if(x(k))return O.stylize(Date.prototype.toString.call(k),"date");if(M(k))return _(k)}var we,ve="",_e=!1,Pe=["{","}"];return c(k)&&(_e=!0,Pe=["[","]"]),N(k)&&(ve=" [Function"+(k.name?": "+k.name:"")+"]"),S(k)&&(ve=" "+RegExp.prototype.toString.call(k)),x(k)&&(ve=" "+Date.prototype.toUTCString.call(k)),M(k)&&(ve=" "+_(k)),0!==J.length||_e&&0!=k.length?U<0?S(k)?O.stylize(RegExp.prototype.toString.call(k),"regexp"):O.stylize("[Object]","special"):(O.seen.push(k),we=_e?function(O,k,U,K,re){for(var J=[],q=0,le=k.length;q<le;++q)ne(k,String(q))?J.push(f(O,k,U,K,String(q),!0)):J.push("");return re.forEach(function(ve){ve.match(/^\d+$/)||J.push(f(O,k,U,K,ve,!0))}),J}(O,k,U,q,J):J.map(function(Se){return f(O,k,U,q,Se,_e)}),O.seen.pop(),function(O,k,U){return O.reduce(function(J,q){return q.indexOf("\n"),J+q.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(""===k?"":k+"\n ")+" "+O.join(",\n  ")+" "+U[1]:U[0]+k+" "+O.join(", ")+" "+U[1]}(we,ve,Pe)):Pe[0]+ve+Pe[1]}function _(O){return"["+Error.prototype.toString.call(O)+"]"}function f(O,k,U,K,re,J){var q,le,ve;if((ve=Object.getOwnPropertyDescriptor(k,re)||{value:k[re]}).get?le=O.stylize(ve.set?"[Getter/Setter]":"[Getter]","special"):ve.set&&(le=O.stylize("[Setter]","special")),ne(K,re)||(q="["+re+"]"),le||(O.seen.indexOf(ve.value)<0?(le=g(U)?l(O,ve.value,null):l(O,ve.value,U-1)).indexOf("\n")>-1&&(le=J?le.split("\n").map(function(_e){return"  "+_e}).join("\n").substr(2):"\n"+le.split("\n").map(function(_e){return"   "+_e}).join("\n")):le=O.stylize("[Circular]","special")),E(q)){if(J&&re.match(/^\d+$/))return le;(q=JSON.stringify(""+re)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(q=q.substr(1,q.length-2),q=O.stylize(q,"name")):(q=q.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),q=O.stylize(q,"string"))}return q+": "+le}function c(O){return Array.isArray(O)}function v(O){return"boolean"==typeof O}function g(O){return null===O}function P(O){return"number"==typeof O}function L(O){return"string"==typeof O}function E(O){return void 0===O}function S(O){return T(O)&&"[object RegExp]"===$(O)}function T(O){return"object"==typeof O&&null!==O}function x(O){return T(O)&&"[object Date]"===$(O)}function M(O){return T(O)&&("[object Error]"===$(O)||O instanceof Error)}function N(O){return"function"==typeof O}function $(O){return Object.prototype.toString.call(O)}function V(O){return O<10?"0"+O.toString(10):O.toString(10)}w.debuglog=function(O){if(O=O.toUpperCase(),!o[O])if(s.test(O)){var k=process.pid;o[O]=function(){var U=w.format.apply(w,arguments);console.error("%s %d: %s",O,k,U)}}else o[O]=function(){};return o[O]},w.inspect=t,t.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},t.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},w.types=a(7775),w.isArray=c,w.isBoolean=v,w.isNull=g,w.isNullOrUndefined=function(O){return null==O},w.isNumber=P,w.isString=L,w.isSymbol=function(O){return"symbol"==typeof O},w.isUndefined=E,w.isRegExp=S,w.types.isRegExp=S,w.isObject=T,w.isDate=x,w.types.isDate=x,w.isError=M,w.types.isNativeError=M,w.isFunction=N,w.isPrimitive=function(O){return null===O||"boolean"==typeof O||"number"==typeof O||"string"==typeof O||"symbol"==typeof O||void 0===O},w.isBuffer=a(826);var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ee(){var O=new Date,k=[V(O.getHours()),V(O.getMinutes()),V(O.getSeconds())].join(":");return[O.getDate(),B[O.getMonth()],k].join(" ")}function ne(O,k){return Object.prototype.hasOwnProperty.call(O,k)}w.log=function(){console.log("%s - %s",ee(),w.format.apply(w,arguments))},w.inherits=a(9879),w._extend=function(O,k){if(!k||!T(k))return O;for(var U=Object.keys(k),K=U.length;K--;)O[U[K]]=k[U[K]];return O};var te="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function W(O,k){if(!O){var U=new Error("Promise was rejected with a falsy value");U.reason=O,O=U}return k(O)}w.promisify=function(k){if("function"!=typeof k)throw new TypeError('The "original" argument must be of type Function');if(te&&k[te]){var U;if("function"!=typeof(U=k[te]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(U,te,{value:U,enumerable:!1,writable:!1,configurable:!0}),U}function U(){for(var K,re,J=new Promise(function(ve,_e){K=ve,re=_e}),q=[],le=0;le<arguments.length;le++)q.push(arguments[le]);q.push(function(ve,_e){ve?re(ve):K(_e)});try{k.apply(this,q)}catch(ve){re(ve)}return J}return Object.setPrototypeOf(U,Object.getPrototypeOf(k)),te&&Object.defineProperty(U,te,{value:U,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(U,p(k))},w.promisify.custom=te,w.callbackify=function(O){if("function"!=typeof O)throw new TypeError('The "original" argument must be of type Function');function k(){for(var U=[],K=0;K<arguments.length;K++)U.push(arguments[K]);var re=U.pop();if("function"!=typeof re)throw new TypeError("The last argument must be of type Function");var J=this,q=function(){return re.apply(J,arguments)};O.apply(this,U).then(function(le){process.nextTick(q.bind(null,null,le))},function(le){process.nextTick(W.bind(null,le,q))})}return Object.setPrototypeOf(k,Object.getPrototypeOf(O)),Object.defineProperties(k,p(O)),k}},3446:(C,w,a)=>{"use strict";var p=a(708),h=a(5127),o=a(9568),s=o("Object.prototype.toString"),i=a(1407)(),t="undefined"==typeof globalThis?global:globalThis,e=h(),r=o("String.prototype.slice"),n={},l=a(7168),y=Object.getPrototypeOf;i&&l&&y&&p(e,function(f){if("function"==typeof t[f]){var u=new t[f];if(Symbol.toStringTag in u){var c=y(u),v=l(c,Symbol.toStringTag);if(!v){var g=y(c);v=l(g,Symbol.toStringTag)}n[f]=v.get}}});var b=a(7579);C.exports=function(u){return!!b(u)&&(i&&Symbol.toStringTag in u?function(u){var c=!1;return p(n,function(v,g){if(!c)try{var A=v.call(u);A===g&&(c=A)}catch(P){}}),c}(u):r(s(u),8,-1))}},8507:(C,w,a)=>{"use strict";a.r(w),a.d(w,{MainModule:()=>jt});var p=a(8583),h=a(4889),o=a(7716);function s(Y,d,m,I,z,oe,de){try{var ye=Y[oe](de),Te=ye.value}catch(ke){return void m(ke)}ye.done?d(Te):Promise.resolve(Te).then(I,z)}function i(Y){return function(){var d=this,m=arguments;return new Promise(function(I,z){var oe=Y.apply(d,m);function de(Te){s(oe,I,z,de,ye,"next",Te)}function ye(Te){s(oe,I,z,de,ye,"throw",Te)}de(void 0)})}}const t=[0,2e3,1e4,3e4,null];class e{constructor(d){this._retryDelays=void 0!==d?[...d,null]:t}nextRetryDelayInMilliseconds(d){return this._retryDelays[d.previousRetryCount]}}class r extends Error{constructor(d,m){const I=new.target.prototype;super(`${d}: Status code '${m}'`),this.statusCode=m,this.__proto__=I}}class n extends Error{constructor(d="A timeout occurred."){const m=new.target.prototype;super(d),this.__proto__=m}}class l extends Error{constructor(d="An abort occurred."){const m=new.target.prototype;super(d),this.__proto__=m}}class y extends Error{constructor(d,m){const I=new.target.prototype;super(d),this.transport=m,this.errorType="UnsupportedTransportError",this.__proto__=I}}class _ extends Error{constructor(d,m){const I=new.target.prototype;super(d),this.transport=m,this.errorType="DisabledTransportError",this.__proto__=I}}class b extends Error{constructor(d,m){const I=new.target.prototype;super(d),this.transport=m,this.errorType="FailedToStartTransportError",this.__proto__=I}}class f extends Error{constructor(d){const m=new.target.prototype;super(d),this.errorType="FailedToNegotiateWithServerError",this.__proto__=m}}class u extends Error{constructor(d,m){const I=new.target.prototype;super(d),this.innerErrors=m,this.__proto__=I}}class c{constructor(d,m,I){this.statusCode=d,this.statusText=m,this.content=I}}class v{get(d,m){return this.send(Ze($e({},m),{method:"GET",url:d}))}post(d,m){return this.send(Ze($e({},m),{method:"POST",url:d}))}delete(d,m){return this.send(Ze($e({},m),{method:"DELETE",url:d}))}getCookieString(d){return""}}var g=(()=>{return(Y=g||(g={}))[Y.Trace=0]="Trace",Y[Y.Debug=1]="Debug",Y[Y.Information=2]="Information",Y[Y.Warning=3]="Warning",Y[Y.Error=4]="Error",Y[Y.Critical=5]="Critical",Y[Y.None=6]="None",g;var Y})();class A{constructor(){}log(d,m){}}A.instance=new A;class L{static isRequired(d,m){if(null==d)throw new Error(`The '${m}' argument is required.`)}static isNotEmpty(d,m){if(!d||d.match(/^\s*$/))throw new Error(`The '${m}' argument should not be empty.`)}static isIn(d,m,I){if(!(d in m))throw new Error(`Unknown ${I} value: ${d}.`)}}class R{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function E(Y,d){let m="";return T(Y)?(m=`Binary data of length ${Y.byteLength}`,d&&(m+=`. Content: '${function(Y){const d=new Uint8Array(Y);let m="";return d.forEach(I=>{m+=`0x${I<16?"0":""}${I.toString(16)} `}),m.substr(0,m.length-1)}(Y)}'`)):"string"==typeof Y&&(m=`String data of length ${Y.length}`,d&&(m+=`. Content: '${Y}'`)),m}function T(Y){return Y&&"undefined"!=typeof ArrayBuffer&&(Y instanceof ArrayBuffer||Y.constructor&&"ArrayBuffer"===Y.constructor.name)}function x(Y,d,m,I,z,oe,de){return M.apply(this,arguments)}function M(){return(M=i(function*(Y,d,m,I,z,oe,de){let ye={};if(z){const Ye=yield z();Ye&&(ye={Authorization:`Bearer ${Ye}`})}const[Te,ke]=V();ye[Te]=ke,Y.log(g.Trace,`(${d} transport) sending data. ${E(oe,de.logMessageContent)}.`);const Ae=T(oe)?"arraybuffer":"text",Ge=yield m.post(I,{content:oe,headers:$e($e({},ye),de.headers),responseType:Ae,timeout:de.timeout,withCredentials:de.withCredentials});Y.log(g.Trace,`(${d} transport) request complete. Response status: ${Ge.statusCode}.`)})).apply(this,arguments)}class j{constructor(d,m){this._subject=d,this._observer=m}dispose(){const d=this._subject.observers.indexOf(this._observer);d>-1&&this._subject.observers.splice(d,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(m=>{})}}class ${constructor(d){this._minLevel=d,this.out=console}log(d,m){if(d>=this._minLevel){const I=`[${(new Date).toISOString()}] ${g[d]}: ${m}`;switch(d){case g.Critical:case g.Error:this.out.error(I);break;case g.Warning:this.out.warn(I);break;case g.Information:this.out.info(I);break;default:this.out.log(I)}}}}function V(){let Y="X-SignalR-User-Agent";return R.isNode&&(Y="User-Agent"),[Y,B("6.0.4",ee(),R.isNode?"NodeJS":"Browser",ne())]}function B(Y,d,m,I){let z="Microsoft SignalR/";const oe=Y.split(".");return z+=`${oe[0]}.${oe[1]}`,z+=` (${Y}; `,z+=d&&""!==d?`${d}; `:"Unknown OS; ",z+=`${m}`,z+=I?`; ${I}`:"; Unknown Runtime Version",z+=")",z}function ee(){if(!R.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function ne(){if(R.isNode)return process.versions.node}function W(Y){return Y.stack?Y.stack:Y.message?Y.message:`${Y}`}class O extends v{constructor(d){if(super(),this._logger=d,"undefined"==typeof fetch){const m=require;this._jar=new(m("tough-cookie").CookieJar),this._fetchType=m("node-fetch"),this._fetchType=m("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const m=require;this._abortControllerType=m("abort-controller")}else this._abortControllerType=AbortController}send(d){var m=this;return i(function*(){if(d.abortSignal&&d.abortSignal.aborted)throw new l;if(!d.method)throw new Error("No method defined.");if(!d.url)throw new Error("No url defined.");const I=new m._abortControllerType;let z;d.abortSignal&&(d.abortSignal.onabort=()=>{I.abort(),z=new l});let de,oe=null;d.timeout&&(oe=setTimeout(()=>{I.abort(),m._logger.log(g.Warning,"Timeout from HTTP request."),z=new n},d.timeout));try{de=yield m._fetchType(d.url,{body:d.content,cache:"no-cache",credentials:!0===d.withCredentials?"include":"same-origin",headers:$e({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},d.headers),method:d.method,mode:"cors",redirect:"follow",signal:I.signal})}catch(ke){throw z||(m._logger.log(g.Warning,`Error from HTTP request. ${ke}.`),ke)}finally{oe&&clearTimeout(oe),d.abortSignal&&(d.abortSignal.onabort=null)}if(!de.ok){const ke=yield k(de,"text");throw new r(ke||de.statusText,de.status)}const Te=yield k(de,d.responseType);return new c(de.status,de.statusText,Te)})()}getCookieString(d){let m="";return R.isNode&&this._jar&&this._jar.getCookies(d,(I,z)=>m=z.join("; ")),m}}function k(Y,d){let m;switch(d){case"arraybuffer":m=Y.arrayBuffer();break;case"text":m=Y.text();break;case"blob":case"document":case"json":throw new Error(`${d} is not supported.`);default:m=Y.text()}return m}class U extends v{constructor(d){super(),this._logger=d}send(d){return d.abortSignal&&d.abortSignal.aborted?Promise.reject(new l):d.method?d.url?new Promise((m,I)=>{const z=new XMLHttpRequest;z.open(d.method,d.url,!0),z.withCredentials=void 0===d.withCredentials||d.withCredentials,z.setRequestHeader("X-Requested-With","XMLHttpRequest"),z.setRequestHeader("Content-Type","text/plain;charset=UTF-8");const oe=d.headers;oe&&Object.keys(oe).forEach(de=>{z.setRequestHeader(de,oe[de])}),d.responseType&&(z.responseType=d.responseType),d.abortSignal&&(d.abortSignal.onabort=()=>{z.abort(),I(new l)}),d.timeout&&(z.timeout=d.timeout),z.onload=()=>{d.abortSignal&&(d.abortSignal.onabort=null),z.status>=200&&z.status<300?m(new c(z.status,z.statusText,z.response||z.responseText)):I(new r(z.response||z.responseText||z.statusText,z.status))},z.onerror=()=>{this._logger.log(g.Warning,`Error from HTTP request. ${z.status}: ${z.statusText}.`),I(new r(z.statusText,z.status))},z.ontimeout=()=>{this._logger.log(g.Warning,"Timeout from HTTP request."),I(new n)},z.send(d.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class K extends v{constructor(d){if(super(),"undefined"!=typeof fetch||R.isNode)this._httpClient=new O(d);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new U(d)}}send(d){return d.abortSignal&&d.abortSignal.aborted?Promise.reject(new l):d.method?d.url?this._httpClient.send(d):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(d){return this._httpClient.getCookieString(d)}}let re=(()=>{class Y{}return Y.Authorization="Authorization",Y.Cookie="Cookie",Y})();var J=(()=>{return(Y=J||(J={}))[Y.None=0]="None",Y[Y.WebSockets=1]="WebSockets",Y[Y.ServerSentEvents=2]="ServerSentEvents",Y[Y.LongPolling=4]="LongPolling",J;var Y})(),q=(()=>{return(Y=q||(q={}))[Y.Text=1]="Text",Y[Y.Binary=2]="Binary",q;var Y})();class le{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class ve{constructor(d,m,I,z){this._httpClient=d,this._accessTokenFactory=m,this._logger=I,this._pollAbort=new le,this._options=z,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(d,m){var I=this;return i(function*(){if(L.isRequired(d,"url"),L.isRequired(m,"transferFormat"),L.isIn(m,q,"transferFormat"),I._url=d,I._logger.log(g.Trace,"(LongPolling transport) Connecting."),m===q.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[z,oe]=V(),de=$e({[z]:oe},I._options.headers),ye={abortSignal:I._pollAbort.signal,headers:de,timeout:1e5,withCredentials:I._options.withCredentials};m===q.Binary&&(ye.responseType="arraybuffer");const Te=yield I._getAccessToken();I._updateHeaderToken(ye,Te);const ke=`${d}&_=${Date.now()}`;I._logger.log(g.Trace,`(LongPolling transport) polling: ${ke}.`);const Ae=yield I._httpClient.get(ke,ye);200!==Ae.statusCode?(I._logger.log(g.Error,`(LongPolling transport) Unexpected response code: ${Ae.statusCode}.`),I._closeError=new r(Ae.statusText||"",Ae.statusCode),I._running=!1):I._running=!0,I._receiving=I._poll(I._url,ye)})()}_getAccessToken(){var d=this;return i(function*(){return d._accessTokenFactory?yield d._accessTokenFactory():null})()}_updateHeaderToken(d,m){d.headers||(d.headers={}),m?d.headers[re.Authorization]=`Bearer ${m}`:d.headers[re.Authorization]&&delete d.headers[re.Authorization]}_poll(d,m){var I=this;return i(function*(){try{for(;I._running;){const z=yield I._getAccessToken();I._updateHeaderToken(m,z);try{const oe=`${d}&_=${Date.now()}`;I._logger.log(g.Trace,`(LongPolling transport) polling: ${oe}.`);const de=yield I._httpClient.get(oe,m);204===de.statusCode?(I._logger.log(g.Information,"(LongPolling transport) Poll terminated by server."),I._running=!1):200!==de.statusCode?(I._logger.log(g.Error,`(LongPolling transport) Unexpected response code: ${de.statusCode}.`),I._closeError=new r(de.statusText||"",de.statusCode),I._running=!1):de.content?(I._logger.log(g.Trace,`(LongPolling transport) data received. ${E(de.content,I._options.logMessageContent)}.`),I.onreceive&&I.onreceive(de.content)):I._logger.log(g.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(oe){I._running?oe instanceof n?I._logger.log(g.Trace,"(LongPolling transport) Poll timed out, reissuing."):(I._closeError=oe,I._running=!1):I._logger.log(g.Trace,`(LongPolling transport) Poll errored after shutdown: ${oe.message}`)}}}finally{I._logger.log(g.Trace,"(LongPolling transport) Polling complete."),I.pollAborted||I._raiseOnClose()}})()}send(d){var m=this;return i(function*(){return m._running?x(m._logger,"LongPolling",m._httpClient,m._url,m._accessTokenFactory,d,m._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var d=this;return i(function*(){d._logger.log(g.Trace,"(LongPolling transport) Stopping polling."),d._running=!1,d._pollAbort.abort();try{yield d._receiving,d._logger.log(g.Trace,`(LongPolling transport) sending DELETE request to ${d._url}.`);const m={},[I,z]=V();m[I]=z;const oe={headers:$e($e({},m),d._options.headers),timeout:d._options.timeout,withCredentials:d._options.withCredentials},de=yield d._getAccessToken();d._updateHeaderToken(oe,de),yield d._httpClient.delete(d._url,oe),d._logger.log(g.Trace,"(LongPolling transport) DELETE request sent.")}finally{d._logger.log(g.Trace,"(LongPolling transport) Stop finished."),d._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let d="(LongPolling transport) Firing onclose event.";this._closeError&&(d+=" Error: "+this._closeError),this._logger.log(g.Trace,d),this.onclose(this._closeError)}}}class _e{constructor(d,m,I,z){this._httpClient=d,this._accessTokenFactory=m,this._logger=I,this._options=z,this.onreceive=null,this.onclose=null}connect(d,m){var I=this;return i(function*(){if(L.isRequired(d,"url"),L.isRequired(m,"transferFormat"),L.isIn(m,q,"transferFormat"),I._logger.log(g.Trace,"(SSE transport) Connecting."),I._url=d,I._accessTokenFactory){const z=yield I._accessTokenFactory();z&&(d+=(d.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(z)}`)}return new Promise((z,oe)=>{let ye,de=!1;if(m===q.Text){if(R.isBrowser||R.isWebWorker)ye=new I._options.EventSource(d,{withCredentials:I._options.withCredentials});else{const Te=I._httpClient.getCookieString(d),ke={};ke.Cookie=Te;const[Ae,Ge]=V();ke[Ae]=Ge,ye=new I._options.EventSource(d,{withCredentials:I._options.withCredentials,headers:$e($e({},ke),I._options.headers)})}try{ye.onmessage=Te=>{if(I.onreceive)try{I._logger.log(g.Trace,`(SSE transport) data received. ${E(Te.data,I._options.logMessageContent)}.`),I.onreceive(Te.data)}catch(ke){return void I._close(ke)}},ye.onerror=Te=>{de?I._close():oe(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},ye.onopen=()=>{I._logger.log(g.Information,`SSE connected to ${I._url}`),I._eventSource=ye,de=!0,z()}}catch(Te){return void oe(Te)}}else oe(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(d){var m=this;return i(function*(){return m._eventSource?x(m._logger,"SSE",m._httpClient,m._url,m._accessTokenFactory,d,m._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(d){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(d))}}class Pe{constructor(d,m,I,z,oe,de){this._logger=I,this._accessTokenFactory=m,this._logMessageContent=z,this._webSocketConstructor=oe,this._httpClient=d,this.onreceive=null,this.onclose=null,this._headers=de}connect(d,m){var I=this;return i(function*(){if(L.isRequired(d,"url"),L.isRequired(m,"transferFormat"),L.isIn(m,q,"transferFormat"),I._logger.log(g.Trace,"(WebSockets transport) Connecting."),I._accessTokenFactory){const z=yield I._accessTokenFactory();z&&(d+=(d.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(z)}`)}return new Promise((z,oe)=>{let de;d=d.replace(/^http/,"ws");const ye=I._httpClient.getCookieString(d);let Te=!1;if(R.isNode){const ke={},[Ae,Ge]=V();ke[Ae]=Ge,ye&&(ke[re.Cookie]=`${ye}`),de=new I._webSocketConstructor(d,void 0,{headers:$e($e({},ke),I._headers)})}de||(de=new I._webSocketConstructor(d)),m===q.Binary&&(de.binaryType="arraybuffer"),de.onopen=ke=>{I._logger.log(g.Information,`WebSocket connected to ${d}.`),I._webSocket=de,Te=!0,z()},de.onerror=ke=>{let Ae=null;Ae="undefined"!=typeof ErrorEvent&&ke instanceof ErrorEvent?ke.error:"There was an error with the transport",I._logger.log(g.Information,`(WebSockets transport) ${Ae}.`)},de.onmessage=ke=>{if(I._logger.log(g.Trace,`(WebSockets transport) data received. ${E(ke.data,I._logMessageContent)}.`),I.onreceive)try{I.onreceive(ke.data)}catch(Ae){return void I._close(Ae)}},de.onclose=ke=>{if(Te)I._close(ke);else{let Ae=null;Ae="undefined"!=typeof ErrorEvent&&ke instanceof ErrorEvent?ke.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",oe(new Error(Ae))}}})})()}send(d){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(g.Trace,`(WebSockets transport) sending data. ${E(d,this._logMessageContent)}.`),this._webSocket.send(d),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(d){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(g.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(d)||!1!==d.wasClean&&1e3===d.code?d instanceof Error?this.onclose(d):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${d.code} (${d.reason||"no reason given"}).`)))}_isCloseEvent(d){return d&&"boolean"==typeof d.wasClean&&"number"==typeof d.code}}class we{constructor(d,m={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,L.isRequired(d,"url"),this._logger=void 0===(Y=m.logger)?new $(g.Information):null===Y?A.instance:void 0!==Y.log?Y:new $(Y),this.baseUrl=this._resolveUrl(d),(m=m||{}).logMessageContent=void 0!==m.logMessageContent&&m.logMessageContent,"boolean"!=typeof m.withCredentials&&void 0!==m.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");var Y;m.withCredentials=void 0===m.withCredentials||m.withCredentials,m.timeout=void 0===m.timeout?1e5:m.timeout;let I=null,z=null;if(R.isNode){const oe=require;I=oe("ws"),z=oe("eventsource")}R.isNode||"undefined"==typeof WebSocket||m.WebSocket?R.isNode&&!m.WebSocket&&I&&(m.WebSocket=I):m.WebSocket=WebSocket,R.isNode||"undefined"==typeof EventSource||m.EventSource?R.isNode&&!m.EventSource&&void 0!==z&&(m.EventSource=z):m.EventSource=EventSource,this._httpClient=m.httpClient||new K(this._logger),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=m,this.onreceive=null,this.onclose=null}start(d){var m=this;return i(function*(){if(L.isIn(d=d||q.Binary,q,"transferFormat"),m._logger.log(g.Debug,`Starting connection with transfer format '${q[d]}'.`),"Disconnected"!==m._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(m._connectionState="Connecting",m._startInternalPromise=m._startInternal(d),yield m._startInternalPromise,"Disconnecting"===m._connectionState){const I="Failed to start the HttpConnection before stop() was called.";return m._logger.log(g.Error,I),yield m._stopPromise,Promise.reject(new Error(I))}if("Connected"!==m._connectionState){const I="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return m._logger.log(g.Error,I),Promise.reject(new Error(I))}m._connectionStarted=!0})()}send(d){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Le(this.transport)),this._sendQueue.send(d))}stop(d){var m=this;return i(function*(){return"Disconnected"===m._connectionState?(m._logger.log(g.Debug,`Call to HttpConnection.stop(${d}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===m._connectionState?(m._logger.log(g.Debug,`Call to HttpConnection.stop(${d}) ignored because the connection is already in the disconnecting state.`),m._stopPromise):(m._connectionState="Disconnecting",m._stopPromise=new Promise(I=>{m._stopPromiseResolver=I}),yield m._stopInternal(d),void(yield m._stopPromise))})()}_stopInternal(d){var m=this;return i(function*(){m._stopError=d;try{yield m._startInternalPromise}catch(I){}if(m.transport){try{yield m.transport.stop()}catch(I){m._logger.log(g.Error,`HttpConnection.transport.stop() threw error '${I}'.`),m._stopConnection()}m.transport=void 0}else m._logger.log(g.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(d){var m=this;return i(function*(){let I=m.baseUrl;m._accessTokenFactory=m._options.accessTokenFactory;try{if(m._options.skipNegotiation){if(m._options.transport!==J.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");m.transport=m._constructTransport(J.WebSockets),yield m._startTransport(I,d)}else{let z=null,oe=0;do{if(z=yield m._getNegotiationResponse(I),"Disconnecting"===m._connectionState||"Disconnected"===m._connectionState)throw new Error("The connection was stopped during negotiation.");if(z.error)throw new Error(z.error);if(z.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(z.url&&(I=z.url),z.accessToken){const de=z.accessToken;m._accessTokenFactory=()=>de}oe++}while(z.url&&oe<100);if(100===oe&&z.url)throw new Error("Negotiate redirection limit exceeded.");yield m._createTransport(I,m._options.transport,z,d)}m.transport instanceof ve&&(m.features.inherentKeepAlive=!0),"Connecting"===m._connectionState&&(m._logger.log(g.Debug,"The HttpConnection connected successfully."),m._connectionState="Connected")}catch(z){return m._logger.log(g.Error,"Failed to start the connection: "+z),m._connectionState="Disconnected",m.transport=void 0,m._stopPromiseResolver(),Promise.reject(z)}})()}_getNegotiationResponse(d){var m=this;return i(function*(){const I={};if(m._accessTokenFactory){const ye=yield m._accessTokenFactory();ye&&(I[re.Authorization]=`Bearer ${ye}`)}const[z,oe]=V();I[z]=oe;const de=m._resolveNegotiateUrl(d);m._logger.log(g.Debug,`Sending negotiation request: ${de}.`);try{const ye=yield m._httpClient.post(de,{content:"",headers:$e($e({},I),m._options.headers),timeout:m._options.timeout,withCredentials:m._options.withCredentials});if(200!==ye.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${ye.statusCode}'`));const Te=JSON.parse(ye.content);return(!Te.negotiateVersion||Te.negotiateVersion<1)&&(Te.connectionToken=Te.connectionId),Te}catch(ye){let Te="Failed to complete negotiation with the server: "+ye;return ye instanceof r&&404===ye.statusCode&&(Te+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),m._logger.log(g.Error,Te),Promise.reject(new f(Te))}})()}_createConnectUrl(d,m){return m?d+(-1===d.indexOf("?")?"?":"&")+`id=${m}`:d}_createTransport(d,m,I,z){var oe=this;return i(function*(){let de=oe._createConnectUrl(d,I.connectionToken);if(oe._isITransport(m))return oe._logger.log(g.Debug,"Connection was provided an instance of ITransport, using that directly."),oe.transport=m,yield oe._startTransport(de,z),void(oe.connectionId=I.connectionId);const ye=[],Te=I.availableTransports||[];let ke=I;for(const Ae of Te){const Ge=oe._resolveTransportOrError(Ae,m,z);if(Ge instanceof Error)ye.push(`${Ae.transport} failed:`),ye.push(Ge);else if(oe._isITransport(Ge)){if(oe.transport=Ge,!ke){try{ke=yield oe._getNegotiationResponse(d)}catch(Ye){return Promise.reject(Ye)}de=oe._createConnectUrl(d,ke.connectionToken)}try{return yield oe._startTransport(de,z),void(oe.connectionId=ke.connectionId)}catch(Ye){if(oe._logger.log(g.Error,`Failed to start the transport '${Ae.transport}': ${Ye}`),ke=void 0,ye.push(new b(`${Ae.transport} failed: ${Ye}`,J[Ae.transport])),"Connecting"!==oe._connectionState){const at="Failed to select transport before stop() was called.";return oe._logger.log(g.Debug,at),Promise.reject(new Error(at))}}}}return Promise.reject(ye.length>0?new u(`Unable to connect to the server with any of the available transports. ${ye.join(" ")}`,ye):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(d){switch(d){case J.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Pe(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case J.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new _e(this._httpClient,this._accessTokenFactory,this._logger,this._options);case J.LongPolling:return new ve(this._httpClient,this._accessTokenFactory,this._logger,this._options);default:throw new Error(`Unknown transport: ${d}.`)}}_startTransport(d,m){return this.transport.onreceive=this.onreceive,this.transport.onclose=I=>this._stopConnection(I),this.transport.connect(d,m)}_resolveTransportOrError(d,m,I){const z=J[d.transport];if(null==z)return this._logger.log(g.Debug,`Skipping transport '${d.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${d.transport}' because it is not supported by this client.`);if(!function(Y,d){return!Y||0!=(d&Y)}(m,z))return this._logger.log(g.Debug,`Skipping transport '${J[z]}' because it was disabled by the client.`),new _(`'${J[z]}' is disabled by the client.`,z);if(!(d.transferFormats.map(de=>q[de]).indexOf(I)>=0))return this._logger.log(g.Debug,`Skipping transport '${J[z]}' because it does not support the requested transfer format '${q[I]}'.`),new Error(`'${J[z]}' does not support ${q[I]}.`);if(z===J.WebSockets&&!this._options.WebSocket||z===J.ServerSentEvents&&!this._options.EventSource)return this._logger.log(g.Debug,`Skipping transport '${J[z]}' because it is not supported in your environment.'`),new y(`'${J[z]}' is not supported in your environment.`,z);this._logger.log(g.Debug,`Selecting transport '${J[z]}'.`);try{return this._constructTransport(z)}catch(de){return de}}_isITransport(d){return d&&"object"==typeof d&&"connect"in d}_stopConnection(d){if(this._logger.log(g.Debug,`HttpConnection.stopConnection(${d}) called while in state ${this._connectionState}.`),this.transport=void 0,d=this._stopError||d,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(g.Warning,`Call to HttpConnection.stopConnection(${d}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${d}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),d?this._logger.log(g.Error,`Connection disconnected with error '${d}'.`):this._logger.log(g.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(m=>{this._logger.log(g.Error,`TransportSendQueue.stop() threw error '${m}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(d)}catch(m){this._logger.log(g.Error,`HttpConnection.onclose(${d}) threw error '${m}'.`)}}}else this._logger.log(g.Debug,`Call to HttpConnection.stopConnection(${d}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(d){if(0===d.lastIndexOf("https://",0)||0===d.lastIndexOf("http://",0))return d;if(!R.isBrowser)throw new Error(`Cannot resolve '${d}'.`);const m=window.document.createElement("a");return m.href=d,this._logger.log(g.Information,`Normalizing '${d}' to '${m.href}'.`),m.href}_resolveNegotiateUrl(d){const m=d.indexOf("?");let I=d.substring(0,-1===m?d.length:m);return"/"!==I[I.length-1]&&(I+="/"),I+="negotiate",I+=-1===m?"":d.substring(m),-1===I.indexOf("negotiateVersion")&&(I+=-1===m?"?":"&",I+="negotiateVersion="+this._negotiateVersion),I}}class Le{constructor(d){this._transport=d,this._buffer=[],this._executing=!0,this._sendBufferedData=new Ce,this._transportResult=new Ce,this._sendLoopPromise=this._sendLoop()}send(d){return this._bufferData(d),this._transportResult||(this._transportResult=new Ce),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(d){if(this._buffer.length&&typeof this._buffer[0]!=typeof d)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof d}`);this._buffer.push(d),this._sendBufferedData.resolve()}_sendLoop(){var d=this;return i(function*(){for(;;){if(yield d._sendBufferedData.promise,!d._executing){d._transportResult&&d._transportResult.reject("Connection stopped.");break}d._sendBufferedData=new Ce;const m=d._transportResult;d._transportResult=void 0;const I="string"==typeof d._buffer[0]?d._buffer.join(""):Le._concatBuffers(d._buffer);d._buffer.length=0;try{yield d._transport.send(I),m.resolve()}catch(z){m.reject(z)}}})()}static _concatBuffers(d){const m=d.map(oe=>oe.byteLength).reduce((oe,de)=>oe+de),I=new Uint8Array(m);let z=0;for(const oe of d)I.set(new Uint8Array(oe),z),z+=oe.byteLength;return I.buffer}}class Ce{constructor(){this.promise=new Promise((d,m)=>[this._resolver,this._rejecter]=[d,m])}resolve(){this._resolver()}reject(d){this._rejecter(d)}}class Oe{static write(d){return`${d}${Oe.RecordSeparator}`}static parse(d){if(d[d.length-1]!==Oe.RecordSeparator)throw new Error("Message is incomplete.");const m=d.split(Oe.RecordSeparator);return m.pop(),m}}Oe.RecordSeparatorCode=30,Oe.RecordSeparator=String.fromCharCode(Oe.RecordSeparatorCode);class ue{writeHandshakeRequest(d){return Oe.write(JSON.stringify(d))}parseHandshakeResponse(d){let m,I;if(T(d)){const ye=new Uint8Array(d),Te=ye.indexOf(Oe.RecordSeparatorCode);if(-1===Te)throw new Error("Message is incomplete.");const ke=Te+1;m=String.fromCharCode.apply(null,Array.prototype.slice.call(ye.slice(0,ke))),I=ye.byteLength>ke?ye.slice(ke).buffer:null}else{const ye=d,Te=ye.indexOf(Oe.RecordSeparator);if(-1===Te)throw new Error("Message is incomplete.");const ke=Te+1;m=ye.substring(0,ke),I=ye.length>ke?ye.substring(ke):null}const z=Oe.parse(m),oe=JSON.parse(z[0]);if(oe.type)throw new Error("Expected a handshake response from the server.");return[I,oe]}}var Z=(()=>{return(Y=Z||(Z={}))[Y.Invocation=1]="Invocation",Y[Y.StreamItem=2]="StreamItem",Y[Y.Completion=3]="Completion",Y[Y.StreamInvocation=4]="StreamInvocation",Y[Y.CancelInvocation=5]="CancelInvocation",Y[Y.Ping=6]="Ping",Y[Y.Close=7]="Close",Z;var Y})();class ie{constructor(){this.observers=[]}next(d){for(const m of this.observers)m.next(d)}error(d){for(const m of this.observers)m.error&&m.error(d)}complete(){for(const d of this.observers)d.complete&&d.complete()}subscribe(d){return this.observers.push(d),new j(this,d)}}var D=(()=>{return(Y=D||(D={})).Disconnected="Disconnected",Y.Connecting="Connecting",Y.Connected="Connected",Y.Disconnecting="Disconnecting",Y.Reconnecting="Reconnecting",D;var Y})();class Q{constructor(d,m,I,z){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(g.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},L.isRequired(d,"connection"),L.isRequired(m,"logger"),L.isRequired(I,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=m,this._protocol=I,this.connection=d,this._reconnectPolicy=z,this._handshakeProtocol=new ue,this.connection.onreceive=oe=>this._processIncomingData(oe),this.connection.onclose=oe=>this._connectionClosed(oe),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=D.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:Z.Ping})}static create(d,m,I,z){return new Q(d,m,I,z)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(d){if(this._connectionState!==D.Disconnected&&this._connectionState!==D.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!d)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=d}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var d=this;return i(function*(){if(d._connectionState!==D.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));d._connectionState=D.Connecting,d._logger.log(g.Debug,"Starting HubConnection.");try{yield d._startInternal(),R.isBrowser&&window.document.addEventListener("freeze",d._freezeEventListener),d._connectionState=D.Connected,d._connectionStarted=!0,d._logger.log(g.Debug,"HubConnection connected successfully.")}catch(m){return d._connectionState=D.Disconnected,d._logger.log(g.Debug,`HubConnection failed to start successfully because of error '${m}'.`),Promise.reject(m)}})()}_startInternal(){var d=this;return i(function*(){d._stopDuringStartError=void 0,d._receivedHandshakeResponse=!1;const m=new Promise((I,z)=>{d._handshakeResolver=I,d._handshakeRejecter=z});yield d.connection.start(d._protocol.transferFormat);try{const I={protocol:d._protocol.name,version:d._protocol.version};if(d._logger.log(g.Debug,"Sending handshake request."),yield d._sendMessage(d._handshakeProtocol.writeHandshakeRequest(I)),d._logger.log(g.Information,`Using HubProtocol '${d._protocol.name}'.`),d._cleanupTimeout(),d._resetTimeoutPeriod(),d._resetKeepAliveInterval(),yield m,d._stopDuringStartError)throw d._stopDuringStartError}catch(I){throw d._logger.log(g.Debug,`Hub handshake failed with error '${I}' during start(). Stopping HubConnection.`),d._cleanupTimeout(),d._cleanupPingTimer(),yield d.connection.stop(I),I}})()}stop(){var d=this;return i(function*(){const m=d._startPromise;d._stopPromise=d._stopInternal(),yield d._stopPromise;try{yield m}catch(I){}})()}_stopInternal(d){return this._connectionState===D.Disconnected?(this._logger.log(g.Debug,`Call to HubConnection.stop(${d}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===D.Disconnecting?(this._logger.log(g.Debug,`Call to HttpConnection.stop(${d}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=D.Disconnecting,this._logger.log(g.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(g.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=d||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(d)))}stream(d,...m){const[I,z]=this._replaceStreamingParams(m),oe=this._createStreamInvocation(d,m,z);let de;const ye=new ie;return ye.cancelCallback=()=>{const Te=this._createCancelInvocation(oe.invocationId);return delete this._callbacks[oe.invocationId],de.then(()=>this._sendWithProtocol(Te))},this._callbacks[oe.invocationId]=(Te,ke)=>{ke?ye.error(ke):Te&&(Te.type===Z.Completion?Te.error?ye.error(new Error(Te.error)):ye.complete():ye.next(Te.item))},de=this._sendWithProtocol(oe).catch(Te=>{ye.error(Te),delete this._callbacks[oe.invocationId]}),this._launchStreams(I,de),ye}_sendMessage(d){return this._resetKeepAliveInterval(),this.connection.send(d)}_sendWithProtocol(d){return this._sendMessage(this._protocol.writeMessage(d))}send(d,...m){const[I,z]=this._replaceStreamingParams(m),oe=this._sendWithProtocol(this._createInvocation(d,m,!0,z));return this._launchStreams(I,oe),oe}invoke(d,...m){const[I,z]=this._replaceStreamingParams(m),oe=this._createInvocation(d,m,!1,z);return new Promise((ye,Te)=>{this._callbacks[oe.invocationId]=(Ae,Ge)=>{Ge?Te(Ge):Ae&&(Ae.type===Z.Completion?Ae.error?Te(new Error(Ae.error)):ye(Ae.result):Te(new Error(`Unexpected message type: ${Ae.type}`)))};const ke=this._sendWithProtocol(oe).catch(Ae=>{Te(Ae),delete this._callbacks[oe.invocationId]});this._launchStreams(I,ke)})}on(d,m){!d||!m||(d=d.toLowerCase(),this._methods[d]||(this._methods[d]=[]),-1===this._methods[d].indexOf(m)&&this._methods[d].push(m))}off(d,m){if(!d)return;d=d.toLowerCase();const I=this._methods[d];if(I)if(m){const z=I.indexOf(m);-1!==z&&(I.splice(z,1),0===I.length&&delete this._methods[d])}else delete this._methods[d]}onclose(d){d&&this._closedCallbacks.push(d)}onreconnecting(d){d&&this._reconnectingCallbacks.push(d)}onreconnected(d){d&&this._reconnectedCallbacks.push(d)}_processIncomingData(d){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(d=this._processHandshakeResponse(d),this._receivedHandshakeResponse=!0),d){const m=this._protocol.parseMessages(d,this._logger);for(const I of m)switch(I.type){case Z.Invocation:this._invokeClientMethod(I);break;case Z.StreamItem:case Z.Completion:{const z=this._callbacks[I.invocationId];if(z){I.type===Z.Completion&&delete this._callbacks[I.invocationId];try{z(I)}catch(oe){this._logger.log(g.Error,`Stream callback threw error: ${W(oe)}`)}}break}case Z.Ping:break;case Z.Close:{this._logger.log(g.Information,"Close message received from server.");const z=I.error?new Error("Server returned an error on close: "+I.error):void 0;!0===I.allowReconnect?this.connection.stop(z):this._stopPromise=this._stopInternal(z);break}default:this._logger.log(g.Warning,`Invalid message type: ${I.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(d){let m,I;try{[I,m]=this._handshakeProtocol.parseHandshakeResponse(d)}catch(z){const oe="Error parsing handshake response: "+z;this._logger.log(g.Error,oe);const de=new Error(oe);throw this._handshakeRejecter(de),de}if(m.error){const z="Server returned handshake error: "+m.error;this._logger.log(g.Error,z);const oe=new Error(z);throw this._handshakeRejecter(oe),oe}return this._logger.log(g.Debug,"Server handshake complete."),this._handshakeResolver(),I}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var d=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let m=this._nextKeepAlive-(new Date).getTime();m<0&&(m=0),this._pingServerHandle=setTimeout(i(function*(){if(d._connectionState===D.Connected)try{yield d._sendMessage(d._cachedPingMessage)}catch(I){d._cleanupPingTimer()}}),m)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(d){const m=this._methods[d.target.toLowerCase()];if(m){try{m.forEach(I=>I.apply(this,d.arguments))}catch(I){this._logger.log(g.Error,`A callback for the method ${d.target.toLowerCase()} threw error '${I}'.`)}if(d.invocationId){const I="Server requested a response, which is not supported in this version of the client.";this._logger.log(g.Error,I),this._stopPromise=this._stopInternal(new Error(I))}}else this._logger.log(g.Warning,`No client method with the name '${d.target}' found.`)}_connectionClosed(d){this._logger.log(g.Debug,`HubConnection.connectionClosed(${d}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||d||new Error("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(d||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===D.Disconnecting?this._completeClose(d):this._connectionState===D.Connected&&this._reconnectPolicy?this._reconnect(d):this._connectionState===D.Connected&&this._completeClose(d)}_completeClose(d){if(this._connectionStarted){this._connectionState=D.Disconnected,this._connectionStarted=!1,R.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(m=>m.apply(this,[d]))}catch(m){this._logger.log(g.Error,`An onclose callback called with error '${d}' threw error '${m}'.`)}}}_reconnect(d){var m=this;return i(function*(){const I=Date.now();let z=0,oe=void 0!==d?d:new Error("Attempting to reconnect due to a unknown error."),de=m._getNextRetryDelay(z++,0,oe);if(null===de)return m._logger.log(g.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void m._completeClose(d);if(m._connectionState=D.Reconnecting,m._logger.log(g.Information,d?`Connection reconnecting because of error '${d}'.`:"Connection reconnecting."),0!==m._reconnectingCallbacks.length){try{m._reconnectingCallbacks.forEach(ye=>ye.apply(m,[d]))}catch(ye){m._logger.log(g.Error,`An onreconnecting callback called with error '${d}' threw error '${ye}'.`)}if(m._connectionState!==D.Reconnecting)return void m._logger.log(g.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==de;){if(m._logger.log(g.Information,`Reconnect attempt number ${z} will start in ${de} ms.`),yield new Promise(ye=>{m._reconnectDelayHandle=setTimeout(ye,de)}),m._reconnectDelayHandle=void 0,m._connectionState!==D.Reconnecting)return void m._logger.log(g.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield m._startInternal(),m._connectionState=D.Connected,m._logger.log(g.Information,"HubConnection reconnected successfully."),0!==m._reconnectedCallbacks.length)try{m._reconnectedCallbacks.forEach(ye=>ye.apply(m,[m.connection.connectionId]))}catch(ye){m._logger.log(g.Error,`An onreconnected callback called with connectionId '${m.connection.connectionId}; threw error '${ye}'.`)}return}catch(ye){if(m._logger.log(g.Information,`Reconnect attempt failed because of error '${ye}'.`),m._connectionState!==D.Reconnecting)return m._logger.log(g.Debug,`Connection moved to the '${m._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(m._connectionState===D.Disconnecting&&m._completeClose());oe=ye instanceof Error?ye:new Error(ye.toString()),de=m._getNextRetryDelay(z++,Date.now()-I,oe)}}m._logger.log(g.Information,`Reconnect retries have been exhausted after ${Date.now()-I} ms and ${z} failed attempts. Connection disconnecting.`),m._completeClose()})()}_getNextRetryDelay(d,m,I){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:m,previousRetryCount:d,retryReason:I})}catch(z){return this._logger.log(g.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${d}, ${m}) threw error '${z}'.`),null}}_cancelCallbacksWithError(d){const m=this._callbacks;this._callbacks={},Object.keys(m).forEach(I=>{const z=m[I];try{z(null,d)}catch(oe){this._logger.log(g.Error,`Stream 'error' callback called with '${d}' threw error: ${W(oe)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(d,m,I,z){if(I)return 0!==z.length?{arguments:m,streamIds:z,target:d,type:Z.Invocation}:{arguments:m,target:d,type:Z.Invocation};{const oe=this._invocationId;return this._invocationId++,0!==z.length?{arguments:m,invocationId:oe.toString(),streamIds:z,target:d,type:Z.Invocation}:{arguments:m,invocationId:oe.toString(),target:d,type:Z.Invocation}}}_launchStreams(d,m){if(0!==d.length){m||(m=Promise.resolve());for(const I in d)d[I].subscribe({complete:()=>{m=m.then(()=>this._sendWithProtocol(this._createCompletionMessage(I)))},error:z=>{let oe;oe=z instanceof Error?z.message:z&&z.toString?z.toString():"Unknown error",m=m.then(()=>this._sendWithProtocol(this._createCompletionMessage(I,oe)))},next:z=>{m=m.then(()=>this._sendWithProtocol(this._createStreamItemMessage(I,z)))}})}}_replaceStreamingParams(d){const m=[],I=[];for(let z=0;z<d.length;z++){const oe=d[z];if(this._isObservable(oe)){const de=this._invocationId;this._invocationId++,m[de]=oe,I.push(de.toString()),d.splice(z,1)}}return[m,I]}_isObservable(d){return d&&d.subscribe&&"function"==typeof d.subscribe}_createStreamInvocation(d,m,I){const z=this._invocationId;return this._invocationId++,0!==I.length?{arguments:m,invocationId:z.toString(),streamIds:I,target:d,type:Z.StreamInvocation}:{arguments:m,invocationId:z.toString(),target:d,type:Z.StreamInvocation}}_createCancelInvocation(d){return{invocationId:d,type:Z.CancelInvocation}}_createStreamItemMessage(d,m){return{invocationId:d,item:m,type:Z.StreamItem}}_createCompletionMessage(d,m,I){return m?{error:m,invocationId:d,type:Z.Completion}:{invocationId:d,result:I,type:Z.Completion}}}class fe{constructor(){this.name="json",this.version=1,this.transferFormat=q.Text}parseMessages(d,m){if("string"!=typeof d)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!d)return[];null===m&&(m=A.instance);const I=Oe.parse(d),z=[];for(const oe of I){const de=JSON.parse(oe);if("number"!=typeof de.type)throw new Error("Invalid payload.");switch(de.type){case Z.Invocation:this._isInvocationMessage(de);break;case Z.StreamItem:this._isStreamItemMessage(de);break;case Z.Completion:this._isCompletionMessage(de);break;case Z.Ping:case Z.Close:break;default:m.log(g.Information,"Unknown message type '"+de.type+"' ignored.");continue}z.push(de)}return z}writeMessage(d){return Oe.write(JSON.stringify(d))}_isInvocationMessage(d){this._assertNotEmptyString(d.target,"Invalid payload for Invocation message."),void 0!==d.invocationId&&this._assertNotEmptyString(d.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(d){if(this._assertNotEmptyString(d.invocationId,"Invalid payload for StreamItem message."),void 0===d.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(d){if(d.result&&d.error)throw new Error("Invalid payload for Completion message.");!d.result&&d.error&&this._assertNotEmptyString(d.error,"Invalid payload for Completion message."),this._assertNotEmptyString(d.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(d,m){if("string"!=typeof d||""===d)throw new Error(m)}}const xe={trace:g.Trace,debug:g.Debug,info:g.Information,information:g.Information,warn:g.Warning,warning:g.Warning,error:g.Error,critical:g.Critical,none:g.None};class Ue{configureLogging(d){if(L.isRequired(d,"logging"),void 0!==d.log)this.logger=d;else if("string"==typeof d){const m=function(Y){const d=xe[Y.toLowerCase()];if(void 0!==d)return d;throw new Error(`Unknown log level: ${Y}`)}(d);this.logger=new $(m)}else this.logger=new $(d);return this}withUrl(d,m){return L.isRequired(d,"url"),L.isNotEmpty(d,"url"),this.url=d,this.httpConnectionOptions="object"==typeof m?$e($e({},this.httpConnectionOptions),m):Ze($e({},this.httpConnectionOptions),{transport:m}),this}withHubProtocol(d){return L.isRequired(d,"protocol"),this.protocol=d,this}withAutomaticReconnect(d){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=d?Array.isArray(d)?new e(d):d:new e,this}build(){const d=this.httpConnectionOptions||{};if(void 0===d.logger&&(d.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const m=new we(this.url,d);return Q.create(m,this.logger||A.instance,this.protocol||new fe,this.reconnectPolicy)}}var Ve=a(2340),je=a(8987),ze=a(9765),ge=a(6465),G=a(6102);const ce=new class extends G.v{}(class extends ge.o{constructor(d,m){super(d,m),this.scheduler=d,this.work=m}schedule(d,m=0){return m>0?super.schedule(d,m):(this.delay=m,this.state=d,this.scheduler.flush(this),this)}execute(d,m){return m>0||this.closed?super.execute(d,m):this._execute(d,m)}requestAsyncId(d,m,I=0){return null!==I&&I>0||null===I&&this.delay>0?super.requestAsyncId(d,m,I):d.flush(this)}});var he=a(5319),Re=a(7393),De=a(1593);class Ie extends Re.L{constructor(d,m,I=0){super(d),this.scheduler=m,this.delay=I}static dispatch(d){const{notification:m,destination:I}=d;m.observe(I),this.unsubscribe()}scheduleMessage(d){this.destination.add(this.scheduler.schedule(Ie.dispatch,this.delay,new Me(d,this.destination)))}_next(d){this.scheduleMessage(De.P.createNext(d))}_error(d){this.scheduleMessage(De.P.createError(d)),this.unsubscribe()}_complete(){this.scheduleMessage(De.P.createComplete()),this.unsubscribe()}}class Me{constructor(d,m){this.notification=d,this.destination=m}}var Ee=a(7971),Be=a(8858);class Qe extends ze.xQ{constructor(d=Number.POSITIVE_INFINITY,m=Number.POSITIVE_INFINITY,I){super(),this.scheduler=I,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=d<1?1:d,this._windowTime=m<1?1:m,m===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(d){if(!this.isStopped){const m=this._events;m.push(d),m.length>this._bufferSize&&m.shift()}super.next(d)}nextTimeWindow(d){this.isStopped||(this._events.push(new Je(this._getNow(),d)),this._trimBufferThenGetEvents()),super.next(d)}_subscribe(d){const m=this._infiniteTimeWindow,I=m?this._events:this._trimBufferThenGetEvents(),z=this.scheduler,oe=I.length;let de;if(this.closed)throw new Ee.N;if(this.isStopped||this.hasError?de=he.w.EMPTY:(this.observers.push(d),de=new Be.W(this,d)),z&&d.add(d=new Ie(d,z)),m)for(let ye=0;ye<oe&&!d.closed;ye++)d.next(I[ye]);else for(let ye=0;ye<oe&&!d.closed;ye++)d.next(I[ye].value);return this.hasError?d.error(this.thrownError):this.isStopped&&d.complete(),de}_getNow(){return(this.scheduler||ce).now()}_trimBufferThenGetEvents(){const d=this._getNow(),m=this._bufferSize,I=this._windowTime,z=this._events,oe=z.length;let de=0;for(;de<oe&&!(d-z[de].time<I);)de++;return oe>m&&(de=Math.max(de,oe-m)),de>0&&z.splice(0,de),z}}class Je{constructor(d,m){this.time=d,this.value=m}}var rt=a(1841);let et=(()=>{class Y{constructor(m){this.http=m,this.refreshRoomsSubject=new ze.xQ,this.roomBroadcast=new Qe,this.roomsUpdated$=this.roomBroadcast.asObservable()}getAuthToken(m){var I=this;return i(function*(){return(yield I.http.get(`${Ve.N.apiUrl}/api/auth/token/${m}`).toPromise()).token})()}joinOrCreateRoom(m,I,z){var oe=this;return i(function*(){let de=null;try{const ye=yield oe.getAuthToken(I);de=yield(0,je.connect)(ye,{name:m,tracks:z,dominantSpeaker:!0})}catch(ye){console.error(`Unable to connect to Room: ${ye.message}`)}finally{de&&oe.roomBroadcast.next(!0)}return de})()}nudge(){this.roomBroadcast.next(!0),this.refreshRoomsSubject.next()}}return Y.\u0275fac=function(m){return new(m||Y)(o.LFG(rt.eN))},Y.\u0275prov=o.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})(),nt=(()=>{class Y{constructor(m){var I=this;this.videoCallService=m;const z=(new Ue).configureLogging(g.Information).withUrl(`${Ve.N.apiUrl}/notificationHub`);this.notificationHub=z.build(),this.notificationHub.on("RoomsUpdated",function(){var oe=i(function*(de){de&&I.videoCallService.nudge()});return function(de){return oe.apply(this,arguments)}}()),this.notificationHub.start()}}return Y.\u0275fac=function(m){return new(m||Y)(o.LFG(et))},Y.\u0275prov=o.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})();const ut=["preview"];function lt(Y,d){1&Y&&(o.TgZ(0,"div"),o._uU(1,"Loading preview... Please wait."),o.qZA())}let tt=(()=>{class Y{constructor(m){this.renderer=m,this.localTracks=[]}get tracks(){return this.localTracks}ngAfterViewInit(){var m=this;return i(function*(){m.previewElement&&m.previewElement.nativeElement&&(yield m.initializeDevice())})()}initializePreview(m){var I=this;return i(function*(){yield I.initializeDevice(m)})()}showPreviewCamera(){var m=this;return i(function*(){return yield m.initializeDevice(),m.videoTrack})()}finalizePreview(){try{this.videoTrack&&this.videoTrack.detach().forEach(m=>m.remove()),this.videoTrack=null}catch(m){console.error(m)}}initializeDevice(m){var I=this;return i(function*(){try{I.isInitializing=!0,I.finalizePreview(),I.videoTrack=m?yield(0,je.createLocalVideoTrack)({deviceId:m}):yield(0,je.createLocalVideoTrack)();const z=I.videoTrack.attach();I.renderer.setStyle(z,"height","100%"),I.removeNodeChildren(I.previewElement),I.renderer.appendChild(I.previewElement.nativeElement,z)}finally{I.isInitializing=!1}})()}removeNodeChildren(m){const I=m.nativeElement.children;for(let z of I)this.renderer.removeChild(m.nativeElement,z)}}return Y.\u0275fac=function(m){return new(m||Y)(o.Y36(o.Qsj))},Y.\u0275cmp=o.Xpm({type:Y,selectors:[["app-camera"]],viewQuery:function(m,I){if(1&m&&o.Gf(ut,5),2&m){let z;o.iGM(z=o.CRH())&&(I.previewElement=z.first)}},decls:3,vars:1,consts:[["id","preview",2,"height","35vh"],["preview",""],[4,"ngIf"]],template:function(m,I){1&m&&(o.TgZ(0,"div",0,1),o.YNc(2,lt,2,0,"div",2),o.qZA()),2&m&&(o.xp6(2),o.Q6J("ngIf",I.isInitializing))},directives:[p.O5],styles:[""]}),Y})();var Ke=a(665),ft=a(6682),dt=a(9112),Xe=a(3190),ht=a(8307);class mt{constructor(d){this.value=d}call(d,m){return m.subscribe(new yt(d,this.value))}}class yt extends Re.L{constructor(d,m){super(d),this.value=m}_next(d){this.destination.next(this.value)}}var it=a(9761),qe=a(8002);let gt=(()=>{class Y{constructor(m){this.httpClient=m}get(m){return this.httpClient.get(`${Ve.N.apiUrl}/api/rooms/${m}`)}getAll(){return this.httpClient.get(`${Ve.N.apiUrl}/api/rooms`)}create(m){return this.httpClient.post(`${Ve.N.apiUrl}/api/rooms`,{name:m})}}return Y.\u0275fac=function(m){return new(m||Y)(o.LFG(rt.eN))},Y.\u0275prov=o.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})();function _t(Y,d){1&Y&&(o.TgZ(0,"span"),o._uU(1,"Create"),o.qZA())}function bt(Y,d){1&Y&&(o.TgZ(0,"span"),o._uU(1,"Creating..."),o.qZA())}const St=function(Y){return["/room",Y]},wt=function(Y){return{name:Y}};function Tt(Y,d){if(1&Y&&(o.TgZ(0,"button",9),o.TgZ(1,"span",10),o._uU(2),o.qZA(),o.TgZ(3,"span"),o._uU(4),o.qZA(),o.O4$(),o.TgZ(5,"svg",11),o._UZ(6,"path",12),o.qZA(),o.qZA()),2&Y){const m=d.$implicit,I=o.oxw(2);o.Q6J("routerLink",o.VKq(6,St,m.name))("queryParams",o.VKq(8,wt,I.form.controls.name.value))("disabled",I.form.controls.name.invalid),o.xp6(2),o.AsE("",m.participantCount||0,"/",m.maxParticipants||0,""),o.xp6(2),o.Oqu(m.name)}}function kt(Y,d){if(1&Y){const m=o.EpF();o.ynx(0),o.TgZ(1,"form",1),o.NdJ("ngSubmit",function(){return o.CHM(m),o.oxw().createRoom()}),o.TgZ(2,"div",2),o.TgZ(3,"p"),o._uU(4,"Who are you?"),o.qZA(),o._UZ(5,"input",3),o.qZA(),o.TgZ(6,"h2"),o._uU(7,"Join a room"),o.qZA(),o.TgZ(8,"p"),o._uU(9,"Create a room by naming it:"),o.qZA(),o.TgZ(10,"div",4),o.TgZ(11,"div",2),o._UZ(12,"input",5),o.qZA(),o.TgZ(13,"button",6),o.YNc(14,_t,2,0,"span",0),o.YNc(15,bt,2,0,"span",0),o.qZA(),o.qZA(),o.qZA(),o.TgZ(16,"h2"),o._uU(17,"Available rooms"),o.qZA(),o.TgZ(18,"div",7),o.YNc(19,Tt,7,10,"button",8),o.qZA(),o.BQk()}if(2&Y){const m=d.ngIf,I=o.oxw();o.xp6(1),o.Q6J("formGroup",I.form),o.xp6(12),o.Q6J("disabled",m.creatingRoom||I.form.invalid),o.xp6(1),o.Q6J("ngIf",!m.creatingRoom),o.xp6(1),o.Q6J("ngIf",m.creatingRoom),o.xp6(4),o.Q6J("ngForOf",m.rooms)}}let Et=(()=>{class Y{constructor(m,I,z,oe){this.roomsService=I,this.router=z,this.videoCallService=oe,this.createRoomSubject=new ze.xQ,this.refreshRoomsSubject=new ze.xQ,this.form=m.group({name:[null,Ke.kI.required],roomName:[null,Ke.kI.required]});const de=(0,ft.T)(this.refreshRoomsSubject,this.videoCallService.refreshRoomsSubject).pipe(function(Y,d){return(0,Xe.w)(()=>Y)}(I.getAll())),ye=this.createRoomSubject.pipe((0,Xe.w)(Te=>this.roomsService.create(Te).pipe((0,ht.b)(ke=>this.router.navigate(["/room",ke.name],{queryParams:{name:this.form.controls.name.value}})),d=>d.lift(new mt(!1)),(0,it.O)(!0))),(0,it.O)(!1));this.model$=(0,dt.aj)([de,ye]).pipe((0,qe.U)(([Te,ke])=>({rooms:Te,creatingRoom:ke})))}createRoom(){!this.form.controls.roomName.value||this.createRoomSubject.next(this.form.controls.roomName.value)}ngAfterViewInit(){this.refreshRoomsSubject.next()}}return Y.\u0275fac=function(m){return new(m||Y)(o.Y36(Ke.qu),o.Y36(gt),o.Y36(h.F0),o.Y36(et))},Y.\u0275cmp=o.Xpm({type:Y,selectors:[["app-rooms"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-group"],["formControlName","name","type","text",1,"form-control"],[1,"d-flex","flex-column"],["formControlName","roomName","type","text",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"card-container"],["class","card","type","button",3,"routerLink","queryParams","disabled",4,"ngFor","ngForOf"],["type","button",1,"card",3,"routerLink","queryParams","disabled"],[1,"badge","badge-sm","badge-secondary","mr-1"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"]],template:function(m,I){1&m&&(o.YNc(0,kt,20,5,"ng-container",0),o.ALo(1,"async")),2&m&&o.Q6J("ngIf",o.lcZ(1,1,I.model$))},directives:[p.O5,Ke._Y,Ke.JL,Ke.sg,Ke.Fj,Ke.JJ,Ke.u,p.sg,h.rH],pipes:[p.Ov],styles:[""],changeDetection:0}),Y})(),Pt=(()=>{class Y{constructor(m){this.notificationService=m}}return Y.\u0275fac=function(m){return new(m||Y)(o.Y36(nt))},Y.\u0275cmp=o.Xpm({type:Y,selectors:[["ng-component"]],decls:10,vars:0,consts:[["role","main",1,"content"],[1,"card","highlight-card","card-small"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(m,I){1&m&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"span"),o._uU(3,"Video preview"),o.qZA(),o.qZA(),o._UZ(4,"app-camera"),o._UZ(5,"app-rooms"),o.O4$(),o.TgZ(6,"svg",2),o.TgZ(7,"title"),o._uU(8,"Gray Clouds Background"),o.qZA(),o._UZ(9,"path",3),o.qZA(),o.qZA())},directives:[tt,Et],encapsulation:2,changeDetection:0}),Y})();const Ct=["list"];function Ot(Y,d){1&Y&&(o.TgZ(0,"div"),o._uU(1,"You are alone"),o.qZA())}const Rt=["*"];let ot=(()=>{class Y{constructor(m){this.renderer=m,this.participantsChanged=new o.vpe}get participantCount(){return this.participants?this.participants.size:0}get isAlone(){return 0===this.participantCount}clear(){this.participants&&this.participants.clear()}initialize(m){this.participants=m,this.participants&&this.participants.forEach(I=>this.registerParticipantEvents(I))}add(m){this.participants&&m&&(this.participants.set(m.sid,m),this.registerParticipantEvents(m))}remove(m){this.participants&&this.participants.has(m.sid)&&this.participants.delete(m.sid)}loudest(m){this.dominantSpeaker=m}registerParticipantEvents(m){m&&(m.tracks.forEach(I=>this.subscribe(I)),m.on("trackPublished",I=>this.subscribe(I)),m.on("trackUnpublished",I=>{I&&I.track&&this.detachRemoteTrack(I.track)}))}subscribe(m){m&&m.on&&(m.on("subscribed",I=>this.attachRemoteTrack(I)),m.on("unsubscribed",I=>this.detachRemoteTrack(I)))}attachRemoteTrack(m){if(this.isAttachable(m)){const I=m.attach();this.renderer.data.id=m.sid,this.renderer.setStyle(I,"width","95%"),this.renderer.setStyle(I,"margin-left","2.5%"),this.renderer.appendChild(this.listRef.nativeElement,I),this.participantsChanged.emit(!0)}}detachRemoteTrack(m){this.isDetachable(m)&&(m.detach().forEach(I=>I.remove()),this.participantsChanged.emit(!0))}isAttachable(m){return!!m&&(void 0!==m.attach||void 0!==m.attach)}isDetachable(m){return!!m&&(void 0!==m.detach||void 0!==m.detach)}}return Y.\u0275fac=function(m){return new(m||Y)(o.Y36(o.Qsj))},Y.\u0275cmp=o.Xpm({type:Y,selectors:[["app-room-grid"]],viewQuery:function(m,I){if(1&m&&o.Gf(Ct,5),2&m){let z;o.iGM(z=o.CRH())&&(I.listRef=z.first)}},outputs:{participantsChanged:"participantsChanged"},ngContentSelectors:Rt,decls:5,vars:1,consts:[[1,"d-flex","flex-column","flex-wrap"],[4,"ngIf"],["list",""]],template:function(m,I){1&m&&(o.F$t(),o.TgZ(0,"div",0),o.Hsn(1),o.YNc(2,Ot,2,0,"div",1),o._UZ(3,"div",null,2),o.qZA()),2&m&&(o.xp6(2),o.Q6J("ngIf",I.isAlone))},directives:[p.O5],styles:[""]}),Y})();var Lt=a(5435),At=a(8049);const xt=[{path:"",component:Pt},{path:"room/:id",component:(()=>{class Y{constructor(m,I,z,oe){this.route=m,this.router=I,this.videoCallService=z,this.notificationService=oe}ngAfterViewInit(){const m=this.route.params.pipe((0,qe.U)(z=>z.id),(0,Lt.h)(z=>z)),I=this.route.queryParams.pipe((0,qe.U)(z=>z.name));m.pipe((0,At.P)(),(0,Xe.w)(z=>I.pipe((0,qe.U)(oe=>({id:z,identity:oe}))))).subscribe(z=>this.onRoomChanged(z.id,z.identity))}onLeaveRoom(m){var I=this;return i(function*(){I.activeRoom&&(I.activeRoom.disconnect(),I.activeRoom=null),I.roomGrid.clear(),yield I.router.navigate(["/"])})()}onRoomChanged(m,I){var z=this;return i(function*(){if(m){z.activeRoom&&z.activeRoom.disconnect();const oe=yield Promise.all([(0,je.createLocalAudioTrack)(),z.camera.showPreviewCamera()]);z.activeRoom=yield z.videoCallService.joinOrCreateRoom(m,I,oe),z.roomGrid.initialize(z.activeRoom.participants),z.registerRoomEvents(),yield z.notificationService.notificationHub.send("RoomsUpdated",!0)}})()}onParticipantsChanged(m){this.videoCallService.nudge()}registerRoomEvents(){this.activeRoom.on("disconnected",m=>m.localParticipant.tracks.forEach(I=>this.detachLocalTrack(I.track))).on("participantConnected",m=>this.roomGrid.add(m)).on("participantDisconnected",m=>this.roomGrid.remove(m)).on("dominantSpeakerChanged",m=>this.roomGrid.loudest(m))}detachLocalTrack(m){this.isDetachable(m)&&m.detach().forEach(I=>I.remove())}isDetachable(m){return!!m&&(void 0!==m.detach||void 0!==m.detach)}}return Y.\u0275fac=function(m){return new(m||Y)(o.Y36(h.gz),o.Y36(h.F0),o.Y36(et),o.Y36(nt))},Y.\u0275cmp=o.Xpm({type:Y,selectors:[["ng-component"]],viewQuery:function(m,I){if(1&m&&(o.Gf(tt,5),o.Gf(ot,5)),2&m){let z;o.iGM(z=o.CRH())&&(I.camera=z.first),o.iGM(z=o.CRH())&&(I.roomGrid=z.first)}},decls:11,vars:0,consts:[["role","main",1,"content"],[1,"d-flex","flex-column","flex-wrap"],[3,"participantsChanged"],[1,"card-container"],["type","button",1,"btn","btn-danger",3,"click"],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"]],template:function(m,I){1&m&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"app-room-grid",2),o.NdJ("participantsChanged",function(oe){return I.onParticipantsChanged(oe)}),o._UZ(3,"app-camera"),o.qZA(),o.qZA(),o.TgZ(4,"div",3),o.TgZ(5,"button",4),o.NdJ("click",function(){return I.onLeaveRoom(!0)}),o._uU(6,"Leave room"),o.qZA(),o.qZA(),o.O4$(),o.TgZ(7,"svg",5),o.TgZ(8,"title"),o._uU(9,"Gray Clouds Background"),o.qZA(),o._UZ(10,"path",6),o.qZA(),o.qZA())},directives:[ot,tt],styles:[""]}),Y})()}];let It=(()=>{class Y{}return Y.\u0275fac=function(m){return new(m||Y)},Y.\u0275mod=o.oAB({type:Y}),Y.\u0275inj=o.cJS({imports:[[h.Bz.forChild(xt)],h.Bz]}),Y})();var Dt=a(8319);let jt=(()=>{class Y{}return Y.\u0275fac=function(m){return new(m||Y)},Y.\u0275mod=o.oAB({type:Y}),Y.\u0275inj=o.cJS({imports:[[p.ez,It,Ke.UX,Dt.IJ]]}),Y})()},5127:C=>{"use strict";var w=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],a="undefined"==typeof globalThis?global:globalThis;C.exports=function(){for(var h=[],o=0;o<w.length;o++)"function"==typeof a[w[o]]&&(h[h.length]=w[o]);return h}},7168:(C,w,a)=>{"use strict";var h=a(8540)("%Object.getOwnPropertyDescriptor%",!0);if(h)try{h([],"length")}catch(o){h=null}C.exports=h},1730:C=>{"use strict";C.exports=JSON.parse('{"name":"twilio-video","title":"Twilio Video","description":"Twilio Video JavaScript Library","version":"2.21.1","homepage":"https://twilio.com","author":"Mark Andrus Roberts <mroberts@twilio.com>","contributors":["Ryan Rowland <rrowland@twilio.com>","Manjesh Malavalli <mmalavalli@twilio.com>","Makarand Patwardhan <mpatwardhan@twilio.com>"],"keywords":["twilio","webrtc","library","javascript","video","rooms"],"repository":{"type":"git","url":"https://github.com/twilio/twilio-video.js.git"},"devDependencies":{"@babel/core":"^7.14.2","@babel/preset-env":"^7.14.2","@babel/preset-typescript":"^7.13.0","@types/express":"^4.11.0","@types/node":"^8.5.1","@types/selenium-webdriver":"^3.0.8","@types/ws":"^3.2.1","@typescript-eslint/eslint-plugin":"^4.13.0","@typescript-eslint/parser":"^4.0.0","babel-cli":"^6.26.0","babel-preset-es2015":"^6.24.1","browserify":"^17.0.0","cheerio":"^0.22.0","cors":"^2.8.5","electron":"^9.1.0","envify":"^4.0.0","eslint":"^6.2.1","eslint-config-standard":"^14.0.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^9.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1","express":"^4.16.2","glob":"^7.1.7","ink-docstrap":"^1.3.2","inquirer":"^7.0.0","is-docker":"^2.0.0","jsdoc":"^3.5.5","jsdoc-babel":"^0.5.0","json-loader":"^0.5.7","karma":"^5.0.2","karma-browserify":"^8.0.0","karma-chrome-launcher":"^2.0.0","karma-edgium-launcher":"^4.0.0-0","karma-electron":"^6.1.0","karma-firefox-launcher":"^1.3.0","karma-htmlfile-reporter":"^0.3.8","karma-junit-reporter":"^1.2.0","karma-mocha":"^1.3.0","karma-safari-launcher":"^1.0.0","karma-spec-reporter":"0.0.32","karma-typescript":"^5.5.1","karma-typescript-es6-transform":"^5.5.1","mocha":"^3.2.0","mock-require":"^3.0.3","ncp":"^2.0.0","node-http-server":"^8.1.2","npm-run-all":"^4.0.2","nyc":"^15.1.0","requirejs":"^2.3.3","rimraf":"^2.6.1","simple-git":"^1.126.0","sinon":"^4.0.1","ts-node":"4.0.1","tslint":"5.8.0","twilio":"^3.49.0","twilio-release-tool":"^1.0.2","typescript":"4.2.2","uglify-js":"^2.8.22","vinyl-fs":"^2.4.4","vinyl-source-stream":"^1.1.0","watchify":"^3.11.1","webrtc-adapter":"^7.7.1"},"engines":{"node":">=0.12"},"license":"BSD-3-Clause","main":"./es5/index.js","types":"./tsdef/index.d.ts","scripts":{"lint:js":"eslint ./lib ./test/*.js ./docker/**/*.js ./test/framework/*.js ./test/lib/*.js ./test/integration/** ./test/unit/** ","lint:ts":"eslint ./tsdef/*.ts ./lib/**/*.ts","lint":"npm-run-all lint:js lint:ts","printVersion":"node --version && npm --version","test:unit":"npm-run-all printVersion build:es5 && nyc --report-dir=./coverage --include=lib/**/* --reporter=html --reporter=lcov --reporter=text mocha -r ts-node/register ./test/unit/*","test:serversiderender":"mocha ./test/serversiderender/index.js","test:integration:adapter":"node ./scripts/karma.js karma/integration.adapter.conf.js","test:integration":"npm run build:es5 && node ./scripts/karma.js karma/integration.conf.js","test:umd:install":"npm install puppeteer@5.5.0","test:umd":"mocha ./test/umd/index.js","test:crossbrowser:build:clean":"rimraf ./test/crossbrowser/lib ./test/crossbrowser/src/browser/index.js","test:crossbrowser:build:lint":"cd ./test/crossbrowser && tslint --project tsconfig.json","test:crossbrowser:build:tsc":"cd ./test/crossbrowser && tsc","test:crossbrowser:build:browser":"cd ./test/crossbrowser && browserify lib/crossbrowser/src/browser/index.js > src/browser/index.js","test:crossbrowser:build":"npm-run-all test:crossbrowser:build:*","test:crossbrowser:test":"cd ./test/crossbrowser && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:crossbrowser":"npm-run-all test:crossbrowser:*","test:sdkdriver:build:clean":"rimraf ./test/lib/sdkdriver/lib ./test/lib/sdkdriver/test/integration/browser/index.js","test:sdkdriver:build:lint":"cd ./test/lib/sdkdriver && tslint --project tsconfig.json","test:sdkdriver:build:tsc":"cd ./test/lib/sdkdriver && tsc --rootDir src","test:sdkdriver:build":"npm-run-all test:sdkdriver:build:*","test:sdkdriver:test:unit":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/unit/spec/**/*.ts","test:sdkdriver:test:integration:browser":"cd ./test/lib/sdkdriver/test/integration && browserify browser/browser.js > browser/index.js","test:sdkdriver:test:integration:run":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:sdkdriver:test:integration":"npm-run-all test:sdkdriver:test:integration:*","test:sdkdriver:test":"npm-run-all test:sdkdriver:test:*","test:sdkdriver":"npm-run-all test:sdkdriver:*","test:framework:angular:install":"cd ./test/framework/twilio-video-angular && rimraf ./node_modules package-lock.json && npm install","test:framework:angular:run":"mocha ./test/framework/twilio-video-angular.js","test:framework:angular":"npm-run-all test:framework:angular:*","test:framework:no-framework:run":"mocha ./test/framework/twilio-video-no-framework.js","test:framework:no-framework":"npm-run-all test:framework:no-framework:*","test:framework:react:install":"cd ./test/framework/twilio-video-react && rimraf ./node_modules package-lock.json && npm install","test:framework:react:test":"node ./scripts/framework.js twilio-video-react","test:framework:react:build":"cd ./test/framework/twilio-video-react && npm run build","test:framework:react:run":"mocha ./test/framework/twilio-video-react.js","test:framework:react":"npm-run-all test:framework:react:*","test:framework:install":"npm install chromedriver && npm install selenium-webdriver && npm install geckodriver && npm install puppeteer","test:framework":"npm-run-all test:framework:install test:framework:no-framework test:framework:react","test":"npm-run-all test:unit test:integration","build:es5":"rimraf ./es5 && tsc tsdef/twilio-video-tests.ts --noEmit --lib es2018,dom && tsc ","build:js":"node ./scripts/build.js ./src/twilio-video.js ./LICENSE.md ./dist/twilio-video.js","build:min.js":"uglifyjs ./dist/twilio-video.js -o ./dist/twilio-video.min.js --comments \\"/^! twilio-video.js/\\" -b beautify=false,ascii_only=true","build":"npm-run-all clean lint docs test:unit test:integration build:es5 build:js build:min.js test:umd","build:quick":"npm-run-all clean lint docs build:es5 build:js build:min.js","docs":"node ./scripts/docs.js ./dist/docs","watch":"tsc -w","clean":"rimraf ./coverage ./es5 ./dist"},"dependencies":{"backoff":"^2.5.0","events":"^3.3.0","util":"^0.12.4","ws":"^7.4.6","xmlhttprequest":"^1.8.0"},"browser":{"ws":"./src/ws.js","xmlhttprequest":"./src/xmlhttprequest.js"},"_resolved":"https://registry.npmjs.org/twilio-video/-/twilio-video-2.21.1.tgz","_integrity":"sha512-odVq6tBF2OGwtOncvGuQjyuv6fAIkIWVzZZxlYnFkbUen6eq3A9fCtNuKLb+GnXFwXLzzRHByi3yJzQgkWbJow==","_from":"twilio-video@2.21.1"}')}}]);